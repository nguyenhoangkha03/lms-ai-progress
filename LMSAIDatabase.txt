CREATE TABLE `ab_tests` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `name` varchar(255) NOT NULL COMMENT 'A/B test name',
  `description` text DEFAULT NULL COMMENT 'Test description and hypothesis',
  `controlModelId` varchar(36) NOT NULL COMMENT 'Control model ID',
  `testModelId` varchar(36) NOT NULL COMMENT 'Test model ID',
  `status` enum('planned','running','paused','completed','cancelled','failed') NOT NULL DEFAULT 'planned' COMMENT 'Test status',
  `trafficSplit` decimal(5,2) NOT NULL DEFAULT 50.00 COMMENT 'Traffic split percentage for test model',
  `startDate` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'Test start date',
  `endDate` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'Test end date',
  `successMetrics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL COMMENT 'Success metrics to track' CHECK (json_valid(`successMetrics`)),
  `targetAudience` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Target audience' CHECK (json_valid(`targetAudience`)),
  `configuration` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Test configuration and parameters' CHECK (json_valid(`configuration`)),
  `results` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Test results summary' CHECK (json_valid(`results`)),
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Whether test is active',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;


CREATE TABLE `ab_test_results` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `testId` varchar(36) NOT NULL COMMENT 'Reference to A/B test',
  `userId` varchar(36) DEFAULT NULL COMMENT 'User who triggered this result',
  `modelVariant` enum('control','test') NOT NULL COMMENT 'Which model variant was used',
  `metricValues` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL COMMENT 'Metric values recorded' CHECK (json_valid(`metricValues`)),
  `contextData` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional context data' CHECK (json_valid(`contextData`)),
  `recordedAt` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'When result was recorded',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;


CREATE TABLE `activity_feeds` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `userId` varchar(36) NOT NULL COMMENT 'User who performed the activity',
  `activityType` enum('course_enrolled','lesson_completed','assignment_submitted','quiz_completed','certificate_earned','comment_posted','discussion_started','answer_provided','question_asked','group_joined','project_shared','note_shared','peer_review_completed','badge_earned','milestone_reached','streak_achieved','goal_completed','profile_updated','settings_changed') NOT NULL COMMENT 'Type of activity performed',
  `visibility` enum('public','friends','course_members','group_members','private') NOT NULL DEFAULT 'public' COMMENT 'Who can see this activity',
  `title` varchar(255) NOT NULL COMMENT 'Activity title/summary',
  `description` text DEFAULT NULL COMMENT 'Detailed activity description',
  `courseId` varchar(36) DEFAULT NULL COMMENT 'Related course ID',
  `lessonId` varchar(36) DEFAULT NULL COMMENT 'Related lesson ID',
  `assignmentId` varchar(36) DEFAULT NULL COMMENT 'Related assignment ID',
  `groupId` varchar(36) DEFAULT NULL COMMENT 'Related group ID',
  `relatedId` varchar(36) DEFAULT NULL COMMENT 'Related entity ID (generic)',
  `relatedType` varchar(50) DEFAULT NULL COMMENT 'Related entity type',
  `activityData` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Activity data and context' CHECK (json_valid(`activityData`)),
  `actionUrl` varchar(500) DEFAULT NULL COMMENT 'Action URL for the activity',
  `imageUrl` varchar(500) DEFAULT NULL COMMENT 'Thumbnail/icon URL',
  `isVisible` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Whether activity is visible',
  `likesCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of likes on this activity',
  `commentsCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of comments on this activity',
  `sharesCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of shares of this activity',
  `likedBy` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Users who liked this activity' CHECK (json_valid(`likedBy`)),
  `tags` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Activity tags for filtering' CHECK (json_valid(`tags`)),
  `importance` int(11) NOT NULL DEFAULT 1 COMMENT 'Activity importance score',
  `occurredAt` timestamp NULL DEFAULT NULL COMMENT 'When activity occurred (if different from createdAt)',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

CREATE TABLE `adaptive_content` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `courseId` varchar(36) DEFAULT NULL,
  `lessonId` varchar(36) DEFAULT NULL,
  `contentType` enum('lesson','exercise','quiz','explanation','example','simulation','video','interactive','reading') NOT NULL,
  `title` varchar(255) NOT NULL,
  `content` text NOT NULL,
  `difficultyLevel` enum('very_easy','easy','medium','hard','very_hard','adaptive') NOT NULL,
  `adaptationType` enum('difficulty_adjustment','content_variation','pacing_adjustment','learning_style_adaptation','remediation','enrichment','path_redirection') NOT NULL,
  `targetLearningStyles` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL CHECK (json_valid(`targetLearningStyles`)),
  `prerequisites` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL CHECK (json_valid(`prerequisites`)),
  `conceptsCovered` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL CHECK (json_valid(`conceptsCovered`)),
  `estimatedDuration` int(11) NOT NULL DEFAULT 5,
  `effectivenessScore` decimal(5,2) NOT NULL DEFAULT 0.00,
  `isActive` tinyint(4) NOT NULL DEFAULT 1,
  `adaptationRules` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`adaptationRules`)),
  `mediaAssets` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`mediaAssets`)),
  `interactiveElements` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`interactiveElements`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

CREATE TABLE `ai_recommendations` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `studentId` varchar(36) NOT NULL COMMENT 'Student user ID',
  `recommendationType` enum('next_lesson','review_content','practice_quiz','supplementary_material','course_recommendation','study_schedule','learning_path','skill_improvement','peer_study_group','tutor_session','break_suggestion','difficulty_adjustment','prediction_dropout_risk') NOT NULL COMMENT 'Type of recommendation',
  `contentId` varchar(36) DEFAULT NULL COMMENT 'Related content ID (course, lesson, assessment)',
  `contentType` varchar(50) DEFAULT NULL COMMENT 'Content type (course, lesson, assessment, skill)',
  `title` varchar(255) NOT NULL COMMENT 'Recommendation title',
  `description` text NOT NULL COMMENT 'Detailed recommendation description',
  `reason` text NOT NULL COMMENT 'AI reasoning for this recommendation',
  `confidenceScore` decimal(5,2) NOT NULL DEFAULT 0.50 COMMENT 'AI confidence score (0.0 - 1.0)',
  `priority` enum('low','medium','high','urgent') NOT NULL DEFAULT 'medium' COMMENT 'Recommendation priority level',
  `status` enum('pending','active','accepted','dismissed','expired','completed') NOT NULL DEFAULT 'pending' COMMENT 'Current recommendation status',
  `expiresAt` timestamp NULL DEFAULT NULL COMMENT 'When this recommendation expires',
  `interactedAt` timestamp NULL DEFAULT NULL COMMENT 'When user interacted with recommendation',
  `interactionType` varchar(50) DEFAULT NULL COMMENT 'User interaction type (viewed, clicked, accepted, dismissed)',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Recommendation-specific metadata' CHECK (json_valid(`metadata`)),
  `modelInfo` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'AI model information' CHECK (json_valid(`modelInfo`)),
  `userContext` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'User context when recommendation was generated' CHECK (json_valid(`userContext`)),
  `expectedOutcomes` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Expected outcomes from this recommendation' CHECK (json_valid(`expectedOutcomes`)),
  `abTestInfo` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'A/B testing information' CHECK (json_valid(`abTestInfo`)),
  `userRating` decimal(3,2) DEFAULT NULL COMMENT 'User feedback rating (1.0 - 5.0)',
  `userFeedback` text DEFAULT NULL COMMENT 'User feedback comments',
  `wasEffective` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether recommendation was effective',
  `effectivenessMetrics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Effectiveness metrics' CHECK (json_valid(`effectivenessMetrics`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;


CREATE TABLE `api_keys` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `key` varchar(255) NOT NULL,
  `name` varchar(255) NOT NULL,
  `description` varchar(255) DEFAULT NULL,
  `userId` varchar(255) NOT NULL,
  `status` enum('active','inactive','suspended','revoked') NOT NULL DEFAULT 'active',
  `permissions` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL CHECK (json_valid(`permissions`)),
  `restrictions` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`restrictions`)),
  `rateLimit` int(11) NOT NULL DEFAULT 1000,
  `usageCount` int(11) NOT NULL DEFAULT 0,
  `lastUsedAt` timestamp NULL DEFAULT NULL,
  `expiresAt` timestamp NULL DEFAULT NULL,
  `lastUsedIp` varchar(255) DEFAULT NULL,
  `lastUsedUserAgent` varchar(255) DEFAULT NULL,
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;


CREATE TABLE `assessments` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `courseId` varchar(36) DEFAULT NULL COMMENT 'Course ID if assessment is course-level',
  `lessonId` varchar(36) DEFAULT NULL COMMENT 'Lesson ID if assessment is lesson-level',
  `teacherId` varchar(36) NOT NULL COMMENT 'Teacher/Creator ID',
  `title` varchar(255) NOT NULL COMMENT 'Assessment title',
  `description` varchar(500) NOT NULL COMMENT 'Assessment description',
  `instructions` text DEFAULT NULL COMMENT 'Detailed instructions for students',
  `assessmentType` enum('quiz','exam','assignment','survey','practice','final_exam','midterm','project') NOT NULL DEFAULT 'quiz' COMMENT 'Type of assessment',
  `status` enum('draft','published','archived','suspended') NOT NULL DEFAULT 'draft' COMMENT 'Assessment status',
  `timeLimit` int(11) DEFAULT NULL COMMENT 'Time limit in minutes',
  `maxAttempts` int(11) NOT NULL DEFAULT 1 COMMENT 'Maximum number of attempts allowed',
  `passingScore` decimal(5,2) NOT NULL DEFAULT 70.00 COMMENT 'Minimum score to pass (percentage)',
  `totalPoints` decimal(5,2) DEFAULT NULL COMMENT 'Total possible points',
  `randomizeQuestions` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether to randomize question order',
  `randomizeAnswers` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether to randomize answer options',
  `showResults` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Whether to show results immediately after submission',
  `showCorrectAnswers` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether to show correct answers after submission',
  `isMandatory` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether this assessment is mandatory',
  `isProctored` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether this is a proctored assessment',
  `availableFrom` timestamp NULL DEFAULT NULL COMMENT 'Assessment available from date',
  `availableUntil` timestamp NULL DEFAULT NULL COMMENT 'Assessment available until date',
  `gradingMethod` enum('automatic','manual','hybrid','peer_review') NOT NULL DEFAULT 'automatic' COMMENT 'How this assessment should be graded',
  `weight` decimal(5,2) NOT NULL DEFAULT 1.00 COMMENT 'Weight of this assessment in final grade',
  `settings` longtext DEFAULT NULL COMMENT 'Assessment configuration settings',
  `antiCheatSettings` longtext DEFAULT NULL COMMENT 'Anti-cheating configuration',
  `metadata` longtext DEFAULT NULL COMMENT 'Additional metadata for assessment'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;



CREATE TABLE `assessment_attempts` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `studentId` varchar(36) NOT NULL COMMENT 'Student user ID',
  `assessmentId` varchar(36) NOT NULL COMMENT 'Assessment ID',
  `attemptNumber` int(11) NOT NULL COMMENT 'Attempt number for this student',
  `startedAt` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'When the attempt was started',
  `submittedAt` timestamp NULL DEFAULT NULL COMMENT 'When the attempt was submitted',
  `gradingStatus` enum('pending','graded','reviewing','disputed') NOT NULL DEFAULT 'pending' COMMENT 'Grading status of the attempt',
  `score` decimal(5,2) DEFAULT NULL COMMENT 'Score achieved in this attempt',
  `maxScore` decimal(5,2) DEFAULT NULL COMMENT 'Maximum possible score',
  `percentage` decimal(5,2) DEFAULT NULL COMMENT 'Percentage score',
  `timeTaken` int(11) DEFAULT NULL COMMENT 'Time taken to complete in seconds',
  `status` enum('in_progress','submitted','abandoned','timed_out','flagged') NOT NULL DEFAULT 'in_progress' COMMENT 'Current status of the attempt',
  `answers` longtext DEFAULT NULL COMMENT 'Student answers for all questions',
  `feedback` longtext DEFAULT NULL COMMENT 'Overall feedback for the attempt',
  `gradedBy` varchar(36) DEFAULT NULL COMMENT 'Graded by user ID',
  `gradedAt` timestamp NULL DEFAULT NULL COMMENT 'When the attempt was graded',
  `isFlagged` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether this attempt is flagged for review',
  `flagReason` text DEFAULT NULL COMMENT 'Flag reason if attempt is flagged',
  `proctoringData` longtext DEFAULT NULL COMMENT 'Proctoring data and flags',
  `sessionData` longtext DEFAULT NULL COMMENT 'Session tracking data',
  `analyticsData` longtext DEFAULT NULL COMMENT 'Learning analytics data',
  `metadata` longtext DEFAULT NULL COMMENT 'Additional attempt metadata'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;


CREATE TABLE `assessment_sessions` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `sessionToken` varchar(255) NOT NULL COMMENT 'Unique session token',
  `status` enum('preparing','active','paused','completed','expired','terminated') NOT NULL DEFAULT 'preparing' COMMENT 'Session status',
  `startedAt` timestamp NULL DEFAULT NULL COMMENT 'Session start time',
  `endedAt` timestamp NULL DEFAULT NULL COMMENT 'Session end time',
  `expiresAt` timestamp NULL DEFAULT NULL COMMENT 'Session expiration time',
  `timeRemaining` int(11) DEFAULT NULL COMMENT 'Time remaining in seconds',
  `lastActivityAt` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'Last activity timestamp',
  `currentQuestionIndex` int(11) NOT NULL DEFAULT 0 COMMENT 'Current question index',
  `questionsAnswered` int(11) NOT NULL DEFAULT 0 COMMENT 'Questions answered count',
  `totalQuestions` int(11) NOT NULL COMMENT 'Total questions count',
  `progressPercentage` decimal(5,2) NOT NULL DEFAULT 0.00 COMMENT 'Progress percentage',
  `currentAnswers` longtext DEFAULT NULL COMMENT 'Current answers (JSON)',
  `lastAutoSaveAt` timestamp NULL DEFAULT NULL COMMENT 'Last auto-save timestamp',
  `autoSaveInterval` int(11) NOT NULL DEFAULT 30 COMMENT 'Auto-save interval in seconds',
  `securityEvents` longtext DEFAULT NULL COMMENT 'Security events log (JSON)',
  `securityViolationsCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Security violations count',
  `isFlagged` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is session flagged for review',
  `flagReason` text DEFAULT NULL COMMENT 'Flag reason',
  `browserInfo` longtext DEFAULT NULL COMMENT 'Browser information (JSON)',
  `screenResolution` varchar(50) DEFAULT NULL COMMENT 'Screen resolution',
  `isFullscreen` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is fullscreen mode',
  `tabSwitchCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Tab switches count',
  `connectionInterruptions` int(11) NOT NULL DEFAULT 0 COMMENT 'Connection interruptions count',
  `lastPingAt` timestamp NULL DEFAULT NULL COMMENT 'Last ping timestamp',
  `networkQuality` decimal(3,2) DEFAULT NULL COMMENT 'Network quality score',
  `sessionConfig` longtext DEFAULT NULL COMMENT 'Session configuration (JSON)',
  `questionsOrder` longtext DEFAULT NULL COMMENT 'Randomized questions order (JSON)',
  `metadata` longtext DEFAULT NULL COMMENT 'Additional metadata (JSON)',
  `studentId` varchar(36) NOT NULL COMMENT 'Student ID',
  `assessmentId` varchar(36) NOT NULL COMMENT 'Assessment ID',
  `attemptId` varchar(36) DEFAULT NULL COMMENT 'Assessment attempt ID'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `assignments`
--

CREATE TABLE `assignments` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `title` varchar(255) NOT NULL COMMENT 'Assignment title',
  `description` text DEFAULT NULL COMMENT 'Assignment description',
  `instructorId` varchar(36) NOT NULL COMMENT 'Instructor user ID',
  `courseId` varchar(36) NOT NULL COMMENT 'Associated course ID',
  `status` enum('draft','published','archived') NOT NULL DEFAULT 'draft' COMMENT 'Assignment status',
  `dueDate` timestamp NULL DEFAULT NULL COMMENT 'Assignment due date',
  `maxPoints` int(11) NOT NULL DEFAULT 100 COMMENT 'Maximum points',
  `instructions` longtext DEFAULT NULL COMMENT 'Assignment instructions',
  `requirements` longtext DEFAULT NULL COMMENT 'Submission requirements (JSON)',
  `rubric` longtext DEFAULT NULL COMMENT 'Grading rubric (JSON)',
  `attachments` longtext DEFAULT NULL COMMENT 'Assignment attachments (JSON)',
  `metadata` longtext DEFAULT NULL COMMENT 'Additional metadata (JSON)'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `audit_logs`
--

CREATE TABLE `audit_logs` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `userId` varchar(36) DEFAULT NULL COMMENT 'User who performed the action',
  `sessionId` varchar(255) DEFAULT NULL COMMENT 'Session identifier',
  `action` enum('login','login_2fa_required','user_login_2fa_success','login_2fa_completed','user_registered','user_updated','user_deleted','logout','user_logout','user_logout_all_devices','create','read','update','delete','import','export','upload','download','approve','reject','suspend','activate','reset_password','change_password','grant_permission','password_reset_requested','password_reset_completed','revoke_permission','system_config','backup','restore','email_verified','email_verification_resent','session_terminated','create_assessment','update_assessment','delete_assessment','configure_assessment','publish_assessment','archive_assessment','duplicate_assessment','remove_question','start_assessment','submit_answer','submit_assessment','security_event','pause_assessment','resume_assessment') NOT NULL COMMENT 'Action that was performed',
  `entityType` varchar(100) DEFAULT NULL COMMENT 'Type of entity affected',
  `entityId` varchar(36) DEFAULT NULL COMMENT 'ID of entity affected',
  `description` text NOT NULL COMMENT 'Description of the action',
  `level` enum('debug','info','warning','error','critical') NOT NULL DEFAULT 'info' COMMENT 'Severity level of the action',
  `status` enum('success','failed','error','pending') NOT NULL DEFAULT 'success' COMMENT 'Status of the action',
  `timestamp` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'When the action occurred',
  `ipAddress` varchar(45) DEFAULT NULL COMMENT 'IP address of the user',
  `userAgent` text DEFAULT NULL COMMENT 'User agent string',
  `requestUrl` varchar(255) DEFAULT NULL COMMENT 'Request URL or endpoint',
  `httpMethod` varchar(10) DEFAULT NULL COMMENT 'HTTP method used',
  `responseCode` int(11) DEFAULT NULL COMMENT 'HTTP response status code',
  `processingTime` int(11) DEFAULT NULL COMMENT 'Request processing time in milliseconds',
  `requestData` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Request parameters and payload' CHECK (json_valid(`requestData`)),
  `responseData` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Response data (sanitized)' CHECK (json_valid(`responseData`)),
  `changes` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Changes made (before/after values)' CHECK (json_valid(`changes`)),
  `context` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional context information' CHECK (json_valid(`context`)),
  `securityInfo` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Security-related information' CHECK (json_valid(`securityInfo`)),
  `errorDetails` text DEFAULT NULL COMMENT 'Error details if action failed',
  `errorCode` varchar(255) DEFAULT NULL COMMENT 'Error code or exception type',
  `stackTrace` text DEFAULT NULL COMMENT 'Stack trace for errors',
  `relatedEntities` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Related entities affected by this action' CHECK (json_valid(`relatedEntities`)),
  `tags` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Tags for categorization and filtering' CHECK (json_valid(`tags`)),
  `isSensitive` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether this is a sensitive action requiring special attention',
  `requiresReview` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether this action requires manual review',
  `reviewedBy` varchar(36) DEFAULT NULL COMMENT 'ID of admin who reviewed this action',
  `reviewedAt` timestamp NULL DEFAULT NULL COMMENT 'When this action was reviewed',
  `reviewNotes` text DEFAULT NULL COMMENT 'Review notes',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional audit metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `categories`
--

CREATE TABLE `categories` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `name` varchar(255) NOT NULL COMMENT 'Category name',
  `slug` varchar(255) NOT NULL COMMENT 'URL-friendly slug',
  `description` text DEFAULT NULL COMMENT 'Category description',
  `iconUrl` varchar(500) DEFAULT NULL COMMENT 'Category icon URL or identifier',
  `coverUrl` varchar(500) DEFAULT NULL COMMENT 'Category cover image URL',
  `color` varchar(20) DEFAULT NULL COMMENT 'Category color theme',
  `orderIndex` int(11) NOT NULL DEFAULT 0 COMMENT 'Display order within parent category',
  `level` int(11) NOT NULL DEFAULT 0 COMMENT 'Hierarchy level (0 = root)',
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Category active status',
  `showInMenu` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Show in navigation menu',
  `isFeatured` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Featured category status',
  `courseCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of courses in this category',
  `seoMeta` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'SEO metadata' CHECK (json_valid(`seoMeta`)),
  `settings` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Category settings and preferences' CHECK (json_valid(`settings`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional category metadata' CHECK (json_valid(`metadata`)),
  `parentId` varchar(36) DEFAULT NULL COMMENT 'Parent category ID',
  `mpath` varchar(255) DEFAULT ''
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `chatbot_conversations`
--

CREATE TABLE `chatbot_conversations` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `userId` varchar(36) NOT NULL COMMENT 'User participating in conversation',
  `courseId` varchar(36) DEFAULT NULL COMMENT 'Related course context',
  `title` varchar(255) DEFAULT NULL COMMENT 'Conversation title',
  `status` enum('active','paused','completed','escalated','archived') NOT NULL DEFAULT 'active' COMMENT 'Current conversation status',
  `conversationType` enum('general','academic_help','technical_support','course_guidance','career_advice','study_planning','assessment_help','onboarding') NOT NULL DEFAULT 'general' COMMENT 'Type of conversation',
  `startedAt` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'When conversation started',
  `endedAt` timestamp NULL DEFAULT NULL COMMENT 'When conversation ended',
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Whether conversation is currently active',
  `messageCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Total number of messages in conversation',
  `userMessageCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of user messages',
  `botMessageCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of bot messages',
  `lastMessageAt` timestamp NULL DEFAULT NULL COMMENT 'Last message timestamp',
  `lastMessageBy` varchar(10) DEFAULT NULL COMMENT 'Who sent the last message (user/bot)',
  `context` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Current conversation context' CHECK (json_valid(`context`)),
  `userProfile` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'User profile and learning context' CHECK (json_valid(`userProfile`)),
  `summary` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Conversation history summary' CHECK (json_valid(`summary`)),
  `aiConfig` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'AI model configuration used' CHECK (json_valid(`aiConfig`)),
  `learningAnalytics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Learning analytics from conversation' CHECK (json_valid(`learningAnalytics`)),
  `qualityMetrics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Conversation quality metrics' CHECK (json_valid(`qualityMetrics`)),
  `escalation` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Escalation information' CHECK (json_valid(`escalation`)),
  `rating` decimal(3,2) DEFAULT NULL COMMENT 'Overall conversation rating (1.0 - 5.0)',
  `feedback` text DEFAULT NULL COMMENT 'User feedback about the conversation',
  `integrations` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Integration data with external systems' CHECK (json_valid(`integrations`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional conversation metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `chatbot_messages`
--

CREATE TABLE `chatbot_messages` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `conversationId` varchar(36) NOT NULL COMMENT 'Conversation this message belongs to',
  `sender` enum('user','bot','system') NOT NULL COMMENT 'Who sent the message',
  `content` text NOT NULL COMMENT 'Message content',
  `messageType` enum('text','rich_text','image','audio','video','file','interactive','system','typing') NOT NULL DEFAULT 'text' COMMENT 'Type of message',
  `status` enum('sending','sent','delivered','read','failed','processing') NOT NULL DEFAULT 'sent' COMMENT 'Message status',
  `timestamp` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'Message timestamp',
  `attachments` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Rich content attachments' CHECK (json_valid(`attachments`)),
  `aiMetadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'AI processing metadata' CHECK (json_valid(`aiMetadata`)),
  `inputAnalysis` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'User input analysis' CHECK (json_valid(`inputAnalysis`)),
  `interactiveElements` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Interactive elements in message' CHECK (json_valid(`interactiveElements`)),
  `personalization` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Personalization data' CHECK (json_valid(`personalization`)),
  `educationalContent` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Educational content metadata' CHECK (json_valid(`educationalContent`)),
  `isImportant` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether message contains important information',
  `needsFollowUp` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether message is marked for follow-up',
  `isFlagged` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether message was flagged by user',
  `flagReason` text DEFAULT NULL COMMENT 'Flag reason if message was flagged',
  `userRating` decimal(3,2) DEFAULT NULL COMMENT 'User rating for this message (1.0 - 5.0)',
  `userFeedback` text DEFAULT NULL COMMENT 'User feedback for this specific message',
  `errorInfo` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Error information if message failed' CHECK (json_valid(`errorInfo`)),
  `analytics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Analytics and tracking data' CHECK (json_valid(`analytics`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional message metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `chat_files`
--

CREATE TABLE `chat_files` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `messageId` varchar(36) NOT NULL,
  `uploadedBy` varchar(36) NOT NULL,
  `originalName` varchar(255) NOT NULL COMMENT 'Original filename',
  `filePath` varchar(500) NOT NULL COMMENT 'File storage path/URL',
  `mimeType` varchar(100) NOT NULL COMMENT 'File MIME type',
  `fileSize` bigint(20) NOT NULL COMMENT 'File size in bytes',
  `fileExtension` varchar(50) NOT NULL COMMENT 'File extension',
  `fileCategory` enum('image','video','audio','document','archive','other') NOT NULL DEFAULT 'other' COMMENT 'File category',
  `thumbnailUrl` varchar(500) DEFAULT NULL COMMENT 'File thumbnail URL for images/videos',
  `duration` int(11) DEFAULT NULL COMMENT 'Duration for audio/video files in seconds',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'File metadata (dimensions, codec, etc.)' CHECK (json_valid(`metadata`)),
  `status` enum('uploading','processing','ready','failed','deleted') NOT NULL DEFAULT 'uploading' COMMENT 'File processing status',
  `errorMessage` text DEFAULT NULL COMMENT 'Processing error message if failed',
  `downloadCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Download count',
  `expiresAt` timestamp NULL DEFAULT NULL COMMENT 'File expiry date',
  `isPublic` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is file public/shareable',
  `description` varchar(500) DEFAULT NULL COMMENT 'File description/caption'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `chat_messages`
--

CREATE TABLE `chat_messages` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `roomId` varchar(36) NOT NULL COMMENT 'Chat room ID',
  `senderId` varchar(36) NOT NULL COMMENT 'Message sender ID',
  `content` text NOT NULL COMMENT 'Message content',
  `messageType` enum('text','image','video','audio','file','link','code','system','announcement','poll','quiz') NOT NULL DEFAULT 'text' COMMENT 'Type of message',
  `parentMessageId` varchar(36) DEFAULT NULL COMMENT 'Parent message ID for replies',
  `threadId` varchar(36) DEFAULT NULL COMMENT 'Thread ID for threaded conversations',
  `mentions` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Message mentions (users, channels, etc.)' CHECK (json_valid(`mentions`)),
  `isEdited` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is message edited',
  `editedAt` timestamp NULL DEFAULT NULL COMMENT 'Last edit timestamp',
  `editHistory` text DEFAULT NULL COMMENT 'Edit history (JSON array)',
  `isPinned` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is message pinned',
  `pinnedAt` timestamp NULL DEFAULT NULL COMMENT 'Pin timestamp',
  `pinnedBy` varchar(36) DEFAULT NULL COMMENT 'User who pinned the message',
  `isFlagged` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is message flagged for moderation',
  `isHidden` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is message hidden by moderation',
  `reactionCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of reactions',
  `replyCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of replies',
  `readBy` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Read receipts tracking' CHECK (json_valid(`readBy`)),
  `priority` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Message priority and urgency' CHECK (json_valid(`priority`)),
  `formatting` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Message formatting and styling' CHECK (json_valid(`formatting`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Message metadata' CHECK (json_valid(`metadata`)),
  `status` enum('sending','sent','delivered','read','failed','deleted') NOT NULL DEFAULT 'sent' COMMENT 'Message delivery status',
  `originalContent` text DEFAULT NULL COMMENT 'Original content before edit',
  `isDeleted` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether message is deleted',
  `deletedBy` varchar(36) DEFAULT NULL COMMENT 'ID of user who deleted the message',
  `flaggedBy` varchar(36) DEFAULT NULL COMMENT 'ID of user who flagged the message',
  `flagReason` text DEFAULT NULL COMMENT 'Reason for flagging',
  `linkPreview` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Link preview data' CHECK (json_valid(`linkPreview`)),
  `translations` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Message translation data' CHECK (json_valid(`translations`)),
  `moderationResult` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'AI moderation results' CHECK (json_valid(`moderationResult`)),
  `analytics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Message analytics data' CHECK (json_valid(`analytics`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `chat_message_reactions`
--

CREATE TABLE `chat_message_reactions` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `messageId` varchar(36) NOT NULL,
  `userId` varchar(36) NOT NULL,
  `emoji` varchar(50) NOT NULL COMMENT 'Emoji or reaction type',
  `emojiCode` varchar(100) DEFAULT NULL COMMENT 'Unicode emoji code',
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Is reaction active'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `chat_message_threads`
--

CREATE TABLE `chat_message_threads` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `parentMessageId` varchar(36) NOT NULL,
  `roomId` varchar(36) NOT NULL,
  `title` varchar(255) DEFAULT NULL COMMENT 'Thread title/subject',
  `description` text DEFAULT NULL COMMENT 'Thread description',
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Is thread active',
  `isPinned` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is thread pinned',
  `isResolved` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is thread resolved',
  `resolvedAt` timestamp NULL DEFAULT NULL COMMENT 'Thread resolved at',
  `resolvedBy` varchar(36) DEFAULT NULL COMMENT 'Thread resolved by user ID',
  `replyCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of replies in thread',
  `lastReplyAt` timestamp NULL DEFAULT NULL COMMENT 'Last reply timestamp',
  `lastReplyBy` varchar(36) DEFAULT NULL COMMENT 'Last reply author ID',
  `participants` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Thread participants list' CHECK (json_valid(`participants`)),
  `tags` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Thread tags/labels' CHECK (json_valid(`tags`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Thread metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `chat_moderation`
--

CREATE TABLE `chat_moderation` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `messageId` varchar(36) DEFAULT NULL,
  `roomId` varchar(36) NOT NULL,
  `targetUserId` varchar(36) NOT NULL,
  `moderatorId` varchar(36) NOT NULL,
  `action` enum('warn','mute','kick','ban','delete_message','edit_message','flag_content','timeout','restrict_permissions') NOT NULL COMMENT 'Moderation action type',
  `reason` text NOT NULL COMMENT 'Reason for moderation action',
  `notes` text DEFAULT NULL COMMENT 'Additional notes from moderator',
  `status` enum('pending','applied','appealed','reversed','expired') NOT NULL DEFAULT 'pending' COMMENT 'Moderation status',
  `expiresAt` timestamp NULL DEFAULT NULL COMMENT 'When moderation action expires',
  `appliedAt` timestamp NULL DEFAULT NULL COMMENT 'When action was applied',
  `severity` enum('low','medium','high','critical') NOT NULL DEFAULT 'medium' COMMENT 'Severity level',
  `isAutomated` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Was action automated by AI',
  `confidenceScore` decimal(3,2) DEFAULT NULL COMMENT 'AI confidence score for automated actions',
  `evidence` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Evidence and context for moderation' CHECK (json_valid(`evidence`)),
  `appeal` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Appeal information if applicable' CHECK (json_valid(`appeal`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `chat_participants`
--

CREATE TABLE `chat_participants` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `roomId` varchar(36) NOT NULL COMMENT 'Chat room ID',
  `userId` varchar(36) NOT NULL COMMENT 'User ID',
  `role` enum('owner','admin','moderator','member','guest','attendee','presenter','co_host','host') NOT NULL DEFAULT 'member' COMMENT 'Role of participant in the room',
  `status` enum('active','inactive','banned','muted','away','busy') NOT NULL DEFAULT 'active' COMMENT 'Current status of participant',
  `joinedAt` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'When user joined the room',
  `leftAt` timestamp NULL DEFAULT NULL COMMENT 'When user left the room',
  `lastRead` timestamp NULL DEFAULT NULL COMMENT 'Last message read timestamp',
  `lastReadMessageId` varchar(36) DEFAULT NULL COMMENT 'ID of last read message',
  `unreadCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of unread messages',
  `isMuted` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether notifications are muted',
  `isPinned` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether participant is pinned in room list',
  `isTyping` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether participant is currently typing',
  `lastActiveAt` timestamp NULL DEFAULT NULL COMMENT 'Last activity timestamp in room',
  `lastSeenAt` timestamp NULL DEFAULT NULL COMMENT 'When user was last seen online',
  `nickname` varchar(255) DEFAULT NULL COMMENT 'Custom nickname in this room',
  `customColor` varchar(7) DEFAULT NULL COMMENT 'Custom color for messages in this room',
  `permissions` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Participant permissions in this room' CHECK (json_valid(`permissions`)),
  `notificationSettings` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Notification preferences for this room' CHECK (json_valid(`notificationSettings`)),
  `statistics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Participant statistics in this room' CHECK (json_valid(`statistics`)),
  `bannedAt` timestamp NULL DEFAULT NULL COMMENT 'When participant was banned (if applicable)',
  `bannedBy` varchar(36) DEFAULT NULL COMMENT 'ID of user who banned this participant',
  `banReason` text DEFAULT NULL COMMENT 'Reason for ban',
  `banExpiresAt` timestamp NULL DEFAULT NULL COMMENT 'When ban expires (null for permanent)',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional participant metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `chat_rooms`
--

CREATE TABLE `chat_rooms` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `name` varchar(255) NOT NULL COMMENT 'Chat room name',
  `description` text DEFAULT NULL COMMENT 'Chat room description',
  `roomType` enum('general','course','lesson','study_group','office_hours','help_desk','announcements','private','public') NOT NULL DEFAULT 'general' COMMENT 'Type of chat room',
  `status` enum('active','inactive','archived','locked','maintenance') NOT NULL DEFAULT 'active' COMMENT 'Current status of the room',
  `courseId` varchar(36) DEFAULT NULL COMMENT 'Related course ID',
  `lessonId` varchar(36) DEFAULT NULL COMMENT 'Related lesson ID',
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Whether the room is active',
  `isPrivate` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether the room is private (invite-only)',
  `maxParticipants` int(11) DEFAULT NULL COMMENT 'Maximum number of participants',
  `participantCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Current number of participants',
  `messageCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Total number of messages in room',
  `lastMessage` text DEFAULT NULL COMMENT 'Last message content in the room',
  `lastMessageAt` timestamp NULL DEFAULT NULL COMMENT 'Last message timestamp',
  `lastMessageBy` varchar(36) DEFAULT NULL COMMENT 'ID of last message sender',
  `lastActivityAt` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'Timestamp of last activity in room',
  `avatarUrl` varchar(500) DEFAULT NULL COMMENT 'Room avatar/image URL',
  `settings` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Room settings and permissions' CHECK (json_valid(`settings`)),
  `moderationSettings` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Moderation rules and settings' CHECK (json_valid(`moderationSettings`)),
  `analytics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Room analytics and metrics' CHECK (json_valid(`analytics`)),
  `expiresAt` timestamp NULL DEFAULT NULL COMMENT 'Room expiry date for temporary rooms',
  `integrations` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Integration settings (Discord, Slack, etc.)' CHECK (json_valid(`integrations`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional room metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `collaborative_notes`
--

CREATE TABLE `collaborative_notes` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `title` varchar(255) NOT NULL COMMENT 'Note title',
  `content` longtext NOT NULL COMMENT 'Note content',
  `contentHtml` longtext DEFAULT NULL COMMENT 'Note content in HTML format',
  `type` enum('personal','shared','collaborative','template') NOT NULL DEFAULT 'personal' COMMENT 'Note type',
  `status` enum('draft','published','archived','deleted') NOT NULL DEFAULT 'draft' COMMENT 'Note status',
  `authorId` varchar(36) NOT NULL COMMENT 'Note author ID',
  `studyGroupId` varchar(36) DEFAULT NULL COMMENT 'Associated study group ID',
  `courseId` varchar(36) DEFAULT NULL COMMENT 'Associated course ID',
  `lessonId` varchar(36) DEFAULT NULL COMMENT 'Associated lesson ID',
  `tags` longtext DEFAULT NULL COMMENT 'Note tags (JSON)',
  `isPinned` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is note pinned',
  `isTemplate` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is note template',
  `templateId` varchar(36) DEFAULT NULL COMMENT 'Template source ID',
  `version` int(11) NOT NULL DEFAULT 0 COMMENT 'Note version',
  `lastEditedAt` timestamp NULL DEFAULT NULL COMMENT 'Last edit timestamp',
  `lastEditedBy` varchar(36) DEFAULT NULL COMMENT 'Last editor ID',
  `permissions` longtext DEFAULT NULL COMMENT 'Note permissions (JSON)',
  `settings` longtext DEFAULT NULL COMMENT 'Note settings (JSON)',
  `metadata` longtext DEFAULT NULL COMMENT 'Additional metadata (JSON)'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `compliance_audit_trails`
--

CREATE TABLE `compliance_audit_trails` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `eventType` enum('data_access','data_modification','data_deletion','consent_change','privacy_settings_change','data_export','data_breach','security_incident','compliance_check','policy_update') NOT NULL,
  `timestamp` datetime NOT NULL,
  `subjectUserId` varchar(36) DEFAULT NULL,
  `performedBy` varchar(36) DEFAULT NULL,
  `ipAddress` varchar(45) DEFAULT NULL,
  `userAgent` text DEFAULT NULL,
  `description` text NOT NULL,
  `eventData` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`eventData`)),
  `complianceStatus` enum('compliant','non_compliant','under_review','remediated') NOT NULL DEFAULT 'compliant',
  `applicableRegulations` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`applicableRegulations`)),
  `complianceNotes` text DEFAULT NULL,
  `riskLevel` varchar(50) DEFAULT NULL,
  `riskFactors` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`riskFactors`)),
  `riskMitigation` text DEFAULT NULL,
  `requiredActions` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`requiredActions`)),
  `reviewedAt` datetime DEFAULT NULL,
  `reviewedBy` varchar(36) DEFAULT NULL,
  `reviewNotes` text DEFAULT NULL,
  `evidence` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`evidence`)),
  `relatedDocuments` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`relatedDocuments`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `consent_records`
--

CREATE TABLE `consent_records` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `user_id` varchar(36) NOT NULL,
  `type` enum('cookies','marketing','analytics','profiling','data_processing','third_party_sharing','automated_decisions','communication','location_tracking') NOT NULL,
  `status` enum('given','withdrawn','expired','pending') NOT NULL DEFAULT 'pending',
  `method` enum('explicit','implicit','opt_out','legitimate_interest') NOT NULL,
  `purpose` text NOT NULL,
  `legalBasis` text DEFAULT NULL,
  `consentGivenAt` datetime NOT NULL,
  `consentWithdrawnAt` datetime DEFAULT NULL,
  `expiresAt` datetime DEFAULT NULL,
  `version` varchar(100) DEFAULT NULL,
  `consentDetails` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`consentDetails`)),
  `ipAddress` varchar(45) DEFAULT NULL,
  `userAgent` text DEFAULT NULL,
  `source` varchar(100) DEFAULT NULL,
  `consentInterface` varchar(255) DEFAULT NULL,
  `evidence` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`evidence`)),
  `thirdParties` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`thirdParties`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `content_quality_assessments`
--

CREATE TABLE `content_quality_assessments` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `content_type` enum('course','lesson') NOT NULL,
  `content_id` varchar(36) NOT NULL,
  `overall_score` decimal(5,2) NOT NULL,
  `quality_level` enum('excellent','good','satisfactory','needs_improvement','poor') NOT NULL,
  `assessed_at` timestamp NULL DEFAULT NULL,
  `is_latest` tinyint(4) NOT NULL DEFAULT 1,
  `ai_model_version` varchar(50) DEFAULT NULL,
  `dimensionScores` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL CHECK (json_valid(`dimensionScores`)),
  `analysis` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`analysis`)),
  `improvements` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`improvements`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `content_similarities`
--

CREATE TABLE `content_similarities` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `source_content_type` enum('course','lesson') NOT NULL,
  `source_content_id` varchar(36) NOT NULL,
  `target_content_type` enum('course','lesson') NOT NULL,
  `target_content_id` varchar(36) NOT NULL,
  `similarity_type` enum('semantic','structural','topic','difficulty','comprehensive') NOT NULL DEFAULT 'semantic',
  `similarity_score` decimal(5,4) NOT NULL,
  `status` enum('calculated','processing','failed','outdated') NOT NULL DEFAULT 'calculated',
  `calculated_at` timestamp NULL DEFAULT NULL,
  `algorithm_version` varchar(50) DEFAULT NULL,
  `analysis` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`analysis`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `content_tags`
--

CREATE TABLE `content_tags` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `content_type` enum('course','lesson') NOT NULL,
  `content_id` varchar(36) NOT NULL,
  `tag` varchar(100) NOT NULL,
  `category` enum('topic','difficulty','skill','subject','learning_objective','content_type','language') NOT NULL DEFAULT 'topic',
  `type` enum('auto_generated','manual','ai_suggested','system') NOT NULL DEFAULT 'auto_generated',
  `confidence` decimal(5,4) NOT NULL DEFAULT 1.0000,
  `description` text DEFAULT NULL,
  `is_active` tinyint(4) NOT NULL DEFAULT 1,
  `is_verified` tinyint(4) NOT NULL DEFAULT 0,
  `verified_by` varchar(36) DEFAULT NULL,
  `verified_at` timestamp NULL DEFAULT NULL,
  `ai_model_version` varchar(50) DEFAULT NULL,
  `extraction_method` varchar(100) DEFAULT NULL,
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `content_versions`
--

CREATE TABLE `content_versions` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `lessonId` varchar(36) NOT NULL COMMENT 'Reference to lesson',
  `versionNumber` int(11) NOT NULL COMMENT 'Version number (incremental)',
  `content` longtext DEFAULT NULL COMMENT 'Lesson content for this version',
  `description` text DEFAULT NULL COMMENT 'Lesson description for this version',
  `versionNote` varchar(255) DEFAULT NULL COMMENT 'Note about this version change',
  `isActive` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether this is the current active version',
  `contentMetadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Content metadata and settings for this version' CHECK (json_valid(`contentMetadata`)),
  `changesSummary` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Change summary between versions' CHECK (json_valid(`changesSummary`)),
  `versionType` enum('major','minor','patch','draft') NOT NULL DEFAULT 'minor' COMMENT 'Type of version change',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional version metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `courses`
--

CREATE TABLE `courses` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `title` varchar(255) NOT NULL COMMENT 'Course title',
  `slug` varchar(255) NOT NULL COMMENT 'URL-friendly slug',
  `description` text NOT NULL COMMENT 'Course description',
  `shortDescription` varchar(500) DEFAULT NULL COMMENT 'Short course description for previews',
  `thumbnailUrl` varchar(500) DEFAULT NULL COMMENT 'Course thumbnail image URL',
  `trailerVideoUrl` varchar(500) DEFAULT NULL COMMENT 'Course trailer video URL',
  `teacherId` varchar(36) NOT NULL COMMENT 'Teacher/Instructor ID',
  `categoryId` varchar(36) NOT NULL COMMENT 'Course category ID',
  `level` enum('beginner','intermediate','advanced','expert','all_levels') NOT NULL DEFAULT 'beginner' COMMENT 'Course difficulty level',
  `language` enum('en','vi','es','fr','de','zh','ja','ko') NOT NULL DEFAULT 'en' COMMENT 'Course language',
  `durationHours` int(11) DEFAULT NULL COMMENT 'Estimated course duration in hours',
  `durationMinutes` int(11) DEFAULT NULL COMMENT 'Estimated course duration in minutes',
  `price` decimal(10,2) NOT NULL DEFAULT 0.00 COMMENT 'Course price',
  `currency` varchar(3) NOT NULL DEFAULT 'USD' COMMENT 'Price currency code',
  `originalPrice` decimal(10,2) DEFAULT NULL COMMENT 'Original price before discount',
  `isFree` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is course free',
  `pricingModel` enum('free','paid','subscription','freemium') NOT NULL DEFAULT 'free' COMMENT 'Course pricing model',
  `status` enum('draft','under_review','published','archived','suspended') NOT NULL DEFAULT 'draft' COMMENT 'Course status',
  `enrollmentLimit` int(11) DEFAULT NULL COMMENT 'Maximum number of enrollments',
  `tags` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Course tags for categorization' CHECK (json_valid(`tags`)),
  `requirements` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Course prerequisites' CHECK (json_valid(`requirements`)),
  `whatYouWillLearn` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'What students will learn' CHECK (json_valid(`whatYouWillLearn`)),
  `targetAudience` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Target audience description' CHECK (json_valid(`targetAudience`)),
  `rating` decimal(3,2) NOT NULL DEFAULT 0.00 COMMENT 'Average course rating',
  `totalRatings` int(11) NOT NULL DEFAULT 0 COMMENT 'Total number of ratings',
  `totalEnrollments` int(11) NOT NULL DEFAULT 0 COMMENT 'Total number of enrollments',
  `totalCompletions` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of completed enrollments',
  `totalReviews` int(11) NOT NULL DEFAULT 0 COMMENT 'Total course reviews',
  `totalSections` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of course sections',
  `totalLessons` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of course lessons',
  `totalVideoDuration` int(11) NOT NULL DEFAULT 0 COMMENT 'Total video duration in seconds',
  `featured` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Featured course status',
  `bestseller` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Bestseller badge',
  `isNew` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'New course badge',
  `allowReviews` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Allow course reviews',
  `allowDiscussions` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Allow course discussions',
  `hasCertificate` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Course completion certificate available',
  `lifetimeAccess` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Lifetime access to course',
  `accessDuration` int(11) DEFAULT NULL COMMENT 'Access duration in days (if not lifetime)',
  `availableFrom` datetime DEFAULT NULL COMMENT 'Course available from',
  `availableUntil` datetime DEFAULT NULL COMMENT 'Course available until',
  `publishedAt` timestamp NULL DEFAULT NULL COMMENT 'Course published date',
  `lastUpdatedAt` timestamp NULL DEFAULT NULL COMMENT 'Last content update',
  `seoMeta` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'SEO metadata' CHECK (json_valid(`seoMeta`)),
  `settings` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Course settings and preferences' CHECK (json_valid(`settings`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional course metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `course_sections`
--

CREATE TABLE `course_sections` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `courseId` varchar(36) NOT NULL COMMENT 'Course ID this section belongs to',
  `title` varchar(255) NOT NULL COMMENT 'Section title',
  `description` text DEFAULT NULL COMMENT 'Section description',
  `orderIndex` int(11) NOT NULL DEFAULT 0 COMMENT 'Order within course',
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Section active status',
  `isRequired` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Section completion required to proceed',
  `totalLessons` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of lessons in this section',
  `totalDuration` int(11) NOT NULL DEFAULT 0 COMMENT 'Total duration of all lessons in seconds',
  `availableFrom` timestamp NULL DEFAULT NULL COMMENT 'Section availability start date',
  `availableUntil` timestamp NULL DEFAULT NULL COMMENT 'Section availability end date',
  `objectives` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Section learning objectives' CHECK (json_valid(`objectives`)),
  `settings` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Section settings and preferences' CHECK (json_valid(`settings`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional section metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `data_anonymization_logs`
--

CREATE TABLE `data_anonymization_logs` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `entityType` varchar(100) NOT NULL,
  `entityId` varchar(36) NOT NULL,
  `anonymizationType` enum('pseudonymization','generalization','suppression','noise_addition','data_masking','synthetic_data') NOT NULL,
  `status` enum('pending','in_progress','completed','failed','reversed') NOT NULL DEFAULT 'pending',
  `performedBy` varchar(36) NOT NULL,
  `performedAt` datetime NOT NULL,
  `reason` text DEFAULT NULL,
  `fieldsAnonymized` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL CHECK (json_valid(`fieldsAnonymized`)),
  `anonymizationParameters` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`anonymizationParameters`)),
  `backupLocation` varchar(500) DEFAULT NULL,
  `backupChecksum` varchar(64) DEFAULT NULL,
  `backupExpiresAt` datetime DEFAULT NULL,
  `isReversible` tinyint(4) NOT NULL DEFAULT 0,
  `reversibilityKey` varchar(500) DEFAULT NULL,
  `reversedAt` datetime DEFAULT NULL,
  `reversedBy` varchar(36) DEFAULT NULL,
  `qualityMetrics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`qualityMetrics`)),
  `legalBasis` varchar(100) DEFAULT NULL,
  `relatedRequestId` varchar(36) DEFAULT NULL,
  `complianceChecks` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`complianceChecks`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `data_protection_requests`
--

CREATE TABLE `data_protection_requests` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `user_id` varchar(36) NOT NULL,
  `type` enum('access','rectification','erasure','restriction','portability','objection','withdraw_consent') NOT NULL COMMENT 'Type of data protection request (GDPR Article reference)',
  `status` enum('pending','in_progress','completed','rejected','cancelled','partially_completed') NOT NULL DEFAULT 'pending',
  `priority` enum('low','medium','high','urgent') NOT NULL DEFAULT 'medium',
  `description` text NOT NULL,
  `legalBasis` varchar(100) DEFAULT NULL,
  `dueDate` datetime DEFAULT NULL,
  `completedAt` datetime DEFAULT NULL,
  `processedBy` varchar(36) DEFAULT NULL,
  `processingNotes` text DEFAULT NULL,
  `rejectionReason` text DEFAULT NULL,
  `requestDetails` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`requestDetails`)),
  `processingLog` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`processingLog`)),
  `dataCategories` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`dataCategories`)),
  `affectedSystems` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`affectedSystems`)),
  `resultFilePath` varchar(500) DEFAULT NULL,
  `resultFileSize` bigint(20) DEFAULT NULL,
  `resultFileFormat` varchar(100) DEFAULT NULL,
  `resultExpiresAt` datetime DEFAULT NULL,
  `communications` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`communications`)),
  `isUrgent` tinyint(4) NOT NULL DEFAULT 0,
  `requiresManualReview` tinyint(4) NOT NULL DEFAULT 0,
  `hasThirdPartyData` tinyint(4) NOT NULL DEFAULT 0,
  `thirdParties` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`thirdParties`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `dropout_risk_assessments`
--

CREATE TABLE `dropout_risk_assessments` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `studentId` varchar(36) NOT NULL COMMENT 'Student user ID',
  `courseId` varchar(36) DEFAULT NULL COMMENT 'Course ID',
  `assessmentDate` datetime NOT NULL COMMENT 'Assessment date',
  `riskLevel` enum('very_low','low','medium','high','very_high') NOT NULL COMMENT 'Overall dropout risk level',
  `riskProbability` decimal(5,2) NOT NULL COMMENT 'Risk probability percentage (0-100)',
  `riskFactors` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL COMMENT 'Risk factors analysis' CHECK (json_valid(`riskFactors`)),
  `protectiveFactors` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Protective factors' CHECK (json_valid(`protectiveFactors`)),
  `interventionRequired` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether immediate intervention is required',
  `recommendedInterventions` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Recommended intervention types' CHECK (json_valid(`recommendedInterventions`)),
  `interventionRecommendations` text DEFAULT NULL COMMENT 'Specific intervention recommendations',
  `interventionPriority` int(11) NOT NULL COMMENT 'Priority level for intervention (1-10)',
  `interventionDeadline` datetime DEFAULT NULL COMMENT 'Recommended intervention timeline',
  `trendAnalysis` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Trend analysis data' CHECK (json_valid(`trendAnalysis`)),
  `studentNotified` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether student has been notified',
  `instructorNotified` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether instructor has been notified',
  `nextAssessmentDate` datetime DEFAULT NULL COMMENT 'Next assessment date',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional assessment metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `email_automation_steps`
--

CREATE TABLE `email_automation_steps` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `workflowId` varchar(36) NOT NULL COMMENT 'Workflow ID this step belongs to',
  `name` varchar(255) NOT NULL COMMENT 'Step name',
  `description` text DEFAULT NULL COMMENT 'Step description',
  `stepType` enum('email','delay','condition','action','split_test','goal') NOT NULL COMMENT 'Type of automation step',
  `status` enum('active','inactive','paused') NOT NULL DEFAULT 'active' COMMENT 'Current step status',
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Whether step is active',
  `orderIndex` int(11) NOT NULL COMMENT 'Order of step in workflow',
  `templateId` varchar(36) DEFAULT NULL COMMENT 'Template ID for email steps',
  `config` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Step configuration based on step type' CHECK (json_valid(`config`)),
  `executionConditions` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Step execution conditions' CHECK (json_valid(`executionConditions`)),
  `executionCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of times step was executed',
  `successCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of successful executions',
  `failureCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of failed executions',
  `openRate` decimal(5,2) NOT NULL DEFAULT 0.00 COMMENT 'Open rate for email steps',
  `clickRate` decimal(5,2) NOT NULL DEFAULT 0.00 COMMENT 'Click rate for email steps',
  `conversionRate` decimal(5,2) NOT NULL DEFAULT 0.00 COMMENT 'Conversion rate for goal steps',
  `analytics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Step analytics and performance data' CHECK (json_valid(`analytics`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `email_automation_workflows`
--

CREATE TABLE `email_automation_workflows` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `name` varchar(255) NOT NULL COMMENT 'Workflow name',
  `description` text DEFAULT NULL COMMENT 'Workflow description',
  `status` enum('draft','active','paused','archived') NOT NULL DEFAULT 'draft' COMMENT 'Current workflow status',
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Whether workflow is active',
  `triggerType` enum('user_registration','course_enrollment','course_completion','lesson_completion','assessment_submission','inactivity','birthday','course_deadline','custom_event','time_based','behavior_trigger') NOT NULL COMMENT 'What triggers this workflow',
  `triggerConfig` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Trigger configuration and conditions' CHECK (json_valid(`triggerConfig`)),
  `targetAudience` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Audience targeting criteria' CHECK (json_valid(`targetAudience`)),
  `settings` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Workflow settings and configuration' CHECK (json_valid(`settings`)),
  `activeFrom` timestamp NULL DEFAULT NULL COMMENT 'When workflow becomes active',
  `activeUntil` timestamp NULL DEFAULT NULL COMMENT 'When workflow becomes inactive',
  `totalExecutions` int(11) NOT NULL DEFAULT 0 COMMENT 'Total number of times workflow was triggered',
  `successfulExecutions` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of successful executions',
  `failedExecutions` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of failed executions',
  `averageOpenRate` decimal(5,2) NOT NULL DEFAULT 0.00 COMMENT 'Average open rate across all emails in workflow',
  `averageClickRate` decimal(5,2) NOT NULL DEFAULT 0.00 COMMENT 'Average click rate across all emails in workflow',
  `analytics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Workflow performance analytics' CHECK (json_valid(`analytics`)),
  `errorLogs` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Workflow error logs' CHECK (json_valid(`errorLogs`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `email_campaigns`
--

CREATE TABLE `email_campaigns` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `name` varchar(255) NOT NULL COMMENT 'Campaign name',
  `description` text DEFAULT NULL COMMENT 'Campaign description',
  `type` enum('newsletter','promotional','course_announcement','reminder','system_update','marketing','educational') NOT NULL COMMENT 'Type of email campaign',
  `status` enum('draft','scheduled','sending','sent','paused','cancelled','failed') NOT NULL DEFAULT 'draft' COMMENT 'Current status of campaign',
  `subject` varchar(255) NOT NULL COMMENT 'Email subject line',
  `htmlContent` longtext NOT NULL COMMENT 'Email HTML content',
  `textContent` longtext DEFAULT NULL COMMENT 'Email plain text content',
  `fromEmail` varchar(255) DEFAULT NULL COMMENT 'From email address',
  `fromName` varchar(255) DEFAULT NULL COMMENT 'From name',
  `replyToEmail` varchar(255) DEFAULT NULL COMMENT 'Reply-to email address',
  `targetAudience` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Target audience criteria' CHECK (json_valid(`targetAudience`)),
  `settings` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Campaign settings and configuration' CHECK (json_valid(`settings`)),
  `scheduledAt` timestamp NULL DEFAULT NULL COMMENT 'When campaign is scheduled to be sent',
  `sentAt` timestamp NULL DEFAULT NULL COMMENT 'When campaign sending started',
  `completedAt` timestamp NULL DEFAULT NULL COMMENT 'When campaign sending completed',
  `totalRecipients` int(11) NOT NULL DEFAULT 0 COMMENT 'Total number of recipients',
  `sentCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of emails sent successfully',
  `failedCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of failed email sends',
  `bouncedCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of bounced emails',
  `openedCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of emails opened',
  `clickedCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of links clicked',
  `unsubscribedCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of unsubscribes',
  `complaintsCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of spam complaints',
  `openRate` decimal(5,2) NOT NULL DEFAULT 0.00 COMMENT 'Open rate percentage',
  `clickRate` decimal(5,2) NOT NULL DEFAULT 0.00 COMMENT 'Click-through rate percentage',
  `statistics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Detailed campaign statistics' CHECK (json_valid(`statistics`)),
  `errorLogs` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Campaign error logs and debugging info' CHECK (json_valid(`errorLogs`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `email_campaign_analytics`
--

CREATE TABLE `email_campaign_analytics` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `campaignId` varchar(36) NOT NULL COMMENT 'Campaign ID',
  `recipientEmail` varchar(255) NOT NULL COMMENT 'Recipient email address',
  `eventType` enum('sent','delivered','opened','clicked','bounced','unsubscribed','complained','failed') NOT NULL COMMENT 'Type of analytics event',
  `timestamp` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'When the event occurred',
  `url` varchar(1000) DEFAULT NULL COMMENT 'URL clicked (for click events)',
  `userAgent` varchar(500) DEFAULT NULL COMMENT 'User agent string',
  `ip` varchar(45) DEFAULT NULL COMMENT 'IP address of the event',
  `country` varchar(100) DEFAULT NULL COMMENT 'Country from IP geolocation',
  `region` varchar(100) DEFAULT NULL COMMENT 'Region from IP geolocation',
  `city` varchar(100) DEFAULT NULL COMMENT 'City from IP geolocation',
  `browser` varchar(100) DEFAULT NULL COMMENT 'Browser name',
  `os` varchar(100) DEFAULT NULL COMMENT 'Operating system',
  `device` varchar(100) DEFAULT NULL COMMENT 'Device type (mobile, desktop, tablet)',
  `isMobile` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether the event was from a mobile device',
  `emailClient` varchar(255) DEFAULT NULL COMMENT 'Email client used to open email',
  `referrer` varchar(255) DEFAULT NULL COMMENT 'Referrer URL (for click events)',
  `eventData` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional event-specific data' CHECK (json_valid(`eventData`)),
  `messageId` varchar(255) DEFAULT NULL COMMENT 'External message ID from email provider',
  `provider` varchar(100) DEFAULT NULL COMMENT 'Email provider that reported this event',
  `rawData` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Raw webhook data from email provider' CHECK (json_valid(`rawData`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `email_campaign_recipients`
--

CREATE TABLE `email_campaign_recipients` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `campaignId` varchar(36) NOT NULL COMMENT 'Campaign ID',
  `userId` varchar(36) DEFAULT NULL COMMENT 'User ID if recipient is registered user',
  `email` varchar(255) NOT NULL COMMENT 'Recipient email address',
  `firstName` varchar(255) DEFAULT NULL COMMENT 'Recipient first name',
  `lastName` varchar(255) DEFAULT NULL COMMENT 'Recipient last name',
  `status` enum('pending','sent','delivered','opened','clicked','bounced','failed','unsubscribed','complained') NOT NULL DEFAULT 'pending' COMMENT 'Current delivery status',
  `messageId` varchar(255) DEFAULT NULL COMMENT 'External message ID from email provider',
  `variant` varchar(255) DEFAULT NULL COMMENT 'A/B test variant name',
  `variables` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Personalization variables for this recipient' CHECK (json_valid(`variables`)),
  `sentAt` timestamp NULL DEFAULT NULL COMMENT 'When email was sent',
  `deliveredAt` timestamp NULL DEFAULT NULL COMMENT 'When email was delivered',
  `openedAt` timestamp NULL DEFAULT NULL COMMENT 'When email was first opened',
  `lastOpenedAt` timestamp NULL DEFAULT NULL COMMENT 'When email was last opened',
  `clickedAt` timestamp NULL DEFAULT NULL COMMENT 'When first link was clicked',
  `lastClickedAt` timestamp NULL DEFAULT NULL COMMENT 'When last link was clicked',
  `bouncedAt` timestamp NULL DEFAULT NULL COMMENT 'When email bounced',
  `unsubscribedAt` timestamp NULL DEFAULT NULL COMMENT 'When recipient unsubscribed',
  `complainedAt` timestamp NULL DEFAULT NULL COMMENT 'When spam complaint was filed',
  `openCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of times email was opened',
  `clickCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of link clicks',
  `bounceType` varchar(100) DEFAULT NULL COMMENT 'Bounce type (hard/soft)',
  `bounceReason` text DEFAULT NULL COMMENT 'Bounce reason or error message',
  `deviceInfo` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Device and browser info from opens/clicks' CHECK (json_valid(`deviceInfo`)),
  `geoInfo` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Geographic information from opens/clicks' CHECK (json_valid(`geoInfo`)),
  `clickData` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Click tracking data' CHECK (json_valid(`clickData`)),
  `openData` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Email open tracking data' CHECK (json_valid(`openData`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `email_suppression_list`
--

CREATE TABLE `email_suppression_list` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `email` varchar(255) NOT NULL COMMENT 'Suppressed email address',
  `reason` enum('unsubscribed','bounced_hard','bounced_soft','spam_complaint','manual_suppression','gdpr_request','invalid_email','role_account','globally_suppressed') NOT NULL COMMENT 'Reason for suppression',
  `scope` enum('global','marketing','transactional','specific_campaign','workflow') NOT NULL DEFAULT 'global' COMMENT 'Scope of suppression',
  `scopeId` varchar(255) DEFAULT NULL COMMENT 'Specific campaign/workflow ID for scoped suppression',
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Whether suppression is currently active',
  `suppressedAt` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'When email was suppressed',
  `expiresAt` timestamp NULL DEFAULT NULL COMMENT 'When suppression expires (null for permanent)',
  `userId` varchar(36) DEFAULT NULL COMMENT 'User ID if suppressed user is registered',
  `details` text DEFAULT NULL COMMENT 'Additional details about suppression',
  `source` varchar(255) DEFAULT NULL COMMENT 'Source campaign or system that initiated suppression',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional metadata about suppression' CHECK (json_valid(`metadata`)),
  `lastUpdatedAt` timestamp NULL DEFAULT NULL COMMENT 'When suppression was last updated'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `enrollments`
--

CREATE TABLE `enrollments` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `studentId` varchar(36) NOT NULL COMMENT 'Student user ID',
  `courseId` varchar(36) NOT NULL COMMENT 'Course ID',
  `enrollmentDate` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'Enrollment date',
  `completionDate` timestamp NULL DEFAULT NULL COMMENT 'Course completion date',
  `status` enum('enrolled','in_progress','completed','dropped','paused','suspended','expired','active') NOT NULL DEFAULT 'enrolled' COMMENT 'Enrollment status',
  `progressPercentage` decimal(5,2) NOT NULL DEFAULT 0.00 COMMENT 'Course progress percentage',
  `lastAccessedAt` timestamp NULL DEFAULT NULL COMMENT 'Last time student accessed the course',
  `paymentStatus` enum('pending','paid','failed','refunded','cancelled') NOT NULL DEFAULT 'pending' COMMENT 'Payment status for paid courses',
  `paymentAmount` decimal(10,2) NOT NULL DEFAULT 0.00 COMMENT 'Amount paid for the course',
  `paymentCurrency` varchar(3) NOT NULL DEFAULT 'USD' COMMENT 'Payment currency',
  `paymentTransactionId` varchar(255) DEFAULT NULL COMMENT 'Payment transaction ID',
  `paymentDate` timestamp NULL DEFAULT NULL COMMENT 'Payment date',
  `certificateUrl` varchar(500) DEFAULT NULL COMMENT 'Certificate URL when course is completed',
  `certificateIssuedAt` timestamp NULL DEFAULT NULL COMMENT 'Certificate issue date',
  `rating` decimal(3,2) DEFAULT NULL COMMENT 'Student rating for the course',
  `review` text DEFAULT NULL COMMENT 'Student review for the course',
  `reviewDate` timestamp NULL DEFAULT NULL COMMENT 'Review submission date',
  `totalTimeSpent` int(11) NOT NULL DEFAULT 0 COMMENT 'Total time spent in seconds',
  `lessonsCompleted` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of lessons completed',
  `totalLessons` int(11) NOT NULL DEFAULT 0 COMMENT 'Total lessons in course at enrollment time',
  `accessExpiresAt` timestamp NULL DEFAULT NULL COMMENT 'Access expiry date for limited access courses',
  `source` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Enrollment source and tracking data' CHECK (json_valid(`source`)),
  `preferences` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Student preferences for this course' CHECK (json_valid(`preferences`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional enrollment metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `feedbacks`
--

CREATE TABLE `feedbacks` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `gradeId` varchar(36) NOT NULL COMMENT 'ID bn chm im lin quan',
  `questionId` varchar(36) DEFAULT NULL COMMENT 'ID cu hi c th (nu feedback gn vi 1 cu)',
  `authorId` varchar(36) NOT NULL COMMENT 'ID ngi to feedback (AI hoc ngi dng)',
  `category` enum('content','structure','grammar','logic','creativity','technical') NOT NULL COMMENT 'Loi gp : ni dung, cu trc, logic, ng php...',
  `severity` enum('info','suggestion','warning','error') NOT NULL DEFAULT 'info' COMMENT 'Mc  nghim trng: info, cnh bo, li...',
  `content` text NOT NULL COMMENT 'Ni dung gp  chnh',
  `suggestion` text DEFAULT NULL COMMENT 'Gi  ci thin (nu c)',
  `isAiGenerated` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'nh du nu c to bi AI',
  `aiConfidence` decimal(3,2) DEFAULT NULL COMMENT 'Mc  t tin ca AI (0.0 - 1.0)',
  `startPosition` int(11) DEFAULT NULL COMMENT 'V tr bt u ca on vn c gp  (theo index)',
  `endPosition` int(11) DEFAULT NULL COMMENT 'V tr kt thc ca on vn c gp  (theo index)',
  `highlightedText` text DEFAULT NULL COMMENT 'on vn bn c th b gp  (highlight)',
  `helpfulnessRating` int(11) DEFAULT NULL COMMENT 'nh gi  hu ch (15) t ngi hc hoc ging vin',
  `isMarkedHelpful` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Ngi dng c nh du feedback ny l hu ch khng',
  `metadata` longtext DEFAULT NULL COMMENT 'Thng tin b sung linh hot (metadata)'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `file_uploads`
--

CREATE TABLE `file_uploads` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `lessonId` varchar(36) DEFAULT NULL COMMENT 'Lesson this file belongs to',
  `courseId` varchar(36) DEFAULT NULL COMMENT 'Course this file belongs to',
  `originalName` varchar(255) NOT NULL COMMENT 'Original filename',
  `storedName` varchar(255) NOT NULL COMMENT 'Stored filename on disk',
  `filePath` varchar(500) NOT NULL COMMENT 'Relative file path from upload root',
  `fileSize` bigint(20) NOT NULL COMMENT 'File size in bytes',
  `mimeType` varchar(100) NOT NULL COMMENT 'MIME type of the file',
  `fileType` enum('image','video','audio','document','archive','other') NOT NULL COMMENT 'Category of file type',
  `accessLevel` enum('public','enrolled_only','premium_only','private') NOT NULL DEFAULT 'enrolled_only' COMMENT 'File access permission level',
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Whether file is active and accessible',
  `isPublic` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether file is publicly accessible',
  `duration` int(11) DEFAULT NULL COMMENT 'Duration in seconds for video/audio files',
  `resolution` varchar(20) DEFAULT NULL COMMENT 'Resolution for video/image files (e.g., 1920x1080)',
  `bitrate` int(11) DEFAULT NULL COMMENT 'Bitrate for video/audio files',
  `optimizedPath` varchar(500) DEFAULT NULL COMMENT 'URL to optimized version of the file',
  `thumbnailPath` varchar(500) DEFAULT NULL COMMENT 'URL to thumbnail image',
  `processingStatus` enum('pending','processing','completed','failed') NOT NULL DEFAULT 'pending' COMMENT 'File processing status',
  `processingError` text DEFAULT NULL COMMENT 'Processing error message if failed',
  `processedVersions` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Array of processed file versions' CHECK (json_valid(`processedVersions`)),
  `processingStartedAt` timestamp NULL DEFAULT NULL COMMENT 'Processing start timestamp',
  `processingCompletedAt` timestamp NULL DEFAULT NULL COMMENT 'Processing completion timestamp',
  `checksum` varchar(64) DEFAULT NULL COMMENT 'File checksum for integrity verification',
  `downloadCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of times file has been downloaded',
  `viewCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of times file has been viewed/streamed',
  `lastDownloadedAt` timestamp NULL DEFAULT NULL COMMENT 'Last download timestamp',
  `downloadUrl` varchar(500) DEFAULT NULL COMMENT 'URL to download the file',
  `lastViewedAt` timestamp NULL DEFAULT NULL COMMENT 'Last view timestamp',
  `isFlagged` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether file has been flagged for review',
  `moderatedBy` varchar(36) DEFAULT NULL COMMENT 'Moderator who reviewed this file',
  `moderatedAt` timestamp NULL DEFAULT NULL COMMENT 'Moderation timestamp',
  `moderationNotes` text DEFAULT NULL COMMENT 'Moderation notes or reason',
  `settings` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'File-specific settings and configuration' CHECK (json_valid(`settings`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional file metadata and properties' CHECK (json_valid(`metadata`)),
  `uploaderId` varchar(36) NOT NULL COMMENT 'User ID who uploaded the file',
  `fileUrl` varchar(500) NOT NULL COMMENT 'Full URL to access the file',
  `relatedType` enum('course_thumbnail','course_trailer','lesson_video','lesson_attachment','user_avatar','user_cover','assignment_submission','certificate') NOT NULL COMMENT 'What this file is related to',
  `isTemporary` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is file temporarily uploaded',
  `extension` varchar(100) DEFAULT NULL COMMENT 'File extension',
  `expiresAt` timestamp NULL DEFAULT NULL COMMENT 'File expiration date for temporary files',
  `uploadedAt` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'Upload timestamp'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `forum_categories`
--

CREATE TABLE `forum_categories` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `name` varchar(255) NOT NULL COMMENT 'Category name',
  `slug` varchar(255) NOT NULL COMMENT 'URL-friendly category identifier',
  `description` text DEFAULT NULL COMMENT 'Category description',
  `parentId` varchar(36) DEFAULT NULL COMMENT 'Parent category ID for hierarchical structure',
  `iconUrl` varchar(500) DEFAULT NULL COMMENT 'Category icon URL',
  `bannerUrl` varchar(500) DEFAULT NULL COMMENT 'Category banner image URL',
  `color` varchar(20) NOT NULL DEFAULT '#3B82F6' COMMENT 'Category color theme',
  `orderIndex` int(11) NOT NULL DEFAULT 0 COMMENT 'Display order index',
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Is category active',
  `isFeatured` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is category featured',
  `isPrivate` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is category private (invite only)',
  `requiresApproval` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Requires approval to post',
  `threadCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of threads in category',
  `postCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of posts in category',
  `lastActivityAt` timestamp NULL DEFAULT NULL COMMENT 'Last activity timestamp',
  `lastPostId` varchar(36) DEFAULT NULL COMMENT 'ID of last post in category',
  `lastPostUserId` varchar(36) DEFAULT NULL COMMENT 'ID of user who made last post',
  `settings` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Category settings and configuration' CHECK (json_valid(`settings`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Category metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `forum_category_permissions`
--

CREATE TABLE `forum_category_permissions` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `categoryId` varchar(36) NOT NULL COMMENT 'Category ID',
  `roleId` varchar(36) NOT NULL COMMENT 'Role ID',
  `permission` enum('view_forum','create_thread','reply_thread','edit_own_post','delete_own_post','moderate_posts','moderate_users','sticky_posts','lock_threads','move_threads','delete_any_post','edit_any_post','ban_users','view_reports','manage_categories') NOT NULL COMMENT 'Permission type',
  `isGranted` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Is permission granted',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Permission metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `forum_posts`
--

CREATE TABLE `forum_posts` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `threadId` varchar(36) NOT NULL COMMENT 'Thread ID this post belongs to',
  `authorId` varchar(36) NOT NULL COMMENT 'Post author ID',
  `parentId` varchar(36) DEFAULT NULL COMMENT 'Parent post ID for replies',
  `content` text NOT NULL COMMENT 'Post content',
  `contentHtml` text DEFAULT NULL COMMENT 'Post content in HTML format',
  `type` enum('thread','reply','question','answer','comment') NOT NULL DEFAULT 'reply' COMMENT 'Type of post',
  `status` enum('draft','published','pending_approval','approved','rejected','hidden','locked','archived') NOT NULL DEFAULT 'published' COMMENT 'Post status',
  `isAccepted` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is post accepted as answer',
  `isEdited` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is post edited',
  `editedAt` timestamp NULL DEFAULT NULL COMMENT 'Last edit timestamp',
  `editedBy` varchar(36) DEFAULT NULL COMMENT 'ID of user who edited post',
  `editReason` text DEFAULT NULL COMMENT 'Edit reason',
  `upvoteCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of upvotes',
  `downvoteCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of downvotes',
  `score` int(11) NOT NULL DEFAULT 0 COMMENT 'Post score (upvotes - downvotes)',
  `helpfulCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of helpful votes',
  `replyCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of replies to this post',
  `isReported` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is post reported',
  `reportCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of reports',
  `mentions` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Post mentions' CHECK (json_valid(`mentions`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Post metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `forum_post_attachments`
--

CREATE TABLE `forum_post_attachments` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `postId` varchar(36) NOT NULL COMMENT 'Post ID',
  `filename` varchar(255) NOT NULL COMMENT 'Original filename',
  `fileUrl` varchar(500) NOT NULL COMMENT 'File URL',
  `mimeType` varchar(100) NOT NULL COMMENT 'File MIME type',
  `fileType` varchar(20) NOT NULL COMMENT 'File type category',
  `fileSize` bigint(20) NOT NULL COMMENT 'File size in bytes',
  `thumbnailUrl` varchar(500) DEFAULT NULL COMMENT 'Thumbnail URL for images',
  `downloadCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of downloads',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'File metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `forum_post_reports`
--

CREATE TABLE `forum_post_reports` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `postId` varchar(36) NOT NULL COMMENT 'Post ID being reported',
  `reporterId` varchar(36) NOT NULL COMMENT 'User ID who reported',
  `reason` enum('spam','inappropriate_content','harassment','copyright_violation','misinformation','off_topic','duplicate','technical_issue','other') NOT NULL COMMENT 'Reason for report',
  `details` text DEFAULT NULL COMMENT 'Additional details about report',
  `status` enum('pending','reviewed','resolved','dismissed') NOT NULL DEFAULT 'pending' COMMENT 'Report status',
  `handledBy` varchar(36) DEFAULT NULL COMMENT 'Moderator who handled report',
  `handledAt` timestamp NULL DEFAULT NULL COMMENT 'Report handled timestamp',
  `moderatorNotes` text DEFAULT NULL COMMENT 'Moderator notes',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Report metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `forum_post_votes`
--

CREATE TABLE `forum_post_votes` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `postId` varchar(36) NOT NULL COMMENT 'Post ID',
  `userId` varchar(36) NOT NULL COMMENT 'User ID who voted',
  `voteType` enum('upvote','downvote','helpful','not_helpful','agree','disagree') NOT NULL COMMENT 'Type of vote',
  `value` int(11) NOT NULL DEFAULT 0 COMMENT 'Vote value (1 for upvote, -1 for downvote)',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Vote metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `forum_reputation_history`
--

CREATE TABLE `forum_reputation_history` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `userId` varchar(36) NOT NULL COMMENT 'User ID',
  `points` int(11) NOT NULL COMMENT 'Points gained or lost',
  `reason` varchar(255) NOT NULL COMMENT 'Reason for reputation change',
  `relatedPostId` varchar(36) DEFAULT NULL COMMENT 'Related post ID',
  `relatedUserId` varchar(36) DEFAULT NULL COMMENT 'Related user ID (who gave vote/award)',
  `multiplier` decimal(3,2) NOT NULL DEFAULT 1.00 COMMENT 'Multiplier applied to points',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `forum_tags`
--

CREATE TABLE `forum_tags` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `name` varchar(100) NOT NULL COMMENT 'Tag name',
  `slug` varchar(100) NOT NULL COMMENT 'URL-friendly tag identifier',
  `description` text DEFAULT NULL COMMENT 'Tag description',
  `color` varchar(20) NOT NULL DEFAULT '#6B7280' COMMENT 'Tag color',
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Is tag active',
  `isFeatured` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is tag featured',
  `usageCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of threads using this tag',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Tag metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `forum_threads`
--

CREATE TABLE `forum_threads` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `title` varchar(255) NOT NULL COMMENT 'Thread title',
  `slug` varchar(255) NOT NULL COMMENT 'URL-friendly thread identifier',
  `summary` text DEFAULT NULL COMMENT 'Thread summary or excerpt',
  `authorId` varchar(36) NOT NULL COMMENT 'Thread author ID',
  `categoryId` varchar(36) NOT NULL COMMENT 'Category ID this thread belongs to',
  `type` enum('thread','reply','question','answer','comment') NOT NULL DEFAULT 'thread' COMMENT 'Type of thread (thread, question)',
  `status` enum('open','closed','locked','resolved','pinned','featured','archived') NOT NULL DEFAULT 'open' COMMENT 'Thread status',
  `isPinned` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is thread pinned',
  `isFeatured` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is thread featured',
  `isLocked` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is thread locked',
  `isResolved` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is thread resolved (for questions)',
  `acceptedAnswerId` varchar(36) DEFAULT NULL COMMENT 'ID of accepted answer post',
  `viewCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of views',
  `replyCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of replies',
  `upvoteCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of upvotes',
  `downvoteCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of downvotes',
  `score` int(11) NOT NULL DEFAULT 0 COMMENT 'Thread score (upvotes - downvotes)',
  `lastActivityAt` timestamp NULL DEFAULT NULL COMMENT 'Last activity timestamp',
  `lastPostId` varchar(36) DEFAULT NULL COMMENT 'ID of last post in thread',
  `lastPostUserId` varchar(36) DEFAULT NULL COMMENT 'ID of user who made last post',
  `lockedAt` timestamp NULL DEFAULT NULL COMMENT 'Thread locked timestamp',
  `lockedBy` varchar(36) DEFAULT NULL COMMENT 'ID of user who locked thread',
  `lockReason` text DEFAULT NULL COMMENT 'Reason for locking thread',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Thread metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `forum_thread_tags`
--

CREATE TABLE `forum_thread_tags` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `threadId` varchar(36) NOT NULL COMMENT 'Thread ID',
  `tagId` varchar(36) NOT NULL COMMENT 'Tag ID',
  `addedBy` varchar(36) NOT NULL COMMENT 'ID of user who added this tag',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Tag metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `forum_user_badges`
--

CREATE TABLE `forum_user_badges` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `userId` varchar(36) NOT NULL COMMENT 'User ID',
  `badgeId` varchar(100) NOT NULL COMMENT 'Badge identifier',
  `name` varchar(255) NOT NULL COMMENT 'Badge name',
  `description` text DEFAULT NULL COMMENT 'Badge description',
  `badgeType` enum('participation','quality','helping','expertise','moderation','special') NOT NULL COMMENT 'Badge type',
  `iconUrl` varchar(500) DEFAULT NULL COMMENT 'Badge icon URL',
  `color` varchar(20) NOT NULL DEFAULT '#FFD700' COMMENT 'Badge color',
  `points` int(11) NOT NULL DEFAULT 0 COMMENT 'Points awarded for badge',
  `earnedAt` timestamp NULL DEFAULT NULL COMMENT 'Badge earned timestamp',
  `relatedId` varchar(36) DEFAULT NULL COMMENT 'Related post/thread ID',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Badge metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `forum_user_reputations`
--

CREATE TABLE `forum_user_reputations` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `userId` varchar(36) NOT NULL COMMENT 'User ID',
  `score` int(11) NOT NULL DEFAULT 0 COMMENT 'Total reputation score',
  `rank` int(11) NOT NULL DEFAULT 0 COMMENT 'User rank based on reputation',
  `totalPosts` int(11) NOT NULL DEFAULT 0 COMMENT 'Total posts made',
  `totalThreads` int(11) NOT NULL DEFAULT 0 COMMENT 'Total threads created',
  `totalUpvotes` int(11) NOT NULL DEFAULT 0 COMMENT 'Total upvotes received',
  `totalDownvotes` int(11) NOT NULL DEFAULT 0 COMMENT 'Total downvotes received',
  `totalAcceptedAnswers` int(11) NOT NULL DEFAULT 0 COMMENT 'Total accepted answers',
  `totalHelpfulVotes` int(11) NOT NULL DEFAULT 0 COMMENT 'Total helpful votes received',
  `bestAnswerStreak` int(11) NOT NULL DEFAULT 0 COMMENT 'Best answer streak',
  `currentAnswerStreak` int(11) NOT NULL DEFAULT 0 COMMENT 'Current answer streak',
  `lastActivityDate` date DEFAULT NULL COMMENT 'Last activity date',
  `todayPoints` int(11) NOT NULL DEFAULT 0 COMMENT 'Points earned today',
  `weekPoints` int(11) NOT NULL DEFAULT 0 COMMENT 'Points earned this week',
  `monthPoints` int(11) NOT NULL DEFAULT 0 COMMENT 'Points earned this month',
  `history` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Reputation history summary' CHECK (json_valid(`history`)),
  `badges` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'User badges earned' CHECK (json_valid(`badges`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Reputation metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `generated_quizzes`
--

CREATE TABLE `generated_quizzes` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `generated_by` varchar(36) DEFAULT NULL,
  `reviewed_by` varchar(36) DEFAULT NULL,
  `lesson_id` varchar(36) NOT NULL,
  `title` varchar(255) NOT NULL,
  `description` text DEFAULT NULL,
  `status` enum('pending','generating','completed','failed','reviewed','approved','rejected') NOT NULL DEFAULT 'pending',
  `question_count` int(11) NOT NULL DEFAULT 5,
  `difficulty_level` enum('easy','medium','hard') NOT NULL DEFAULT 'medium',
  `time_limit` int(11) DEFAULT NULL,
  `ai_model_version` varchar(50) DEFAULT NULL,
  `generation_prompt` text DEFAULT NULL,
  `quality_score` decimal(5,2) DEFAULT NULL,
  `questions` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL CHECK (json_valid(`questions`)),
  `review` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`review`)),
  `generationAnalysis` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`generationAnalysis`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `gradebooks`
--

CREATE TABLE `gradebooks` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `courseId` varchar(36) NOT NULL COMMENT 'ID ca kha hc lin kt vi s im',
  `teacherId` varchar(36) NOT NULL COMMENT 'ID gio vin ph trch s im',
  `name` varchar(255) NOT NULL COMMENT 'Tn ca s im (v d: "S im Ton 12A")',
  `description` text DEFAULT NULL COMMENT 'M t chi tit hoc ghi ch v s im',
  `status` enum('active','finalized','archived') NOT NULL DEFAULT 'active' COMMENT 'Trng thi ca s im: ang hot ng,  kha,  lu tr',
  `gradingScale` longtext DEFAULT NULL COMMENT 'Thang im dng  quy i im (dng JSON)',
  `weightingScheme` longtext DEFAULT NULL COMMENT 'Cch tnh trng s gia cc bi kim tra (dng JSON)',
  `passingThreshold` float(3,2) NOT NULL DEFAULT 9.99 COMMENT 'Ngng im ti thiu  c xem l t',
  `allowLateSubmissions` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'C cho php np bi tr hay khng',
  `latePenaltyPercentage` float(3,2) NOT NULL DEFAULT 9.99 COMMENT 'Phn trm b tr khi np bi tr',
  `totalStudents` int(11) NOT NULL DEFAULT 0 COMMENT 'Tng s hc vin trong s im',
  `totalAssessments` int(11) NOT NULL DEFAULT 0 COMMENT 'Tng s bi nh gi c ghi nhn trong s im',
  `classAverage` float(5,2) NOT NULL DEFAULT 0.00 COMMENT 'im trung bnh ca ton lp trong s im',
  `lastCalculatedAt` timestamp NULL DEFAULT NULL COMMENT 'Thi im h thng tnh li im trung bnh gn nht',
  `displaySettings` longtext DEFAULT NULL COMMENT 'Cu hnh hin th s im (n/hin cc ct...)',
  `exportSettings` longtext DEFAULT NULL COMMENT 'Cu hnh xut file (PDF, CSV, lc hc vin, v.v.)',
  `metadata` longtext DEFAULT NULL COMMENT 'Thng tin b sung ty chnh (metadata, JSON)'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `grades`
--

CREATE TABLE `grades` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `studentId` varchar(36) NOT NULL COMMENT 'ID hc vin c chm',
  `assessmentId` varchar(36) NOT NULL COMMENT 'ID bi nh gi (v d: bi kim tra)',
  `attemptId` varchar(36) NOT NULL COMMENT 'ID ln lm bi ( phn bit cc ln th)',
  `graderId` varchar(36) DEFAULT NULL COMMENT 'ID ngi chm bi (c th l ging vin hoc h thng AI)',
  `score` decimal(5,2) NOT NULL DEFAULT 0.00 COMMENT 'im s thc t hc vin t c',
  `maxScore` decimal(5,2) NOT NULL COMMENT 'im ti a c th t c trong bi',
  `percentage` decimal(5,2) NOT NULL DEFAULT 0.00 COMMENT 'T l phn trm = score / maxScore * 100',
  `status` enum('pending','graded','under_review','finalized') NOT NULL DEFAULT 'pending' COMMENT 'Trng thi chm im: pending, graded, under_review, finalized',
  `feedbackType` enum('overall','question_specific','ai_generated','manual') NOT NULL DEFAULT 'manual' COMMENT 'Loi phn hi: th cng, AI, tng qut hay theo cu hi',
  `questionScores` longtext DEFAULT NULL COMMENT 'Danh sch im tng cu hi di dng JSON',
  `overallFeedback` text DEFAULT NULL COMMENT 'Phn hi tng qut cho bi lm',
  `comments` text DEFAULT NULL COMMENT 'Ghi ch thm ca ngi chm bi',
  `gradedAt` timestamp NULL DEFAULT NULL COMMENT 'Thi im bi c chm xong',
  `publishedAt` timestamp NULL DEFAULT NULL COMMENT 'Thi im im s c cng b cho hc vin',
  `isPublished` tinyint(4) NOT NULL DEFAULT 0 COMMENT ' cng b cho hc vin xem cha',
  `isAiGraded` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Bi ny c c chm bng AI khng',
  `aiConfidence` decimal(3,2) DEFAULT NULL COMMENT ' t tin ca AI khi chm im (0.0 - 1.0)',
  `reviewedBy` varchar(36) DEFAULT NULL COMMENT 'ID ngi  review li bi (gim st, kim tra li)',
  `reviewedAt` timestamp NULL DEFAULT NULL COMMENT 'Thi im bi c review li',
  `reviewComments` text DEFAULT NULL COMMENT 'Ghi ch/nhn xt ca ngi review',
  `gradingRubric` longtext DEFAULT NULL COMMENT 'Bng tiu ch chm im (rubric) s dng  chm bi ny',
  `analytics` longtext DEFAULT NULL COMMENT 'D liu phn tch v bi lm (v d: thi gian lm bi, hnh vi)',
  `metadata` longtext DEFAULT NULL COMMENT 'D liu b sung, linh hot (metadata)'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `grading_rubrics`
--

CREATE TABLE `grading_rubrics` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `assessmentId` varchar(36) DEFAULT NULL COMMENT 'ID bi nh gi lin kt (nu c)',
  `title` varchar(255) NOT NULL COMMENT 'Tiu  ca rubric (tn rubric)',
  `description` text DEFAULT NULL COMMENT 'M t chi tit v rubric (ty chn)',
  `type` enum('holistic','analytic','single_point') NOT NULL DEFAULT 'analytic' COMMENT 'Loi rubric: holistic (tng th), analytic (chi tit theo tiu ch), single_point (im chun n)',
  `isTemplate` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'nh du rubric ny l mu  ti s dng',
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Rubric c ang c kch hot hay khng',
  `criteria` longtext NOT NULL COMMENT 'Cu trc rubric dng JSON: danh sch tiu ch, m t, trng s, v cc mc im (levels)',
  `maxScore` decimal(5,2) NOT NULL COMMENT 'Tng im ti a ca rubric',
  `version` int(11) NOT NULL DEFAULT 1 COMMENT 'Phin bn ca rubric (h tr cp nht v versioning)',
  `usageCount` int(11) NOT NULL DEFAULT 0 COMMENT 'S ln rubric ny c s dng  chm im',
  `lastUsedAt` timestamp NULL DEFAULT NULL COMMENT 'Thi im rubric c s dng gn nht',
  `metadata` longtext DEFAULT NULL COMMENT 'Thng tin b sung dng JSON (metadata tu chnh)'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `group_projects`
--

CREATE TABLE `group_projects` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `name` varchar(255) NOT NULL COMMENT 'Project name',
  `description` text DEFAULT NULL COMMENT 'Project description',
  `status` enum('planning','in_progress','review','completed','cancelled','on_hold') NOT NULL DEFAULT 'planning' COMMENT 'Project status',
  `leaderId` varchar(36) NOT NULL COMMENT 'Project leader ID',
  `studyGroupId` varchar(36) DEFAULT NULL COMMENT 'Associated study group ID',
  `courseId` varchar(36) DEFAULT NULL COMMENT 'Associated course ID',
  `startDate` timestamp NULL DEFAULT NULL COMMENT 'Project start date',
  `dueDate` timestamp NULL DEFAULT NULL COMMENT 'Project due date',
  `completedAt` timestamp NULL DEFAULT NULL COMMENT 'Project completion date',
  `progressPercentage` int(11) NOT NULL DEFAULT 0 COMMENT 'Project progress percentage',
  `objectives` longtext DEFAULT NULL COMMENT 'Project objectives (JSON)',
  `deliverables` longtext DEFAULT NULL COMMENT 'Project deliverables (JSON)',
  `resources` longtext DEFAULT NULL COMMENT 'Project resources (JSON)',
  `milestones` longtext DEFAULT NULL COMMENT 'Project milestones (JSON)',
  `attachments` longtext DEFAULT NULL COMMENT 'Project attachments (JSON)',
  `settings` longtext DEFAULT NULL COMMENT 'Project settings (JSON)',
  `metadata` longtext DEFAULT NULL COMMENT 'Additional metadata (JSON)'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `hint_generations`
--

CREATE TABLE `hint_generations` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `interactionId` varchar(36) NOT NULL,
  `hintType` enum('strategic','conceptual','procedural','metacognitive','motivational','directional','elaborative') NOT NULL,
  `trigger` enum('user_request','struggle_detection','time_threshold','incorrect_attempts','confusion_indicators','proactive_support','learning_objective') NOT NULL,
  `hintLevel` int(11) NOT NULL DEFAULT 1,
  `hintContent` text NOT NULL,
  `wasUsed` tinyint(4) NOT NULL DEFAULT 0,
  `wasHelpful` tinyint(4) DEFAULT NULL,
  `timesToGenerate` int(11) NOT NULL DEFAULT 0,
  `relevanceScore` decimal(5,2) NOT NULL DEFAULT 0.00,
  `contextAnalysis` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`contextAnalysis`)),
  `adaptationData` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`adaptationData`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `intervention_recommendations`
--

CREATE TABLE `intervention_recommendations` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `studentId` varchar(36) NOT NULL COMMENT 'Student user ID',
  `courseId` varchar(36) DEFAULT NULL COMMENT 'Course ID',
  `predictionId` varchar(36) DEFAULT NULL COMMENT 'Related prediction ID',
  `interventionType` enum('motivation','content_review','study_plan','tutor_support','peer_support','technical_support','assessment_adjustment','learning_path_change') NOT NULL COMMENT 'Type of intervention',
  `title` varchar(255) NOT NULL COMMENT 'Intervention title',
  `description` text NOT NULL COMMENT 'Detailed intervention description',
  `priority` int(11) NOT NULL COMMENT 'Priority level (1-10, 10 being highest)',
  `status` enum('pending','scheduled','in_progress','completed','cancelled','deferred') NOT NULL DEFAULT 'pending' COMMENT 'Current intervention status',
  `recommendedDate` datetime DEFAULT NULL COMMENT 'Recommended intervention date',
  `scheduledDate` datetime DEFAULT NULL COMMENT 'Scheduled intervention date',
  `startedAt` datetime DEFAULT NULL COMMENT 'Actual intervention start date',
  `completedAt` datetime DEFAULT NULL COMMENT 'Intervention completion date',
  `estimatedDuration` int(11) DEFAULT NULL COMMENT 'Estimated duration in minutes',
  `parameters` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL COMMENT 'Intervention parameters and settings' CHECK (json_valid(`parameters`)),
  `successCriteria` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Success criteria for intervention' CHECK (json_valid(`successCriteria`)),
  `assignedToId` varchar(36) DEFAULT NULL COMMENT 'Assigned instructor/tutor ID',
  `outcome` enum('successful','partially_successful','unsuccessful','too_early','no_response') DEFAULT NULL COMMENT 'Intervention outcome',
  `effectivenessScore` decimal(5,2) DEFAULT NULL COMMENT 'Effectiveness score (0-100)',
  `studentFeedback` text DEFAULT NULL COMMENT 'Student feedback',
  `instructorNotes` text DEFAULT NULL COMMENT 'Instructor notes',
  `preInterventionMetrics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Metrics before intervention' CHECK (json_valid(`preInterventionMetrics`)),
  `postInterventionMetrics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Metrics after intervention' CHECK (json_valid(`postInterventionMetrics`)),
  `followUpDate` datetime DEFAULT NULL COMMENT 'Follow-up scheduled date',
  `followUpRequired` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether follow-up is required',
  `relatedInterventions` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Related interventions' CHECK (json_valid(`relatedInterventions`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional intervention metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `learning_activities`
--

CREATE TABLE `learning_activities` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `studentId` varchar(36) NOT NULL COMMENT 'Student user ID',
  `courseId` varchar(36) DEFAULT NULL COMMENT 'Course ID if activity is course-related',
  `lessonId` varchar(36) DEFAULT NULL COMMENT 'Lesson ID if activity is lesson-related',
  `assessmentId` varchar(36) DEFAULT NULL COMMENT 'Assessment ID if activity is assessment-related',
  `activityType` enum('login','logout','course_view','lesson_start','lesson_complete','lesson_progress','video_play','video_pause','video_seek','video_complete','quiz_start','quiz_submit','quiz_complete','assignment_start','assignment_submit','discussion_post','chat_message','file_download','search','bookmark_add','note_create','help_request','course_complete','certificate_earn','assessment_start','forum_post','content_read','quiz_attempt') NOT NULL COMMENT 'Type of learning activity',
  `sessionId` varchar(255) NOT NULL COMMENT 'Unique session identifier',
  `timestamp` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'Activity timestamp',
  `duration` int(11) DEFAULT NULL COMMENT 'Duration of activity in seconds',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Activity-specific metadata' CHECK (json_valid(`metadata`)),
  `ipAddress` varchar(45) DEFAULT NULL COMMENT 'IP address of the user',
  `userAgent` text DEFAULT NULL COMMENT 'User agent string',
  `deviceType` enum('desktop','tablet','mobile','unknown') DEFAULT NULL COMMENT 'Type of device used',
  `browser` varchar(100) DEFAULT NULL COMMENT 'Browser name',
  `operatingSystem` varchar(100) DEFAULT NULL COMMENT 'Operating system',
  `screenResolution` varchar(50) DEFAULT NULL COMMENT 'Screen resolution',
  `timezone` varchar(100) DEFAULT NULL COMMENT 'User timezone',
  `location` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Geolocation data if available' CHECK (json_valid(`location`)),
  `trackingData` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional tracking data' CHECK (json_valid(`trackingData`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `learning_analytics`
--

CREATE TABLE `learning_analytics` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `studentId` varchar(36) NOT NULL COMMENT 'Student user ID',
  `courseId` varchar(36) DEFAULT NULL COMMENT 'Course ID (null for overall analytics)',
  `date` date NOT NULL COMMENT 'Analytics date',
  `totalTimeSpent` int(11) NOT NULL DEFAULT 0 COMMENT 'Total time spent learning in seconds',
  `lessonsCompleted` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of lessons completed',
  `assessmentsTaken` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of assessments taken',
  `averageScore` decimal(5,2) NOT NULL COMMENT 'Average assessment score percentage',
  `skillProgress` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Skill progress' CHECK (json_valid(`skillProgress`)),
  `quizzesAttempted` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of quizzes attempted',
  `quizzesPassed` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of quizzes passed',
  `averageQuizScore` decimal(5,2) DEFAULT NULL COMMENT 'Average quiz score percentage',
  `loginCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of login sessions',
  `videoWatchTime` int(11) NOT NULL DEFAULT 0 COMMENT 'Time spent watching videos in seconds',
  `readingTime` int(11) NOT NULL DEFAULT 0 COMMENT 'Time spent reading content in seconds',
  `discussionPosts` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of forum posts/discussions',
  `chatMessages` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of chat messages sent',
  `mostActiveHour` int(11) DEFAULT NULL COMMENT 'Most active hour of the day (0-23)',
  `struggleIndicators` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Indicators of learning struggles' CHECK (json_valid(`struggleIndicators`)),
  `engagementScore` decimal(5,2) NOT NULL DEFAULT 0.00 COMMENT 'Overall engagement score (0-100)',
  `progressPercentage` decimal(5,2) NOT NULL DEFAULT 0.00 COMMENT 'Learning progress percentage',
  `performanceLevel` enum('excellent','good','average','below_average','poor') NOT NULL DEFAULT 'average' COMMENT 'Overall performance level',
  `learningPattern` enum('consistent','binge_learner','procrastinator','perfectionist','explorer','focused','social_learner','independent','cramming','procrastination','detail_oriented','struggling','social') DEFAULT NULL COMMENT 'Identified learning pattern',
  `engagementMetrics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Detailed engagement metrics' CHECK (json_valid(`engagementMetrics`)),
  `learningVelocity` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Learning velocity and efficiency metrics' CHECK (json_valid(`learningVelocity`)),
  `predictiveIndicators` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Predictive indicators' CHECK (json_valid(`predictiveIndicators`)),
  `skillsGained` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Skills and competencies gained' CHECK (json_valid(`skillsGained`)),
  `behavioralPatterns` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Behavioral patterns observed' CHECK (json_valid(`behavioralPatterns`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional analytics metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `learning_outcome_forecasts`
--

CREATE TABLE `learning_outcome_forecasts` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `studentId` varchar(36) NOT NULL COMMENT 'Student user ID',
  `courseId` varchar(36) DEFAULT NULL COMMENT 'Course ID',
  `outcomeType` enum('course_completion','skill_mastery','assessment_score','certification','time_to_completion','knowledge_retention') NOT NULL COMMENT 'Type of learning outcome',
  `forecastDate` datetime NOT NULL COMMENT 'Forecast generation date',
  `targetDate` datetime NOT NULL COMMENT 'Target completion date',
  `successProbability` decimal(5,2) NOT NULL COMMENT 'Predicted success probability (0-100)',
  `predictedScore` decimal(5,2) DEFAULT NULL COMMENT 'Predicted score or completion percentage',
  `estimatedDaysToCompletion` int(11) DEFAULT NULL COMMENT 'Estimated days to completion',
  `scenarios` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL COMMENT 'Scenario-based forecasts' CHECK (json_valid(`scenarios`)),
  `milestones` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Milestone predictions' CHECK (json_valid(`milestones`)),
  `resourceRequirements` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Resource requirements forecast' CHECK (json_valid(`resourceRequirements`)),
  `obstaclesAndSolutions` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Potential obstacles and solutions' CHECK (json_valid(`obstaclesAndSolutions`)),
  `confidenceLevel` decimal(5,2) NOT NULL COMMENT 'Forecast confidence level (0-100)',
  `baselineData` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Baseline data used for forecast' CHECK (json_valid(`baselineData`)),
  `isRealized` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether outcome has been realized',
  `actualOutcome` decimal(5,2) DEFAULT NULL COMMENT 'Actual outcome for validation',
  `actualCompletionDate` datetime DEFAULT NULL COMMENT 'Actual completion date',
  `accuracyMetrics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Forecast accuracy metrics' CHECK (json_valid(`accuracyMetrics`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional forecast metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `learning_sessions`
--

CREATE TABLE `learning_sessions` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `studentId` varchar(36) NOT NULL COMMENT 'Student user ID',
  `sessionId` varchar(255) NOT NULL COMMENT 'Unique session identifier',
  `startTime` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'Session start time',
  `endTime` timestamp NULL DEFAULT NULL COMMENT 'Session end time',
  `duration` int(11) DEFAULT NULL COMMENT 'Session duration in seconds',
  `status` enum('active','completed','abandoned','timed_out') NOT NULL DEFAULT 'active' COMMENT 'Current session status',
  `pageViews` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of page views in this session',
  `activitiesCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of learning activities in this session',
  `coursesAccessed` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Courses accessed during this session' CHECK (json_valid(`coursesAccessed`)),
  `lessonsAccessed` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Lessons accessed during this session' CHECK (json_valid(`lessonsAccessed`)),
  `assessmentsTaken` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Assessments taken during this session' CHECK (json_valid(`assessmentsTaken`)),
  `deviceType` enum('desktop','tablet','mobile','unknown') DEFAULT NULL COMMENT 'Primary device type used in session',
  `browser` varchar(100) DEFAULT NULL COMMENT 'Browser used in session',
  `operatingSystem` varchar(100) DEFAULT NULL COMMENT 'Operating system used in session',
  `ipAddress` varchar(45) DEFAULT NULL COMMENT 'IP address used in session',
  `location` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Geolocation data for session' CHECK (json_valid(`location`)),
  `engagementMetrics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Session engagement metrics' CHECK (json_valid(`engagementMetrics`)),
  `learningOutcomes` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Learning outcomes from this session' CHECK (json_valid(`learningOutcomes`)),
  `qualityIndicators` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Session quality indicators' CHECK (json_valid(`qualityIndicators`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional session metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `learning_style_profiles`
--

CREATE TABLE `learning_style_profiles` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `userId` varchar(36) NOT NULL,
  `primaryLearningStyle` enum('visual','auditory','kinesthetic','reading_writing','multimodal','balanced','unknown') NOT NULL DEFAULT 'balanced',
  `secondaryLearningStyle` enum('visual','auditory','kinesthetic','reading_writing','multimodal','balanced','unknown') DEFAULT NULL,
  `preferredModality` enum('visual','auditory','kinesthetic','reading_writing','multimodal') NOT NULL DEFAULT 'multimodal',
  `styleScores` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL CHECK (json_valid(`styleScores`)),
  `learningPreferences` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL CHECK (json_valid(`learningPreferences`)),
  `cognitiveTraits` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`cognitiveTraits`)),
  `motivationalFactors` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`motivationalFactors`)),
  `confidenceLevel` decimal(5,2) NOT NULL DEFAULT 0.00,
  `interactionsAnalyzed` int(11) NOT NULL DEFAULT 0,
  `lastAnalyzedAt` timestamp NULL DEFAULT NULL,
  `adaptationHistory` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`adaptationHistory`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `lessons`
--

CREATE TABLE `lessons` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `courseId` varchar(36) NOT NULL COMMENT 'Course ID this lesson belongs to',
  `sectionId` varchar(36) DEFAULT NULL COMMENT 'Section ID this lesson belongs to',
  `title` varchar(255) NOT NULL COMMENT 'Lesson title',
  `slug` varchar(255) NOT NULL COMMENT 'URL-friendly slug',
  `description` text DEFAULT NULL COMMENT 'Lesson description',
  `content` longtext DEFAULT NULL COMMENT 'Lesson content (HTML/Markdown)',
  `videoUrl` varchar(500) DEFAULT NULL COMMENT 'Video URL for video lessons',
  `videoDuration` int(11) DEFAULT NULL COMMENT 'Video duration in seconds',
  `audioUrl` varchar(500) DEFAULT NULL COMMENT 'Audio URL for audio lessons',
  `attachments` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Lesson attachments and resources' CHECK (json_valid(`attachments`)),
  `lessonType` enum('video','text','audio','interactive','quiz','assignment','live_session','download') NOT NULL DEFAULT 'text' COMMENT 'Type of lesson content',
  `orderIndex` int(11) NOT NULL DEFAULT 0 COMMENT 'Order within section or course',
  `isPreview` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Allow preview without enrollment',
  `isMandatory` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Lesson completion required to proceed',
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Lesson active status',
  `status` enum('draft','under_review','published','archived','suspended') NOT NULL DEFAULT 'draft' COMMENT 'Content publication status',
  `moderationStatus` enum('pending','approved','rejected','requires_changes','flagged') NOT NULL DEFAULT 'pending' COMMENT 'Content moderation status',
  `moderatedBy` varchar(36) DEFAULT NULL COMMENT 'Moderator who reviewed this content',
  `moderatedAt` timestamp NULL DEFAULT NULL COMMENT 'Moderation timestamp',
  `moderationReason` text DEFAULT NULL COMMENT 'Moderation reason/feedback',
  `estimatedDuration` int(11) DEFAULT NULL COMMENT 'Estimated completion time in minutes',
  `points` int(11) NOT NULL DEFAULT 0 COMMENT 'Points awarded for completion',
  `availableFrom` timestamp NULL DEFAULT NULL COMMENT 'Lesson availability start date',
  `availableUntil` timestamp NULL DEFAULT NULL COMMENT 'Lesson availability end date',
  `publishedAt` timestamp NULL DEFAULT NULL COMMENT 'Content published timestamp',
  `objectives` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Lesson learning objectives' CHECK (json_valid(`objectives`)),
  `prerequisites` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Prerequisites for this lesson' CHECK (json_valid(`prerequisites`)),
  `interactiveElements` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Interactive elements configuration' CHECK (json_valid(`interactiveElements`)),
  `thumbnailUrl` varchar(500) DEFAULT NULL COMMENT 'Lesson thumbnail image URL',
  `transcript` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Video transcript for accessibility' CHECK (json_valid(`transcript`)),
  `currentVersion` int(11) NOT NULL DEFAULT 1 COMMENT 'Current content version number',
  `hasDraftChanges` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether content has draft changes',
  `lastContentUpdate` timestamp NULL DEFAULT NULL COMMENT 'Last content modification timestamp',
  `viewCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Total views count',
  `completionCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Total completions count',
  `averageRating` decimal(3,2) NOT NULL DEFAULT 0.00 COMMENT 'Average lesson rating',
  `averageTimeSpent` int(11) NOT NULL DEFAULT 0 COMMENT 'Average time spent in seconds',
  `completionRate` decimal(5,2) NOT NULL DEFAULT 0.00 COMMENT 'Lesson completion rate percentage',
  `settings` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Lesson settings and preferences' CHECK (json_valid(`settings`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional lesson metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `lesson_progress`
--

CREATE TABLE `lesson_progress` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `studentId` varchar(36) NOT NULL COMMENT 'Student user ID',
  `lessonId` varchar(36) NOT NULL COMMENT 'Lesson ID',
  `enrollmentId` varchar(36) NOT NULL COMMENT 'Enrollment ID',
  `status` enum('not_started','in_progress','completed','skipped') NOT NULL DEFAULT 'not_started' COMMENT 'Lesson progress status',
  `completionDate` timestamp NULL DEFAULT NULL COMMENT 'Lesson completion date',
  `timeSpent` int(11) NOT NULL DEFAULT 0 COMMENT 'Time spent on lesson in seconds',
  `lastPosition` int(11) NOT NULL DEFAULT 0 COMMENT 'Last playback position in seconds (for videos)',
  `attempts` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of times lesson was attempted',
  `score` decimal(5,2) DEFAULT NULL COMMENT 'Score achieved (for quizzes/assignments)',
  `maxScore` decimal(5,2) DEFAULT NULL COMMENT 'Maximum possible score',
  `progressPercentage` decimal(5,2) NOT NULL DEFAULT 0.00 COMMENT 'Progress percentage (0-100)',
  `firstAccessedAt` timestamp NULL DEFAULT NULL COMMENT 'First time lesson was accessed',
  `lastAccessedAt` timestamp NULL DEFAULT NULL COMMENT 'Last time lesson was accessed',
  `answers` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'User answers for quiz/assignment lessons' CHECK (json_valid(`answers`)),
  `notes` text DEFAULT NULL COMMENT 'Student notes for this lesson',
  `bookmarks` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Bookmarks/timestamps for video lessons' CHECK (json_valid(`bookmarks`)),
  `interactionData` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Interaction data (pause points, rewinds, etc.)' CHECK (json_valid(`interactionData`)),
  `isSkipped` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether lesson was skipped',
  `feedback` text DEFAULT NULL COMMENT 'Reason for skipping or feedback',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional progress metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `ml_models`
--

CREATE TABLE `ml_models` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `name` varchar(255) NOT NULL COMMENT 'Model name identifier',
  `displayName` varchar(255) NOT NULL COMMENT 'Human-readable display name',
  `description` text DEFAULT NULL COMMENT 'Model description and purpose',
  `modelType` enum('recommendation','classification','regression','clustering','nlp','computer_vision','time_series','reinforcement_learning','anomaly_detection','collaborative_filtering','content_based','hybrid') NOT NULL COMMENT 'Type of ML model',
  `framework` enum('scikit_learn','tensorflow','pytorch','xgboost','lightgbm','catboost','spacy','transformers','opencv','pandas','numpy','custom') NOT NULL COMMENT 'ML framework used',
  `status` enum('development','training','trained','testing','staging','production','deprecated','failed','archived') NOT NULL DEFAULT 'development' COMMENT 'Current model status',
  `currentVersion` varchar(255) DEFAULT NULL COMMENT 'Current active version',
  `serviceEndpoint` varchar(500) DEFAULT NULL COMMENT 'Python service endpoint URL',
  `configuration` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Model configuration and hyperparameters' CHECK (json_valid(`configuration`)),
  `metrics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Model performance metrics' CHECK (json_valid(`metrics`)),
  `trainingData` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Training dataset information' CHECK (json_valid(`trainingData`)),
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Whether model is active',
  `isDeployed` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether model is deployed in production',
  `lastTrainedAt` timestamp NULL DEFAULT NULL COMMENT 'When model was last trained',
  `deployedAt` timestamp NULL DEFAULT NULL COMMENT 'When model was deployed',
  `abTestConfig` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'A/B testing configuration' CHECK (json_valid(`abTestConfig`)),
  `tags` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Model tags and metadata' CHECK (json_valid(`tags`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `model_predictions`
--

CREATE TABLE `model_predictions` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `modelId` varchar(36) NOT NULL COMMENT 'Reference to model used',
  `modelVersionId` varchar(36) NOT NULL COMMENT 'Reference to model version used',
  `userId` varchar(36) DEFAULT NULL COMMENT 'User this prediction is for',
  `predictionType` varchar(100) NOT NULL COMMENT 'Type of prediction',
  `inputData` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL COMMENT 'Input data used for prediction' CHECK (json_valid(`inputData`)),
  `prediction` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Model prediction output' CHECK (json_valid(`prediction`)),
  `confidence` decimal(10,6) DEFAULT NULL COMMENT 'Prediction confidence score',
  `status` enum('pending','processing','completed','failed','timeout','cancelled') NOT NULL DEFAULT 'pending' COMMENT 'Prediction processing status',
  `errorMessage` text DEFAULT NULL COMMENT 'Error message if prediction failed',
  `processingTime` int(11) DEFAULT NULL COMMENT 'Processing time in milliseconds',
  `requestId` varchar(255) DEFAULT NULL COMMENT 'Request ID for tracking',
  `actualOutcome` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Actual outcome for evaluation' CHECK (json_valid(`actualOutcome`)),
  `wasCorrect` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether prediction was correct',
  `requestedAt` timestamp NULL DEFAULT NULL COMMENT 'When prediction was requested',
  `completedAt` timestamp NULL DEFAULT NULL COMMENT 'When prediction was completed',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional prediction metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `model_versions`
--

CREATE TABLE `model_versions` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `modelId` varchar(36) NOT NULL COMMENT 'Reference to ML model',
  `version` varchar(100) NOT NULL COMMENT 'Version identifier (e.g., v1.0.0, 2024-01-15)',
  `jobId` varchar(100) DEFAULT NULL COMMENT 'ID of the training job in the background queue',
  `description` text DEFAULT NULL COMMENT 'Version description and changes',
  `status` enum('training','completed','failed','deployed','deprecated','testing') NOT NULL DEFAULT 'training' COMMENT 'Version status',
  `modelPath` varchar(500) DEFAULT NULL COMMENT 'Model file path or artifact URL',
  `dockerImage` varchar(500) DEFAULT NULL COMMENT 'Docker image for this version',
  `trainingMetrics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Training metrics for this version' CHECK (json_valid(`trainingMetrics`)),
  `evaluationResults` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Model evaluation results' CHECK (json_valid(`evaluationResults`)),
  `artifacts` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Model artifacts information' CHECK (json_valid(`artifacts`)),
  `trainingStartedAt` timestamp NULL DEFAULT NULL COMMENT 'When training started',
  `trainingCompletedAt` timestamp NULL DEFAULT NULL COMMENT 'When training completed',
  `configuration` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Version-specific configuration' CHECK (json_valid(`configuration`)),
  `performanceComparison` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Performance comparison with previous versions' CHECK (json_valid(`performanceComparison`)),
  `isActive` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether this version is currently active',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `note_collaborators`
--

CREATE TABLE `note_collaborators` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `noteId` varchar(36) NOT NULL COMMENT 'Note ID',
  `userId` varchar(36) NOT NULL COMMENT 'Collaborator user ID',
  `permission` enum('view','comment','edit','admin') NOT NULL DEFAULT 'view' COMMENT 'Collaborator permission',
  `status` enum('invited','active','inactive') NOT NULL DEFAULT 'invited' COMMENT 'Collaborator status',
  `invitedAt` timestamp NULL DEFAULT NULL COMMENT 'Invitation sent timestamp',
  `acceptedAt` timestamp NULL DEFAULT NULL COMMENT 'Invitation accepted timestamp',
  `lastAccessAt` timestamp NULL DEFAULT NULL COMMENT 'Last access timestamp',
  `metadata` longtext DEFAULT NULL COMMENT 'Additional metadata (JSON)'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `notifications`
--

CREATE TABLE `notifications` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `userId` varchar(36) NOT NULL COMMENT 'Recipient user ID',
  `title` varchar(255) NOT NULL COMMENT 'Notification title',
  `message` text NOT NULL COMMENT 'Notification message content',
  `type` enum('course_enrollment','lesson_available','assignment_due','quiz_available','grade_posted','message_received','video_session_starting','certificate_earned','course_completed','reminder_study','system_maintenance','security_alert','announcement','friend_request','forum_reply','chat_message','study_group_invitation','peer_review_assigned','project_deadline','collaboration_request','group_message','whiteboard_shared','note_shared','task_assigned','chat_mention','chat_everyone','forum_thread_reply','forum_mention','forum_reputation_gained','report_handled','assessment_started','assessment_completed','assessment_submitted','security_violation','session_terminated','time_warning','session_expired','video_session_reminder','assessment_terminated') NOT NULL COMMENT 'Type of notification',
  `priority` enum('low','normal','medium','high','urgent') NOT NULL DEFAULT 'normal' COMMENT 'Priority level of notification',
  `category` enum('academic','social','system','security','marketing','administrative','chat','video_session','forum_report','forum') NOT NULL COMMENT 'Category of notification',
  `relatedId` varchar(36) DEFAULT NULL COMMENT 'ID of related entity',
  `relatedType` varchar(50) DEFAULT NULL COMMENT 'Type of related entity',
  `isRead` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether notification has been read',
  `readAt` timestamp NULL DEFAULT NULL COMMENT 'When notification was read',
  `iconUrl` varchar(500) DEFAULT NULL COMMENT 'Icon URL for notification',
  `imageUrl` varchar(500) DEFAULT NULL COMMENT 'Image URL for rich notifications',
  `actionUrl` varchar(500) DEFAULT NULL COMMENT 'Action URL when notification is clicked',
  `actions` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Action buttons for rich notifications' CHECK (json_valid(`actions`)),
  `deliveryStatus` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Delivery channel status' CHECK (json_valid(`deliveryStatus`)),
  `expiresAt` timestamp NULL DEFAULT NULL COMMENT 'When notification expires',
  `personalization` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Personalization data' CHECK (json_valid(`personalization`)),
  `tracking` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Tracking and analytics data' CHECK (json_valid(`tracking`)),
  `richContent` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Rich content data' CHECK (json_valid(`richContent`)),
  `scheduling` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Scheduling information' CHECK (json_valid(`scheduling`)),
  `grouping` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Grouping information for notification bundling' CHECK (json_valid(`grouping`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional notification metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `notification_deliveries`
--

CREATE TABLE `notification_deliveries` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `notificationId` varchar(36) NOT NULL COMMENT 'Notification ID',
  `channel` enum('in_app','email','push','sms','slack','discord','webhook') NOT NULL COMMENT 'Delivery channel used',
  `status` enum('pending','sent','delivered','failed','bounced','opened','clicked','unsubscribed') NOT NULL DEFAULT 'pending' COMMENT 'Delivery status',
  `recipientAddress` varchar(255) DEFAULT NULL COMMENT 'Recipient address (email, phone, etc.)',
  `templateId` varchar(36) DEFAULT NULL COMMENT 'Template used for delivery',
  `renderedContent` longtext DEFAULT NULL COMMENT 'Rendered content sent',
  `subject` varchar(255) DEFAULT NULL COMMENT 'Subject line used',
  `sentAt` timestamp NULL DEFAULT NULL COMMENT 'When delivery was sent',
  `deliveredAt` timestamp NULL DEFAULT NULL COMMENT 'When delivery was confirmed',
  `openedAt` timestamp NULL DEFAULT NULL COMMENT 'When content was opened/viewed',
  `clickedAt` timestamp NULL DEFAULT NULL COMMENT 'When action was clicked',
  `externalId` varchar(100) DEFAULT NULL COMMENT 'External provider message ID',
  `errorMessage` text DEFAULT NULL COMMENT 'Error message if delivery failed',
  `retryCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of retry attempts',
  `nextRetryAt` timestamp NULL DEFAULT NULL COMMENT 'Next retry scheduled time',
  `providerResponse` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Provider-specific response data' CHECK (json_valid(`providerResponse`)),
  `analytics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Delivery analytics and tracking' CHECK (json_valid(`analytics`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional delivery metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `notification_preferences`
--

CREATE TABLE `notification_preferences` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `userId` varchar(36) NOT NULL COMMENT 'User ID',
  `notificationType` enum('course_enrollment','lesson_available','assignment_due','quiz_available','grade_posted','message_received','video_session_starting','certificate_earned','course_completed','reminder_study','system_maintenance','security_alert','announcement','friend_request','forum_reply','chat_message','study_group_invitation','peer_review_assigned','project_deadline','collaboration_request','group_message','whiteboard_shared','note_shared','task_assigned','chat_mention','chat_everyone','forum_thread_reply','forum_mention','forum_reputation_gained','report_handled','assessment_started','assessment_completed','assessment_submitted','security_violation','session_terminated','time_warning','session_expired','video_session_reminder','assessment_terminated') NOT NULL COMMENT 'Type of notification',
  `emailEnabled` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Whether email notifications are enabled',
  `pushEnabled` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Whether push notifications are enabled',
  `smsEnabled` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether SMS notifications are enabled',
  `inAppEnabled` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Whether in-app notifications are enabled',
  `slackEnabled` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether Slack notifications are enabled',
  `discordEnabled` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether Discord notifications are enabled',
  `frequency` enum('immediate','hourly','daily','weekly','never') NOT NULL DEFAULT 'immediate' COMMENT 'Notification frequency preference',
  `quietHours` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Quiet hours configuration' CHECK (json_valid(`quietHours`)),
  `filters` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Advanced filtering preferences' CHECK (json_valid(`filters`)),
  `digestSettings` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Digest settings for batched notifications' CHECK (json_valid(`digestSettings`)),
  `deliveryPreferences` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Custom delivery preferences' CHECK (json_valid(`deliveryPreferences`)),
  `integrations` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Integration settings' CHECK (json_valid(`integrations`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional preference metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `notification_subscriptions`
--

CREATE TABLE `notification_subscriptions` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `userId` varchar(36) NOT NULL COMMENT 'User ID',
  `channel` enum('in_app','email','push','sms','slack','discord','webhook') NOT NULL COMMENT 'Subscription channel',
  `endpoint` text NOT NULL COMMENT 'Subscription endpoint (URL, token, phone, etc.)',
  `config` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Channel-specific configuration' CHECK (json_valid(`config`)),
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Whether subscription is active',
  `isVerified` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Whether subscription is verified',
  `verifiedAt` timestamp NULL DEFAULT NULL COMMENT 'When subscription was verified',
  `lastDeliveryAt` timestamp NULL DEFAULT NULL COMMENT 'Last successful delivery',
  `failureCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of failed deliveries',
  `deviceInfo` varchar(100) DEFAULT NULL COMMENT 'Device/browser information',
  `platform` varchar(50) DEFAULT NULL COMMENT 'Platform (web, mobile, desktop)',
  `analytics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Subscription analytics' CHECK (json_valid(`analytics`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional subscription metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `notification_templates`
--

CREATE TABLE `notification_templates` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `name` varchar(255) NOT NULL COMMENT 'Template name',
  `description` text DEFAULT NULL COMMENT 'Template description',
  `type` enum('course_enrollment','lesson_available','assignment_due','quiz_available','grade_posted','message_received','video_session_starting','certificate_earned','course_completed','reminder_study','system_maintenance','security_alert','announcement','friend_request','forum_reply','chat_message','study_group_invitation','peer_review_assigned','project_deadline','collaboration_request','group_message','whiteboard_shared','note_shared','task_assigned','chat_mention','chat_everyone','forum_thread_reply','forum_mention','forum_reputation_gained','report_handled','assessment_started','assessment_completed','assessment_submitted','security_violation','session_terminated','time_warning','session_expired','video_session_reminder','assessment_terminated') NOT NULL COMMENT 'Notification type this template is for',
  `channel` enum('in_app','email','push','sms','slack','discord','webhook') NOT NULL COMMENT 'Delivery channel for this template',
  `templateType` enum('email_html','email_text','push_notification','sms_message','in_app_alert','slack_message','discord_embed') NOT NULL COMMENT 'Template format type',
  `subject` varchar(255) NOT NULL COMMENT 'Template subject (for email/push)',
  `body` longtext NOT NULL COMMENT 'Template body content with placeholders',
  `htmlBody` longtext DEFAULT NULL COMMENT 'HTML version of template body',
  `variables` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Template variables and their descriptions' CHECK (json_valid(`variables`)),
  `styling` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Template styling configuration' CHECK (json_valid(`styling`)),
  `locale` varchar(50) DEFAULT NULL COMMENT 'Template language/locale',
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Whether template is active',
  `isDefault` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether template is system default',
  `version` int(11) NOT NULL DEFAULT 1 COMMENT 'Template version number',
  `abTesting` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'A/B testing configuration' CHECK (json_valid(`abTesting`)),
  `validationRules` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Template validation rules' CHECK (json_valid(`validationRules`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional template metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `peer_reviews`
--

CREATE TABLE `peer_reviews` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `title` varchar(255) NOT NULL COMMENT 'Peer review title',
  `description` text DEFAULT NULL COMMENT 'Peer review description',
  `type` enum('assignment','project','presentation','discussion','code_review') NOT NULL COMMENT 'Peer review type',
  `status` enum('pending','in_progress','submitted','completed','overdue') NOT NULL DEFAULT 'pending' COMMENT 'Peer review status',
  `creatorId` varchar(36) NOT NULL COMMENT 'Peer review creator ID',
  `courseId` varchar(36) DEFAULT NULL COMMENT 'Associated course ID',
  `assignmentId` varchar(36) DEFAULT NULL COMMENT 'Associated assignment ID',
  `dueDate` timestamp NULL DEFAULT NULL COMMENT 'Review due date',
  `reviewersPerSubmission` int(11) NOT NULL DEFAULT 3 COMMENT 'Number of reviewers per submission',
  `submissionsPerReviewer` int(11) NOT NULL DEFAULT 3 COMMENT 'Number of submissions per reviewer',
  `isAnonymous` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is anonymous review',
  `allowSelfReview` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Allow self review',
  `criteria` longtext DEFAULT NULL COMMENT 'Review criteria (JSON)',
  `rubric` longtext DEFAULT NULL COMMENT 'Review rubric (JSON)',
  `instructions` longtext DEFAULT NULL COMMENT 'Review instructions',
  `settings` longtext DEFAULT NULL COMMENT 'Peer review settings (JSON)',
  `metadata` longtext DEFAULT NULL COMMENT 'Additional metadata (JSON)'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `peer_review_feedbacks`
--

CREATE TABLE `peer_review_feedbacks` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `submissionId` varchar(36) NOT NULL COMMENT 'Submission ID being reviewed',
  `reviewerId` varchar(36) NOT NULL COMMENT 'Reviewer user ID',
  `feedback` longtext NOT NULL COMMENT 'Review feedback content',
  `score` decimal(5,2) DEFAULT NULL COMMENT 'Overall score given',
  `criteriaScores` longtext DEFAULT NULL COMMENT 'Detailed scores by criteria (JSON)',
  `status` enum('draft','submitted','completed') NOT NULL DEFAULT 'draft' COMMENT 'Feedback status',
  `submittedAt` timestamp NULL DEFAULT NULL COMMENT 'Feedback submission timestamp',
  `isHelpful` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is feedback helpful',
  `helpfulnessVotes` int(11) NOT NULL DEFAULT 0 COMMENT 'Helpfulness votes',
  `metadata` longtext DEFAULT NULL COMMENT 'Additional metadata (JSON)'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `peer_review_submissions`
--

CREATE TABLE `peer_review_submissions` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `peerReviewId` varchar(36) NOT NULL COMMENT 'Peer review ID',
  `submitterId` varchar(36) NOT NULL COMMENT 'Submitter user ID',
  `content` longtext NOT NULL COMMENT 'Submission content',
  `attachments` longtext DEFAULT NULL COMMENT 'Submission attachments (JSON)',
  `status` enum('draft','submitted','under_review','reviewed','completed') NOT NULL DEFAULT 'draft' COMMENT 'Submission status',
  `submittedAt` timestamp NULL DEFAULT NULL COMMENT 'Submission timestamp',
  `averageScore` decimal(5,2) DEFAULT NULL COMMENT 'Average peer score',
  `reviewsReceived` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of reviews received',
  `reviewsCompleted` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of reviews completed by submitter',
  `metadata` longtext DEFAULT NULL COMMENT 'Submission metadata (JSON)'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `performance_predictions`
--

CREATE TABLE `performance_predictions` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `studentId` varchar(36) NOT NULL COMMENT 'Student user ID',
  `courseId` varchar(36) DEFAULT NULL COMMENT 'Course ID (null for general predictions)',
  `predictionType` enum('performance','dropout_risk','learning_outcome','completion_time','resource_usage') NOT NULL COMMENT 'Type of prediction',
  `predictionDate` datetime NOT NULL COMMENT 'Date when prediction was made',
  `targetDate` datetime DEFAULT NULL COMMENT 'Target date for prediction outcome',
  `predictedValue` decimal(5,2) NOT NULL COMMENT 'Predicted score or probability (0-100)',
  `confidenceScore` decimal(5,2) NOT NULL COMMENT 'Confidence level of prediction (0-100)',
  `riskLevel` enum('very_low','low','medium','high','very_high') NOT NULL COMMENT 'Risk level assessment',
  `contributingFactors` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Contributing factors to prediction' CHECK (json_valid(`contributingFactors`)),
  `predictionDetails` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Detailed prediction breakdown' CHECK (json_valid(`predictionDetails`)),
  `actualValue` decimal(5,2) DEFAULT NULL COMMENT 'Actual outcome for validation',
  `accuracyScore` decimal(5,2) DEFAULT NULL COMMENT 'Prediction accuracy when validated',
  `isValidated` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether prediction has been validated',
  `validatedAt` datetime DEFAULT NULL COMMENT 'Date when prediction was validated',
  `modelVersion` varchar(100) NOT NULL COMMENT 'Model version used for prediction',
  `modelMetadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Model-specific metadata' CHECK (json_valid(`modelMetadata`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional prediction metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `permissions`
--

CREATE TABLE `permissions` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `name` varchar(100) NOT NULL COMMENT 'Permission name',
  `description` varchar(255) DEFAULT NULL COMMENT 'Permission description',
  `resource` enum('user','course','lesson','assessment','grade','analytics','system','*') NOT NULL COMMENT 'Resource this permission applies to',
  `action` enum('create','read','update','delete','manage') NOT NULL COMMENT 'Action this permission allows',
  `conditions` varchar(255) DEFAULT NULL COMMENT 'Additional conditions or constraints',
  `isSystemPermission` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether this is a system-defined permission',
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Whether this permission is active',
  `category` varchar(100) DEFAULT NULL COMMENT 'Permission category or group',
  `priority` int(11) NOT NULL DEFAULT 0 COMMENT 'Permission priority level',
  `settings` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Permission-specific settings' CHECK (json_valid(`settings`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional permission metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `plagiarism_checks`
--

CREATE TABLE `plagiarism_checks` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `initiated_by` varchar(36) DEFAULT NULL,
  `content_type` enum('course','lesson','assignment','forum_post') NOT NULL,
  `content_id` varchar(36) NOT NULL,
  `content_hash` varchar(64) NOT NULL,
  `status` enum('pending','scanning','completed','failed') NOT NULL DEFAULT 'pending',
  `scan_started_at` timestamp NULL DEFAULT NULL,
  `scan_completed_at` timestamp NULL DEFAULT NULL,
  `overall_similarity` decimal(5,2) DEFAULT NULL,
  `plagiarism_level` enum('none','low','moderate','high','severe') DEFAULT NULL,
  `sources_checked` int(11) NOT NULL DEFAULT 0,
  `matches_found` int(11) NOT NULL DEFAULT 0,
  `matches` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`matches`)),
  `analysis` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`analysis`)),
  `scanConfiguration` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`scanConfiguration`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `privacy_settings`
--

CREATE TABLE `privacy_settings` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `user_id` varchar(36) NOT NULL,
  `profileVisible` tinyint(4) NOT NULL DEFAULT 1,
  `allowSearch` tinyint(4) NOT NULL DEFAULT 1,
  `showOnlineStatus` tinyint(4) NOT NULL DEFAULT 0,
  `showLastSeen` tinyint(4) NOT NULL DEFAULT 1,
  `trackLearningActivity` tinyint(4) NOT NULL DEFAULT 1,
  `trackPerformanceData` tinyint(4) NOT NULL DEFAULT 1,
  `shareActivityData` tinyint(4) NOT NULL DEFAULT 0,
  `allowAnalytics` tinyint(4) NOT NULL DEFAULT 0,
  `allowDirectMessages` tinyint(4) NOT NULL DEFAULT 1,
  `allowGroupInvitations` tinyint(4) NOT NULL DEFAULT 1,
  `allowMarketingEmails` tinyint(4) NOT NULL DEFAULT 0,
  `allowSystemNotifications` tinyint(4) NOT NULL DEFAULT 1,
  `shareDataWithInstructors` tinyint(4) NOT NULL DEFAULT 0,
  `shareDataWithPeers` tinyint(4) NOT NULL DEFAULT 0,
  `shareDataWithThirdParties` tinyint(4) NOT NULL DEFAULT 0,
  `allowDataExport` tinyint(4) NOT NULL DEFAULT 0,
  `cookiePreferences` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`cookiePreferences`)),
  `dataRetentionPreferences` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`dataRetentionPreferences`)),
  `advancedSettings` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`advancedSettings`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `project_members`
--

CREATE TABLE `project_members` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `projectId` varchar(36) NOT NULL COMMENT 'Project ID',
  `userId` varchar(36) NOT NULL COMMENT 'User ID',
  `role` enum('leader','member','reviewer','observer') NOT NULL DEFAULT 'member' COMMENT 'Member role in project',
  `status` enum('active','inactive','removed') NOT NULL DEFAULT 'active' COMMENT 'Member status',
  `joinedAt` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'Join timestamp',
  `lastActiveAt` timestamp NULL DEFAULT NULL COMMENT 'Last activity timestamp',
  `contributionScore` int(11) NOT NULL DEFAULT 0 COMMENT 'Contribution score',
  `tasksCompleted` int(11) NOT NULL DEFAULT 0 COMMENT 'Tasks completed',
  `responsibilities` longtext DEFAULT NULL COMMENT 'Member responsibilities (JSON)',
  `metadata` longtext DEFAULT NULL COMMENT 'Additional metadata (JSON)'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `project_tasks`
--

CREATE TABLE `project_tasks` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `projectId` varchar(36) NOT NULL COMMENT 'Project ID',
  `title` varchar(255) NOT NULL COMMENT 'Task title',
  `description` text DEFAULT NULL COMMENT 'Task description',
  `status` enum('todo','in_progress','review','done','blocked') NOT NULL DEFAULT 'todo' COMMENT 'Task status',
  `priority` enum('low','medium','high','urgent') NOT NULL DEFAULT 'medium' COMMENT 'Task priority',
  `assigneeId` varchar(36) DEFAULT NULL COMMENT 'Task assignee ID',
  `creatorId` varchar(36) NOT NULL COMMENT 'Task creator ID',
  `dueDate` timestamp NULL DEFAULT NULL COMMENT 'Task due date',
  `completedAt` timestamp NULL DEFAULT NULL COMMENT 'Task completion date',
  `estimatedHours` int(11) NOT NULL DEFAULT 0 COMMENT 'Estimated hours',
  `actualHours` int(11) NOT NULL DEFAULT 0 COMMENT 'Actual hours spent',
  `dependencies` longtext DEFAULT NULL COMMENT 'Task dependencies (JSON)',
  `attachments` longtext DEFAULT NULL COMMENT 'Task attachments (JSON)',
  `comments` longtext DEFAULT NULL COMMENT 'Task comments (JSON)',
  `metadata` longtext DEFAULT NULL COMMENT 'Additional metadata (JSON)'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `questions`
--

CREATE TABLE `questions` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `assessmentId` varchar(36) DEFAULT NULL COMMENT 'Assessment ID',
  `questionText` text NOT NULL COMMENT 'Question text/content',
  `questionType` enum('multiple_choice','true_false','short_answer','essay','fill_in_the_blank','matching','ordering','numeric','code') NOT NULL DEFAULT 'multiple_choice' COMMENT 'Type of question',
  `explanation` text DEFAULT NULL COMMENT 'Explanation for the correct answer',
  `points` decimal(5,2) NOT NULL DEFAULT 1.00 COMMENT 'Points awarded for correct answer',
  `difficulty` enum('easy','medium','hard','expert') NOT NULL DEFAULT 'medium' COMMENT 'Question difficulty level',
  `orderIndex` int(11) NOT NULL DEFAULT 0 COMMENT 'Display order in assessment',
  `timeLimit` int(11) DEFAULT NULL COMMENT 'Time limit for this question in seconds',
  `hint` text DEFAULT NULL COMMENT 'Hint for the question',
  `options` longtext DEFAULT NULL COMMENT 'Question options for multiple choice questions',
  `correctAnswer` longtext DEFAULT NULL COMMENT 'Correct answer(s) for the question',
  `tags` longtext DEFAULT NULL COMMENT 'Question tags for categorization',
  `attachments` longtext DEFAULT NULL COMMENT 'File attachments (JSON)',
  `validationRules` longtext DEFAULT NULL COMMENT 'Validation rules for answer checking',
  `analytics` longtext DEFAULT NULL COMMENT 'Analytics data for this question',
  `metadata` longtext DEFAULT NULL COMMENT 'Additional question metadata'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `realtime_events`
--

CREATE TABLE `realtime_events` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `eventType` enum('lesson_started','lesson_completed','course_progress_updated','assignment_submitted','grade_received','user_login','user_logout','user_online','user_offline','user_typing','course_enrolled','course_created','course_updated','new_announcement','new_message','message_edited','message_deleted','reaction_added','quiz_started','quiz_submitted','quiz_graded','system_notification','maintenance_mode','broadcast_message') NOT NULL COMMENT 'Type of real-time event',
  `scope` enum('global','user','course','group','room','role') NOT NULL COMMENT 'Scope of event distribution',
  `targetId` varchar(36) DEFAULT NULL COMMENT 'Target ID based on scope (userId, courseId, groupId, etc.)',
  `triggeredBy` varchar(36) DEFAULT NULL COMMENT 'User who triggered the event',
  `title` varchar(255) NOT NULL COMMENT 'Event title/headline',
  `message` text DEFAULT NULL COMMENT 'Event message/description',
  `payload` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Event payload data' CHECK (json_valid(`payload`)),
  `actionUrl` varchar(500) DEFAULT NULL COMMENT 'Action URL for event',
  `iconUrl` varchar(500) DEFAULT NULL COMMENT 'Icon URL for event',
  `priority` int(11) NOT NULL DEFAULT 1 COMMENT 'Event priority (1=low, 5=critical)',
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Whether event is active',
  `expiresAt` timestamp NULL DEFAULT NULL COMMENT 'When event expires',
  `channels` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Delivery channels configuration' CHECK (json_valid(`channels`)),
  `deliveryStatus` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Event delivery status' CHECK (json_valid(`deliveryStatus`)),
  `reachCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of users reached',
  `interactionCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of interactions (clicks, views)',
  `tags` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Event tags for filtering' CHECK (json_valid(`tags`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `resource_optimizations`
--

CREATE TABLE `resource_optimizations` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `resourceType` enum('content','instructor_time','system_resources','study_materials','assessment_slots','support_services') NOT NULL COMMENT 'Type of resource being optimized',
  `resourceId` varchar(255) NOT NULL COMMENT 'Resource identifier',
  `optimizationDate` datetime NOT NULL COMMENT 'Optimization analysis date',
  `currentEfficiency` decimal(5,2) NOT NULL COMMENT 'Current efficiency score (0-100)',
  `predictedEfficiency` decimal(5,2) NOT NULL COMMENT 'Predicted efficiency with optimization (0-100)',
  `currentUsage` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL COMMENT 'Current usage patterns' CHECK (json_valid(`currentUsage`)),
  `recommendations` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL COMMENT 'Optimization recommendations' CHECK (json_valid(`recommendations`)),
  `predictedOutcomes` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Predicted outcomes' CHECK (json_valid(`predictedOutcomes`)),
  `implementationPlan` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Implementation plan' CHECK (json_valid(`implementationPlan`)),
  `isImplemented` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether optimization has been implemented',
  `actualEfficiency` decimal(5,2) DEFAULT NULL COMMENT 'Actual efficiency after implementation',
  `implementationResults` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Implementation results' CHECK (json_valid(`implementationResults`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional optimization metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `roles`
--

CREATE TABLE `roles` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `name` varchar(100) NOT NULL COMMENT 'Role name',
  `description` varchar(255) DEFAULT NULL COMMENT 'Role description',
  `displayName` varchar(50) DEFAULT NULL COMMENT 'Role display name',
  `isSystemRole` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether this is a system-defined role',
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Whether this role is active',
  `level` int(11) NOT NULL DEFAULT 0 COMMENT 'Role hierarchy level (0 = highest)',
  `color` varchar(20) DEFAULT NULL COMMENT 'Role color for UI display',
  `icon` varchar(50) DEFAULT NULL COMMENT 'Role icon identifier',
  `settings` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Role-specific settings and configurations' CHECK (json_valid(`settings`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional role metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `role_permissions`
--

CREATE TABLE `role_permissions` (
  `role_id` varchar(36) NOT NULL,
  `permission_id` varchar(36) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `security_events`
--

CREATE TABLE `security_events` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `type` enum('authentication','authorization','validation','encryption','suspicious') NOT NULL,
  `severity` enum('low','medium','high','critical') NOT NULL,
  `source` varchar(255) NOT NULL,
  `userId` varchar(255) DEFAULT NULL,
  `sessionId` varchar(255) DEFAULT NULL,
  `ip` varchar(255) NOT NULL,
  `userAgent` varchar(255) DEFAULT NULL,
  `details` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL CHECK (json_valid(`details`)),
  `timestamp` datetime(6) NOT NULL DEFAULT current_timestamp(6)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `security_policies`
--

CREATE TABLE `security_policies` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `name` varchar(255) NOT NULL,
  `category` enum('rate_limiting','ip_filtering','validation','encryption','audit') NOT NULL,
  `description` text NOT NULL,
  `configuration` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin NOT NULL CHECK (json_valid(`configuration`)),
  `status` enum('active','inactive','testing') NOT NULL DEFAULT 'active',
  `priority` enum('low','medium','high','critical') NOT NULL DEFAULT 'medium',
  `targetEndpoints` varchar(255) DEFAULT NULL,
  `targetRoles` varchar(255) DEFAULT NULL,
  `effectiveFrom` timestamp NULL DEFAULT NULL,
  `effectiveTo` timestamp NULL DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `shared_whiteboards`
--

CREATE TABLE `shared_whiteboards` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `name` varchar(255) NOT NULL COMMENT 'Whiteboard name',
  `description` text DEFAULT NULL COMMENT 'Whiteboard description',
  `creatorId` varchar(36) NOT NULL COMMENT 'Whiteboard creator ID',
  `studyGroupId` varchar(36) DEFAULT NULL COMMENT 'Associated study group ID',
  `status` enum('active','archived','deleted') NOT NULL DEFAULT 'active' COMMENT 'Whiteboard status',
  `canvasWidth` int(11) NOT NULL DEFAULT 1920 COMMENT 'Canvas width',
  `canvasHeight` int(11) NOT NULL DEFAULT 1080 COMMENT 'Canvas height',
  `backgroundColor` varchar(10) NOT NULL DEFAULT '#FFFFFF' COMMENT 'Background color',
  `isLocked` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is whiteboard locked',
  `defaultPermission` enum('view_only','draw','edit','admin') NOT NULL DEFAULT 'draw' COMMENT 'Default permission for members',
  `canvasData` longtext DEFAULT NULL COMMENT 'Whiteboard data (JSON)',
  `thumbnailUrl` varchar(500) DEFAULT NULL COMMENT 'Thumbnail URL',
  `version` int(11) NOT NULL DEFAULT 0 COMMENT 'Version number',
  `lastEditedAt` timestamp NULL DEFAULT NULL COMMENT 'Last edit timestamp',
  `lastEditedBy` varchar(36) DEFAULT NULL COMMENT 'Last editor ID',
  `settings` longtext DEFAULT NULL COMMENT 'Whiteboard settings (JSON)',
  `permissions` longtext DEFAULT NULL COMMENT 'Access permissions (JSON)',
  `metadata` longtext DEFAULT NULL COMMENT 'Additional metadata (JSON)'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `student_profiles`
--

CREATE TABLE `student_profiles` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `userId` varchar(36) NOT NULL COMMENT 'Reference to user ID',
  `studentCode` varchar(20) NOT NULL COMMENT 'Unique student code/ID',
  `educationLevel` varchar(100) DEFAULT NULL COMMENT 'Current education level',
  `fieldOfStudy` varchar(255) DEFAULT NULL COMMENT 'Field of study or major',
  `institution` varchar(255) DEFAULT NULL COMMENT 'Institution or school name',
  `graduationYear` int(11) DEFAULT NULL COMMENT 'Expected graduation year',
  `gpa` decimal(3,2) DEFAULT NULL COMMENT 'Current GPA',
  `learningGoals` text DEFAULT NULL COMMENT 'Learning goals and objectives',
  `preferredLearningStyle` enum('visual','auditory','reading','kinesthetic') DEFAULT NULL COMMENT 'Preferred learning style',
  `studyTimePreference` varchar(255) DEFAULT NULL COMMENT 'Preferred study time',
  `difficultyPreference` enum('beginner','intermediate','advanced') NOT NULL DEFAULT 'beginner' COMMENT 'Preferred difficulty level',
  `motivationFactors` text DEFAULT NULL COMMENT 'Motivation factors',
  `totalCoursesEnrolled` int(11) NOT NULL DEFAULT 0 COMMENT 'Total courses enrolled',
  `totalCoursesCompleted` int(11) NOT NULL DEFAULT 0 COMMENT 'Total courses completed',
  `totalCertificates` int(11) NOT NULL DEFAULT 0 COMMENT 'Total certificates earned',
  `totalStudyHours` int(11) NOT NULL DEFAULT 0 COMMENT 'Total study hours',
  `averageGrade` decimal(5,2) NOT NULL DEFAULT 0.00 COMMENT 'Average course rating',
  `achievementPoints` int(11) NOT NULL DEFAULT 0 COMMENT 'Achievement points earned',
  `achievementLevel` varchar(50) NOT NULL DEFAULT 'Bronze' COMMENT 'Current achievement level',
  `badges` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Badges and achievements earned' CHECK (json_valid(`badges`)),
  `learningPreferences` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Learning preferences and settings' CHECK (json_valid(`learningPreferences`)),
  `studySchedule` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Study schedule and availability' CHECK (json_valid(`studySchedule`)),
  `analyticsData` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Learning analytics data' CHECK (json_valid(`analyticsData`)),
  `enableAIRecommendations` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Allow AI recommendations',
  `enableProgressTracking` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Allow progress tracking',
  `parentalConsent` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Parent/guardian consent for minors',
  `parentContact` varchar(255) DEFAULT NULL COMMENT 'Parent/guardian contact information',
  `enrollmentDate` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'Student enrollment date',
  `lastActivityAt` timestamp NULL DEFAULT NULL COMMENT 'Last activity timestamp',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional student metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `study_groups`
--

CREATE TABLE `study_groups` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `name` varchar(255) NOT NULL COMMENT 'Study group name',
  `description` text DEFAULT NULL COMMENT 'Study group description',
  `type` enum('course_based','topic_based','project_based','skill_based','exam_prep','general') NOT NULL DEFAULT 'general' COMMENT 'Type of study group',
  `status` enum('open','closed','full','archived','suspended') NOT NULL DEFAULT 'open' COMMENT 'Study group status',
  `creatorId` varchar(36) NOT NULL COMMENT 'Study group creator ID',
  `courseId` varchar(36) DEFAULT NULL COMMENT 'Associated course ID',
  `avatarUrl` varchar(500) DEFAULT NULL COMMENT 'Study group avatar URL',
  `inviteCode` varchar(20) DEFAULT NULL COMMENT 'Study group invite code',
  `maxMembers` int(11) NOT NULL DEFAULT 20 COMMENT 'Maximum number of members',
  `memberCount` int(11) NOT NULL DEFAULT 0 COMMENT 'Current member count',
  `isPrivate` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is group private',
  `requiresApproval` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Requires approval to join',
  `tags` longtext DEFAULT NULL COMMENT 'Study group tags (JSON)',
  `schedule` longtext DEFAULT NULL COMMENT 'Study schedule (JSON)',
  `goals` longtext DEFAULT NULL COMMENT 'Group goals and objectives (JSON)',
  `rules` longtext DEFAULT NULL COMMENT 'Group rules and guidelines (JSON)',
  `settings` longtext DEFAULT NULL COMMENT 'Group settings (JSON)',
  `statistics` longtext DEFAULT NULL COMMENT 'Group statistics (JSON)',
  `lastActivityAt` timestamp NULL DEFAULT NULL COMMENT 'Last activity timestamp',
  `archivedAt` timestamp NULL DEFAULT NULL COMMENT 'Group archive date',
  `metadata` longtext DEFAULT NULL COMMENT 'Additional metadata (JSON)'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `study_group_members`
--

CREATE TABLE `study_group_members` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `studyGroupId` varchar(36) NOT NULL COMMENT 'Study group ID',
  `userId` varchar(36) NOT NULL COMMENT 'User ID',
  `role` enum('owner','moderator','member','guest') NOT NULL DEFAULT 'member' COMMENT 'Member role in study group',
  `status` enum('active','inactive','banned','pending') NOT NULL DEFAULT 'active' COMMENT 'Member status',
  `joinedAt` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'Join timestamp',
  `leftAt` timestamp NULL DEFAULT NULL COMMENT 'Leave timestamp',
  `lastActiveAt` timestamp NULL DEFAULT NULL COMMENT 'Last activity timestamp',
  `contributionScore` int(11) NOT NULL DEFAULT 0 COMMENT 'Contribution score',
  `nickname` varchar(255) DEFAULT NULL COMMENT 'Member nickname in group',
  `bio` text DEFAULT NULL COMMENT 'Member bio in group',
  `preferences` longtext DEFAULT NULL COMMENT 'Member preferences (JSON)',
  `statistics` longtext DEFAULT NULL COMMENT 'Member statistics (JSON)',
  `metadata` longtext DEFAULT NULL COMMENT 'Additional metadata (JSON)'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `system_settings`
--

CREATE TABLE `system_settings` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `key` varchar(255) NOT NULL COMMENT 'Setting key identifier',
  `name` varchar(255) NOT NULL COMMENT 'Human-readable setting name',
  `description` text DEFAULT NULL COMMENT 'Setting description',
  `category` enum('general','security','email','notifications','integrations','appearance','learning','assessment','communication','analytics','ai','storage','performance','compliance') NOT NULL COMMENT 'Setting category',
  `type` enum('string','text','number','integer','boolean','email','url','json','array','date','time','color','file') NOT NULL COMMENT 'Data type of the setting',
  `value` text NOT NULL COMMENT 'Setting value (stored as string)',
  `defaultValue` text DEFAULT NULL COMMENT 'Default value',
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Whether setting is active',
  `isPublic` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether setting is public (visible to frontend)',
  `isReadOnly` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether setting is read-only',
  `isEncrypted` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether setting is encrypted',
  `validationRules` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Validation rules for the setting' CHECK (json_valid(`validationRules`)),
  `uiConfig` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'UI configuration for setting display' CHECK (json_valid(`uiConfig`)),
  `dependencies` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Dependencies on other settings' CHECK (json_valid(`dependencies`)),
  `lastModifiedBy` varchar(36) DEFAULT NULL COMMENT 'User who last modified the setting',
  `lastModifiedAt` timestamp NULL DEFAULT NULL COMMENT 'When setting was last modified',
  `valueHistory` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Value history for audit trail' CHECK (json_valid(`valueHistory`)),
  `environmentOverrides` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Environment-specific overrides' CHECK (json_valid(`environmentOverrides`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional setting metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `teacher_profiles`
--

CREATE TABLE `teacher_profiles` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `userId` varchar(36) NOT NULL COMMENT 'Reference to user ID',
  `teacherCode` varchar(20) NOT NULL COMMENT 'Unique teacher code/ID',
  `specializations` text DEFAULT NULL COMMENT 'Teacher specializations and expertise',
  `qualifications` text DEFAULT NULL COMMENT 'Educational qualifications',
  `yearsExperience` int(11) NOT NULL DEFAULT 0 COMMENT 'Years of teaching experience',
  `teachingStyle` text DEFAULT NULL COMMENT 'Teaching style and methodology',
  `officeHours` varchar(255) DEFAULT NULL COMMENT 'Office hours schedule',
  `rating` decimal(3,2) NOT NULL DEFAULT 0.00 COMMENT 'Average rating from students',
  `totalRatings` int(11) NOT NULL DEFAULT 0 COMMENT 'Total number of ratings',
  `totalStudents` int(11) NOT NULL DEFAULT 0 COMMENT 'Total number of students taught',
  `totalCourses` int(11) NOT NULL DEFAULT 0 COMMENT 'Total courses created',
  `totalLessons` int(11) NOT NULL DEFAULT 0 COMMENT 'Total lessons created',
  `totalTeachingHours` int(11) NOT NULL DEFAULT 0 COMMENT 'Total teaching hours',
  `totalEarnings` decimal(10,2) NOT NULL DEFAULT 0.00 COMMENT 'Total earnings from courses',
  `isApproved` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Teacher approval status',
  `isActive` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Teacher active status',
  `isFeatured` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Featured teacher status',
  `isVerified` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Verified teacher badge',
  `approvedBy` varchar(36) DEFAULT NULL COMMENT 'Who approved the teacher',
  `approvedAt` timestamp NULL DEFAULT NULL COMMENT 'When teacher was approved',
  `approvalNotes` text DEFAULT NULL COMMENT 'Approval notes or comments',
  `licenseNumber` varchar(255) DEFAULT NULL COMMENT 'Teaching license or certification number',
  `affiliations` varchar(255) DEFAULT NULL COMMENT 'Educational institution affiliations',
  `subjects` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Teaching subjects and topics' CHECK (json_valid(`subjects`)),
  `teachingLanguages` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Languages teacher can instruct in' CHECK (json_valid(`teachingLanguages`)),
  `availability` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Available time slots for teaching' CHECK (json_valid(`availability`)),
  `hourlyRate` decimal(8,2) DEFAULT NULL COMMENT 'Hourly rate for private sessions',
  `currency` varchar(3) NOT NULL DEFAULT 'USD' COMMENT 'Currency for pricing',
  `awards` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Awards and recognitions' CHECK (json_valid(`awards`)),
  `publications` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Publications and research work' CHECK (json_valid(`publications`)),
  `professionalSummary` text DEFAULT NULL COMMENT 'Professional summary',
  `resumeUrl` varchar(500) DEFAULT NULL COMMENT 'CV/Resume document URL',
  `portfolioUrl` varchar(500) DEFAULT NULL COMMENT 'Portfolio or demo reel URL',
  `acceptingStudents` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Accept new students',
  `maxStudentsPerClass` int(11) DEFAULT NULL COMMENT 'Maximum students per class',
  `allowReviews` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Allow students to rate and review',
  `emailNotifications` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Receive email notifications',
  `applicationDate` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'Teacher application date',
  `lastTeachingAt` timestamp NULL DEFAULT NULL COMMENT 'Last teaching activity',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional teacher metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `tutoring_interactions`
--

CREATE TABLE `tutoring_interactions` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `sessionId` varchar(36) NOT NULL,
  `interactionType` enum('question','hint_request','clarification','feedback_request','concept_explanation','problem_solving','assessment_answer','exploration','help_seeking') NOT NULL,
  `userInput` text NOT NULL,
  `aiResponse` text NOT NULL,
  `responseType` enum('direct_answer','socratic_question','hint','explanation','example','analogy','encouragement','redirection','assessment') NOT NULL,
  `responseTime` int(11) NOT NULL DEFAULT 0,
  `wasHelpful` tinyint(4) NOT NULL DEFAULT 0,
  `isCorrectAnswer` tinyint(4) NOT NULL DEFAULT 0,
  `hintLevel` int(11) NOT NULL DEFAULT 0,
  `topicCovered` varchar(100) DEFAULT NULL,
  `difficultyLevel` varchar(50) DEFAULT NULL,
  `confidenceScore` decimal(5,2) DEFAULT NULL,
  `contextData` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`contextData`)),
  `adaptationTriggers` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`adaptationTriggers`)),
  `feedback` text DEFAULT NULL,
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `tutoring_sessions`
--

CREATE TABLE `tutoring_sessions` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `studentId` varchar(36) NOT NULL,
  `courseId` varchar(36) DEFAULT NULL,
  `lessonId` varchar(36) DEFAULT NULL,
  `mode` enum('adaptive','guided','exploratory','assessment','remediation','enrichment') NOT NULL DEFAULT 'adaptive',
  `status` enum('active','paused','completed','abandoned','error') NOT NULL DEFAULT 'active',
  `startedAt` timestamp NOT NULL DEFAULT current_timestamp(),
  `endedAt` timestamp NULL DEFAULT NULL,
  `totalDuration` int(11) NOT NULL DEFAULT 0,
  `questionsAsked` int(11) NOT NULL DEFAULT 0,
  `hintsProvided` int(11) NOT NULL DEFAULT 0,
  `completionPercentage` decimal(5,2) NOT NULL DEFAULT 0.00,
  `detectedLearningStyle` enum('visual','auditory','kinesthetic','reading_writing','multimodal','balanced','unknown') DEFAULT NULL,
  `currentDifficultyLevel` varchar(50) NOT NULL DEFAULT 'beginner',
  `sessionGoals` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`sessionGoals`)),
  `adaptiveSettings` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`adaptiveSettings`)),
  `learningPath` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`learningPath`)),
  `performanceMetrics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`performanceMetrics`)),
  `sessionSummary` text DEFAULT NULL,
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `users`
--

CREATE TABLE `users` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `email` varchar(255) NOT NULL COMMENT 'User email address',
  `username` varchar(50) NOT NULL COMMENT 'Unique username',
  `passwordHash` varchar(255) NOT NULL COMMENT 'Hashed password',
  `firstName` varchar(100) DEFAULT NULL COMMENT 'First name',
  `lastName` varchar(100) DEFAULT NULL COMMENT 'Last name',
  `displayName` varchar(150) DEFAULT NULL COMMENT 'Display name or alias',
  `phone` varchar(20) DEFAULT NULL COMMENT 'Phone number',
  `userType` enum('student','teacher','admin') NOT NULL DEFAULT 'student' COMMENT 'User type/role',
  `status` enum('pending','active','inactive','suspended','banned','deleted') NOT NULL DEFAULT 'pending' COMMENT 'Account status',
  `avatarUrl` varchar(500) DEFAULT NULL COMMENT 'Profile avatar URL',
  `coverUrl` varchar(500) DEFAULT NULL COMMENT 'Profile cover image URL',
  `emailVerified` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Email verification status',
  `emailVerificationToken` varchar(255) DEFAULT NULL COMMENT 'Email verification token',
  `emailVerificationExpiry` timestamp NULL DEFAULT NULL COMMENT 'Email verification token expiry',
  `twoFactorEnabled` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Two-factor authentication enabled',
  `twoFactorSecret` varchar(255) DEFAULT NULL COMMENT 'Two-factor authentication secret',
  `backupCodes` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Two-factor backup codes' CHECK (json_valid(`backupCodes`)),
  `passwordResetToken` varchar(255) DEFAULT NULL COMMENT 'Password reset token',
  `passwordResetExpiry` timestamp NULL DEFAULT NULL COMMENT 'Password reset token expiry',
  `passwordChangedAt` timestamp NULL DEFAULT NULL COMMENT 'When password was last changed',
  `lastLoginAt` timestamp NULL DEFAULT NULL COMMENT 'Last login timestamp',
  `lastLoginIp` varchar(45) DEFAULT NULL COMMENT 'Last login IP address',
  `failedLoginAttempts` int(11) NOT NULL DEFAULT 0 COMMENT 'Failed login attempts count',
  `lockedUntil` timestamp NULL DEFAULT NULL COMMENT 'Account locked until timestamp',
  `refreshTokens` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Active refresh tokens' CHECK (json_valid(`refreshTokens`)),
  `preferredLanguage` varchar(10) DEFAULT NULL COMMENT 'Preferred language code',
  `timezone` varchar(50) DEFAULT NULL COMMENT 'Timezone identifier',
  `preferences` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'User preferences and settings' CHECK (json_valid(`preferences`)),
  `metadata` longtext DEFAULT NULL COMMENT 'User metadata'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `user_permissions`
--

CREATE TABLE `user_permissions` (
  `user_id` varchar(36) NOT NULL,
  `permission_id` varchar(36) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `user_presence`
--

CREATE TABLE `user_presence` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `userId` varchar(36) NOT NULL COMMENT 'User ID',
  `status` enum('online','offline','away','busy','do_not_disturb','invisible') NOT NULL DEFAULT 'offline' COMMENT 'Current presence status',
  `activityStatus` enum('studying','in_lesson','taking_quiz','in_chat','in_video_call','idle','browsing') NOT NULL DEFAULT 'idle' COMMENT 'Current activity status',
  `isOnline` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether user is currently online',
  `lastSeenAt` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'Last time user was seen online',
  `onlineAt` timestamp NULL DEFAULT NULL COMMENT 'When user came online',
  `statusMessage` varchar(255) DEFAULT NULL COMMENT 'Custom status message',
  `currentCourseId` varchar(36) DEFAULT NULL COMMENT 'Current course user is in',
  `currentLessonId` varchar(36) DEFAULT NULL COMMENT 'Current lesson user is viewing',
  `currentChatRoomId` varchar(36) DEFAULT NULL COMMENT 'Current chat room user is in',
  `currentVideoSessionId` varchar(36) DEFAULT NULL COMMENT 'Current video session user is in',
  `deviceInfo` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Device information' CHECK (json_valid(`deviceInfo`)),
  `locationInfo` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Location information' CHECK (json_valid(`locationInfo`)),
  `activityDetails` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Current activity details' CHECK (json_valid(`activityDetails`)),
  `sessionDuration` int(11) NOT NULL DEFAULT 0 COMMENT 'Total session duration in seconds',
  `pageViews` int(11) NOT NULL DEFAULT 0 COMMENT 'Number of pages/screens viewed in session',
  `interactionCount` int(11) NOT NULL DEFAULT 0 COMMENT 'User interaction count in current session',
  `lastActivityAt` timestamp NULL DEFAULT NULL COMMENT 'Last activity timestamp',
  `connections` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Active socket connections' CHECK (json_valid(`connections`)),
  `preferences` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Presence preferences' CHECK (json_valid(`preferences`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `user_profiles`
--

CREATE TABLE `user_profiles` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `userId` varchar(36) NOT NULL COMMENT 'Reference to user ID',
  `bio` text DEFAULT NULL COMMENT 'User biography',
  `dateOfBirth` date DEFAULT NULL COMMENT 'Date of birth',
  `gender` enum('male','female','other','prefer_not_to_say') DEFAULT NULL COMMENT 'Gender',
  `address` text DEFAULT NULL COMMENT 'Full address',
  `countryCode` varchar(3) DEFAULT NULL COMMENT 'ISO country code',
  `country` varchar(100) DEFAULT NULL COMMENT 'Country name',
  `state` varchar(100) DEFAULT NULL COMMENT 'State or province',
  `city` varchar(100) DEFAULT NULL COMMENT 'City name',
  `cityCode` varchar(20) DEFAULT NULL COMMENT 'City code or identifier',
  `postalCode` varchar(20) DEFAULT NULL COMMENT 'Postal or ZIP code',
  `organization` varchar(255) DEFAULT NULL COMMENT 'Organization or company',
  `jobTitle` varchar(255) DEFAULT NULL COMMENT 'Job title or position',
  `department` varchar(255) DEFAULT NULL COMMENT 'Department or division',
  `website` varchar(500) DEFAULT NULL COMMENT 'Personal website URL',
  `interests` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional interests' CHECK (json_valid(`interests`)),
  `skills` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Skills and competencies' CHECK (json_valid(`skills`)),
  `hobbies` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Hobbies and personal interests' CHECK (json_valid(`hobbies`)),
  `isPublic` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Profile visibility to other users',
  `isSearchable` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Allow other users to search this profile',
  `isVerified` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Profile verification status',
  `verifiedAt` timestamp NULL DEFAULT NULL COMMENT 'When profile was verified',
  `verifiedBy` varchar(36) DEFAULT NULL COMMENT 'Who verified the profile',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional profile metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `user_roles`
--

CREATE TABLE `user_roles` (
  `user_id` varchar(36) NOT NULL,
  `role_id` varchar(36) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `user_socials`
--

CREATE TABLE `user_socials` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `userId` varchar(36) NOT NULL COMMENT 'Reference to user ID',
  `platform` enum('facebook','twitter','linkedin','instagram','youtube','github','personal_website') NOT NULL COMMENT 'Social media platform',
  `url` varchar(500) NOT NULL COMMENT 'Profile URL',
  `handle` varchar(100) DEFAULT NULL COMMENT 'Username or handle on the platform',
  `displayName` varchar(100) DEFAULT NULL COMMENT 'Display name on the platform',
  `isPublic` tinyint(4) NOT NULL DEFAULT 1 COMMENT 'Whether this social link is public',
  `isVerified` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether this social account is verified',
  `displayOrder` int(11) NOT NULL DEFAULT 0 COMMENT 'Order for displaying social links',
  `customLabel` varchar(255) DEFAULT NULL COMMENT 'Custom label for the social link',
  `description` text DEFAULT NULL COMMENT 'Description or note about this social link',
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional platform-specific metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `video_participants`
--

CREATE TABLE `video_participants` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `sessionId` varchar(36) NOT NULL COMMENT 'Video session ID',
  `userId` varchar(36) NOT NULL COMMENT 'User ID',
  `role` enum('owner','admin','moderator','member','guest','attendee','presenter','co_host','host') NOT NULL DEFAULT 'attendee' COMMENT 'Role of participant in session',
  `connectionStatus` enum('connected','connecting','disconnected','reconnecting','failed') NOT NULL DEFAULT 'connected' COMMENT 'Current connection status',
  `joinedAt` timestamp NOT NULL DEFAULT current_timestamp() COMMENT 'When participant joined',
  `leftAt` timestamp NULL DEFAULT NULL COMMENT 'When participant left',
  `duration` int(11) DEFAULT NULL COMMENT 'Total duration in session (seconds)',
  `isMuted` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether participant audio is muted',
  `videoDisabled` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether participant video is disabled',
  `isScreenSharing` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether participant is sharing screen',
  `handRaised` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether participant hand is raised',
  `handRaisedAt` timestamp NULL DEFAULT NULL COMMENT 'When hand was raised',
  `inWaitingRoom` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether participant is in waiting room',
  `breakoutRoomId` varchar(36) DEFAULT NULL COMMENT 'Current breakout room ID',
  `displayName` varchar(255) DEFAULT NULL COMMENT 'Display name in session',
  `avatarUrl` varchar(500) DEFAULT NULL COMMENT 'Avatar URL for session',
  `deviceInfo` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Device and browser information' CHECK (json_valid(`deviceInfo`)),
  `connectionQuality` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Connection quality metrics' CHECK (json_valid(`connectionQuality`)),
  `permissions` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Participant permissions' CHECK (json_valid(`permissions`)),
  `engagementMetrics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Engagement metrics' CHECK (json_valid(`engagementMetrics`)),
  `activitiesLog` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Session activities log' CHECK (json_valid(`activitiesLog`)),
  `technicalIssues` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Technical issues encountered' CHECK (json_valid(`technicalIssues`)),
  `feedback` text DEFAULT NULL COMMENT 'Participant feedback about session',
  `rating` decimal(3,2) DEFAULT NULL COMMENT 'Session rating (1.0 - 5.0)',
  `exitSurvey` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Exit survey responses' CHECK (json_valid(`exitSurvey`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional participant metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `video_sessions`
--

CREATE TABLE `video_sessions` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `title` varchar(255) NOT NULL COMMENT 'Session title',
  `description` text DEFAULT NULL COMMENT 'Session description',
  `hostId` varchar(36) NOT NULL COMMENT 'Session host user ID',
  `courseId` varchar(36) DEFAULT NULL COMMENT 'Related course ID',
  `lessonId` varchar(36) DEFAULT NULL COMMENT 'Related lesson ID',
  `sessionType` enum('meeting','webinar','lecture','tutorial','office_hours','study_group','exam','workshop') NOT NULL DEFAULT 'meeting' COMMENT 'Type of video session',
  `status` enum('scheduled','live','completed','cancelled','postponed','failed') NOT NULL DEFAULT 'scheduled' COMMENT 'Current session status',
  `scheduledStart` timestamp NULL DEFAULT NULL COMMENT 'Scheduled start time',
  `scheduledEnd` timestamp NULL DEFAULT NULL COMMENT 'Scheduled end time',
  `actualStart` timestamp NULL DEFAULT NULL COMMENT 'Actual start time',
  `actualEnd` timestamp NULL DEFAULT NULL COMMENT 'Actual end time',
  `maxParticipants` int(11) DEFAULT NULL COMMENT 'Maximum number of participants',
  `currentParticipants` int(11) NOT NULL DEFAULT 0 COMMENT 'Current number of participants',
  `totalParticipants` int(11) NOT NULL DEFAULT 0 COMMENT 'Total participants who joined',
  `provider` enum('webrtc','zoom','teams','meet','jitsi','bigbluebutton','custom') NOT NULL DEFAULT 'webrtc' COMMENT 'Video provider/platform',
  `meetingUrl` varchar(500) DEFAULT NULL COMMENT 'Meeting URL for participants',
  `meetingId` varchar(255) DEFAULT NULL COMMENT 'External meeting ID (Zoom, Teams, etc.)',
  `passcode` varchar(255) DEFAULT NULL COMMENT 'Meeting passcode/password',
  `dialInInfo` text DEFAULT NULL COMMENT 'Dial-in information',
  `isRecording` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether session is being recorded',
  `recordingUrl` varchar(500) DEFAULT NULL COMMENT 'Recording URL',
  `recordingDuration` int(11) DEFAULT NULL COMMENT 'Recording duration in seconds',
  `recordingSize` int(11) DEFAULT NULL COMMENT 'Recording file size in bytes',
  `requiresRegistration` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether session requires registration',
  `waitingRoomEnabled` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Whether waiting room is enabled',
  `settings` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Session settings and features' CHECK (json_valid(`settings`)),
  `securitySettings` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Security and access control settings' CHECK (json_valid(`securitySettings`)),
  `breakoutRooms` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Breakout rooms configuration' CHECK (json_valid(`breakoutRooms`)),
  `polls` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Polling data' CHECK (json_valid(`polls`)),
  `analytics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Session analytics and metrics' CHECK (json_valid(`analytics`)),
  `qualityMetrics` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Technical quality metrics' CHECK (json_valid(`qualityMetrics`)),
  `agenda` text DEFAULT NULL COMMENT 'Session agenda',
  `notes` text DEFAULT NULL COMMENT 'Session notes',
  `summary` text DEFAULT NULL COMMENT 'Session summary',
  `followUpActions` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Follow-up actions' CHECK (json_valid(`followUpActions`)),
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL COMMENT 'Additional session metadata' CHECK (json_valid(`metadata`))
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `whiteboard_elements`
--

CREATE TABLE `whiteboard_elements` (
  `id` varchar(36) NOT NULL,
  `createdAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6),
  `updatedAt` timestamp(6) NOT NULL DEFAULT current_timestamp(6) ON UPDATE current_timestamp(6),
  `deletedAt` timestamp(6) NULL DEFAULT NULL,
  `createdBy` varchar(36) DEFAULT NULL COMMENT 'User ID who created this record',
  `updatedBy` varchar(36) DEFAULT NULL COMMENT 'User ID who last updated this record',
  `whiteboardId` varchar(36) NOT NULL COMMENT 'Whiteboard ID',
  `creatorId` varchar(36) NOT NULL COMMENT 'Element creator ID',
  `type` enum('pen','pencil','highlighter','eraser','text','shape','image','sticky_note') NOT NULL COMMENT 'Element type',
  `elementData` longtext NOT NULL COMMENT 'Element data (JSON)',
  `x` decimal(10,2) NOT NULL COMMENT 'X coordinate',
  `y` decimal(10,2) NOT NULL COMMENT 'Y coordinate',
  `width` decimal(10,2) DEFAULT NULL COMMENT 'Element width',
  `height` decimal(10,2) DEFAULT NULL COMMENT 'Element height',
  `rotation` decimal(5,2) NOT NULL DEFAULT 0.00 COMMENT 'Element rotation',
  `zIndex` int(11) NOT NULL DEFAULT 1 COMMENT 'Z-index for layering',
  `color` varchar(10) DEFAULT NULL COMMENT 'Element color',
  `strokeWidth` int(11) DEFAULT NULL COMMENT 'Stroke width',
  `opacity` decimal(3,2) NOT NULL DEFAULT 1.00 COMMENT 'Element opacity',
  `isLocked` tinyint(4) NOT NULL DEFAULT 0 COMMENT 'Is element locked',
  `metadata` longtext DEFAULT NULL COMMENT 'Additional metadata (JSON)'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Indexes for dumped tables
--

--
-- Indexes for table `ab_tests`
--
ALTER TABLE `ab_tests`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_510ea5d2be7e5d57846b144ba6` (`endDate`),
  ADD KEY `IDX_d3e0d1a8415cac4c1cc252a612` (`startDate`),
  ADD KEY `IDX_ba2a59be8a129604f80f2821e4` (`status`),
  ADD KEY `IDX_6afd9d685b6682d388d60ca69f` (`name`),
  ADD KEY `FK_dce12ca58031537ffaa5c9ace8e` (`controlModelId`),
  ADD KEY `FK_76b8fa96bba762a4b63b0e3bd06` (`testModelId`);

--
-- Indexes for table `ab_test_results`
--
ALTER TABLE `ab_test_results`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_8880688b768a5d05a3e1a99fe3` (`createdAt`),
  ADD KEY `IDX_0c111187fc824b263e89dcc135` (`modelVariant`),
  ADD KEY `IDX_78c8dffa224f024a675a0b323b` (`userId`),
  ADD KEY `IDX_80454f06144cac8e4a5c433205` (`testId`);

--
-- Indexes for table `activity_feeds`
--
ALTER TABLE `activity_feeds`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_7569c187afea9cc04467acf418` (`groupId`),
  ADD KEY `IDX_d3e03837fb998697d9ab2d30fc` (`courseId`),
  ADD KEY `IDX_219ce1fa067aa988e945605641` (`isVisible`),
  ADD KEY `IDX_7bdcb32aaa04aced9d33d1b150` (`createdAt`),
  ADD KEY `IDX_8e9c96a9e8a4aaad3bde5f11e2` (`visibility`),
  ADD KEY `IDX_9353e1b1b1a1adae3dcdec0a6d` (`activityType`),
  ADD KEY `IDX_91a203896bab1540948e25fe85` (`userId`);

--
-- Indexes for table `adaptive_content`
--
ALTER TABLE `adaptive_content`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_5aaf10ad0fa73b8cce2c98ea98` (`contentType`,`isActive`),
  ADD KEY `IDX_2bb7fdb380e799275212c97bfe` (`courseId`,`difficultyLevel`),
  ADD KEY `FK_2304d3a511d1795ba0115318373` (`lessonId`);

--
-- Indexes for table `ai_recommendations`
--
ALTER TABLE `ai_recommendations`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_8b3d109504cd18920d6ba1cf4d` (`createdAt`),
  ADD KEY `IDX_6bbe0d6bac4509d9409bf3bb16` (`confidenceScore`),
  ADD KEY `IDX_4906338ed4d56203d5c8c3b015` (`expiresAt`),
  ADD KEY `IDX_fdd75017e180cb13b5c7d6894d` (`priority`),
  ADD KEY `IDX_3d7d671a386763a51ded823154` (`status`),
  ADD KEY `IDX_51f240c4ce54652644ac0f0caf` (`recommendationType`),
  ADD KEY `IDX_c6da1a79c7f10bafd853276a6f` (`studentId`);

--
-- Indexes for table `api_keys`
--
ALTER TABLE `api_keys`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_77f7a9b697f8eb7e838c70a612` (`status`,`expiresAt`),
  ADD KEY `IDX_6c2e267ae764a9413b863a2934` (`userId`),
  ADD KEY `IDX_e42cf55faeafdcce01a82d2484` (`key`);

--
-- Indexes for table `assessments`
--
ALTER TABLE `assessments`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_7cae243a5342985484ddc76daa` (`availableFrom`,`availableUntil`),
  ADD KEY `FK_efabccbe7bbaebe3209fe3e5785` (`courseId`),
  ADD KEY `FK_c0c858dfd225249fe292a2319e9` (`lessonId`),
  ADD KEY `FK_9c678788c729af235b440f7999b` (`teacherId`);

--
-- Indexes for table `assessment_attempts`
--
ALTER TABLE `assessment_attempts`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_987719eb66ab4a2ac5f8be8b78` (`gradingStatus`,`submittedAt`),
  ADD KEY `IDX_122a07f99d1c0fccca83c30436` (`startedAt`),
  ADD KEY `IDX_892b136f93df5fd940e59468b5` (`status`),
  ADD KEY `IDX_eafb7dca4f7345a9e681a15e2b` (`attemptNumber`),
  ADD KEY `FK_72f05778ab3b0e36266a4ab55e7` (`studentId`),
  ADD KEY `FK_e2ccc71e44abf94340bbfdc1007` (`assessmentId`),
  ADD KEY `FK_ffdcf76a9106cb2771767166645` (`gradedBy`);

--
-- Indexes for table `assessment_sessions`
--
ALTER TABLE `assessment_sessions`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_8d4e282197a62fc56015de6abc` (`sessionToken`),
  ADD KEY `IDX_c50d192d2bc0dcdec2cb242a7f` (`expiresAt`),
  ADD KEY `FK_7a78035a0da202178018f0cb595` (`studentId`),
  ADD KEY `FK_863c813fdc84a3c0face7661291` (`assessmentId`),
  ADD KEY `FK_362e4b954c6733e2f8364c360c4` (`attemptId`);

--
-- Indexes for table `assignments`
--
ALTER TABLE `assignments`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_ce6063ba9705d8ce937dfee002` (`status`),
  ADD KEY `IDX_e6d17420638d8d432b3a20c0ea` (`dueDate`),
  ADD KEY `IDX_855166a85e826bc52d290aed45` (`instructorId`),
  ADD KEY `IDX_9e5684667ea189ade0fc79fa4f` (`courseId`);

--
-- Indexes for table `audit_logs`
--
ALTER TABLE `audit_logs`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_dd2b6e43c767b6b5b2bb227ace` (`sessionId`),
  ADD KEY `IDX_8ddc86298ac7fadad468b28d83` (`ipAddress`),
  ADD KEY `IDX_88dcc148d532384790ab874c3d` (`timestamp`),
  ADD KEY `IDX_2961862b2704794af56359ff0a` (`status`),
  ADD KEY `IDX_76566a7a3b90863650d467bff6` (`level`),
  ADD KEY `IDX_f23279fad63453147a8efb46cf` (`entityId`),
  ADD KEY `IDX_01993ae76b293d3b866cc3a125` (`entityType`),
  ADD KEY `IDX_cee5459245f652b75eb2759b4c` (`action`),
  ADD KEY `IDX_cfa83f61e4d27a87fcae1e025a` (`userId`),
  ADD KEY `FK_4423ab967bf3197ce632737302d` (`reviewedBy`);

--
-- Indexes for table `categories`
--
ALTER TABLE `categories`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_420d9f679d41281f282f5bc7d0` (`slug`),
  ADD KEY `IDX_db43047fcc9324b6acbea627d9` (`level`),
  ADD KEY `IDX_9c4371a1549ef5af18035cc763` (`isActive`,`orderIndex`),
  ADD KEY `IDX_9a6f051e66982b5f0318981bca` (`parentId`);

--
-- Indexes for table `chatbot_conversations`
--
ALTER TABLE `chatbot_conversations`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_a6bfe51393142360c4044c271f` (`isActive`),
  ADD KEY `IDX_52b2d647524a83feae99772ced` (`endedAt`),
  ADD KEY `IDX_7f19a2e46e7bad83c1c01a204f` (`startedAt`),
  ADD KEY `IDX_b22a30593fe0b33032c82abf37` (`conversationType`),
  ADD KEY `IDX_0d591b23d1c367de985d8ba015` (`status`),
  ADD KEY `IDX_51f87316fa3406e057834982da` (`courseId`),
  ADD KEY `IDX_adf39cd2a4d9c3535283bcdeaa` (`userId`);

--
-- Indexes for table `chatbot_messages`
--
ALTER TABLE `chatbot_messages`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_27bc2920ca7ccf593b87275ff6` (`isImportant`),
  ADD KEY `IDX_3a60140fba4d453094c26ec786` (`timestamp`),
  ADD KEY `IDX_308c319d53dd23ba4a60ec7b54` (`status`),
  ADD KEY `IDX_d623f754eb2c2c7da9f75037a9` (`messageType`),
  ADD KEY `IDX_31269d81bec0492e6bab4c8c99` (`sender`),
  ADD KEY `IDX_0601c16bacb7287fa869ea4d15` (`conversationId`);

--
-- Indexes for table `chat_files`
--
ALTER TABLE `chat_files`
  ADD PRIMARY KEY (`id`),
  ADD KEY `FK_ea9c9ae1f173ad90c9a4d15d2a7` (`messageId`),
  ADD KEY `FK_11ad00e9530b655427076fa8f94` (`uploadedBy`);

--
-- Indexes for table `chat_messages`
--
ALTER TABLE `chat_messages`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_90b8a3ff4993479eae72140b08` (`isPinned`),
  ADD KEY `IDX_4679d5fba2a68ff3be1caec358` (`isDeleted`),
  ADD KEY `IDX_34965c966a02654c53490e445a` (`isEdited`),
  ADD KEY `IDX_a6f359922fb93e42d1b2daf38d` (`createdAt`),
  ADD KEY `IDX_c70893369be5d9fd3b99d895d1` (`parentMessageId`),
  ADD KEY `IDX_56a790ed62e868f2e0c5f81115` (`status`),
  ADD KEY `IDX_4198580e229855f627337c3b45` (`messageType`),
  ADD KEY `IDX_fc6b58e41e9a871dacbe9077de` (`senderId`),
  ADD KEY `IDX_9fa0373c1451ad384fc6a74aa8` (`roomId`);

--
-- Indexes for table `chat_message_reactions`
--
ALTER TABLE `chat_message_reactions`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_5ba0b3b9cea0e147676fe240fb` (`messageId`,`userId`,`emoji`),
  ADD KEY `FK_fb41ef3d282a5ccda057f0c856f` (`userId`);

--
-- Indexes for table `chat_message_threads`
--
ALTER TABLE `chat_message_threads`
  ADD PRIMARY KEY (`id`),
  ADD KEY `FK_396a68712afbdf78f4188715366` (`parentMessageId`),
  ADD KEY `FK_94d3d048ba78a60bfa26622dd74` (`createdBy`);

--
-- Indexes for table `chat_moderation`
--
ALTER TABLE `chat_moderation`
  ADD PRIMARY KEY (`id`),
  ADD KEY `FK_b55e37ef88d2011d86bb685ef54` (`messageId`),
  ADD KEY `FK_b4029f667163b8788a36f5bbd49` (`roomId`),
  ADD KEY `FK_471159ec0d5047d8af4f1b173b2` (`targetUserId`),
  ADD KEY `FK_25b57ec78e91ae748684cbd95ed` (`moderatorId`);

--
-- Indexes for table `chat_participants`
--
ALTER TABLE `chat_participants`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_fc0fec641d5e9060a9b182f5c5` (`roomId`,`userId`),
  ADD KEY `IDX_09d9bfb52b1301a2fce6c8e465` (`lastRead`),
  ADD KEY `IDX_fe8a15d7e9d8d3c54b9bb00baf` (`joinedAt`),
  ADD KEY `IDX_891f56fd71c7d96bc701987b46` (`status`),
  ADD KEY `IDX_fcf3b019ec4b80fc9282d4088a` (`role`),
  ADD KEY `IDX_fb6add83b1a7acc94433d38569` (`userId`),
  ADD KEY `IDX_6be6922a86211449f6f74f5078` (`roomId`);

--
-- Indexes for table `chat_rooms`
--
ALTER TABLE `chat_rooms`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_627bf864a80bcdb00cbe831163` (`createdAt`),
  ADD KEY `IDX_5a326c60d951928eb53316e7d4` (`isActive`),
  ADD KEY `IDX_618bae345ad346eddc52fa8c8e` (`createdBy`),
  ADD KEY `IDX_c15d1caf3db4708f5308370983` (`lessonId`),
  ADD KEY `IDX_287cc180e79f2532f1ca2b65de` (`courseId`),
  ADD KEY `IDX_aeb16cde4038319476629da457` (`status`),
  ADD KEY `IDX_8e51cac1a51e64ee8d6158dfe7` (`roomType`);

--
-- Indexes for table `collaborative_notes`
--
ALTER TABLE `collaborative_notes`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_e6da2c2b8c1d94a5433c93896d` (`createdAt`),
  ADD KEY `IDX_620fbd13ce32fb0114de43bee1` (`lessonId`),
  ADD KEY `IDX_d6996ca13989a5b0178d8ad24b` (`courseId`),
  ADD KEY `IDX_19e073e93b5bed715cf84e436b` (`studyGroupId`),
  ADD KEY `IDX_02ebc4fde31ff74fd12581db4d` (`authorId`),
  ADD KEY `IDX_b36dda4361cb19d4aedf9db731` (`status`),
  ADD KEY `IDX_da86702cb155376e7bc9822701` (`type`);

--
-- Indexes for table `compliance_audit_trails`
--
ALTER TABLE `compliance_audit_trails`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_23742e4f4772a6fcad916f03bc` (`complianceStatus`),
  ADD KEY `IDX_a6c1e85aec34b8288e5cea612b` (`subjectUserId`,`eventType`),
  ADD KEY `IDX_4e254f6293f54408e6c989c513` (`eventType`,`timestamp`);

--
-- Indexes for table `consent_records`
--
ALTER TABLE `consent_records`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_e9d9db9b60f96bef0c6d7379c0` (`consentGivenAt`),
  ADD KEY `IDX_9a5b5e445e2635a3599d3d178f` (`status`,`expiresAt`),
  ADD KEY `IDX_cc1ba82cecccbb3ddfbafb4127` (`user_id`,`type`);

--
-- Indexes for table `content_quality_assessments`
--
ALTER TABLE `content_quality_assessments`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_2d981dfc2fb56283afb68c5962` (`quality_level`,`is_latest`),
  ADD KEY `IDX_219972cea47d7cc9c3d71ffbd4` (`overall_score`,`assessed_at`),
  ADD KEY `IDX_8178519d9ffd74b35058086b3b` (`content_type`,`content_id`);

--
-- Indexes for table `content_similarities`
--
ALTER TABLE `content_similarities`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_e05eb3bdb25f9704ef208f4165` (`status`,`calculated_at`),
  ADD KEY `IDX_5ad781dc3f9d7db0cecaf015a2` (`similarity_type`,`similarity_score`),
  ADD KEY `IDX_5e168fbde557a68edb82037156` (`target_content_type`,`target_content_id`),
  ADD KEY `IDX_716ad4d1321bc6600880d7fed6` (`source_content_type`,`source_content_id`);

--
-- Indexes for table `content_tags`
--
ALTER TABLE `content_tags`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_11633b32667752bee0326ac691` (`type`,`is_active`),
  ADD KEY `IDX_efbb133bcbbb571f9c8410603f` (`tag`,`category`),
  ADD KEY `IDX_cac7376bb7ca289e420ce2bd5c` (`content_type`,`content_id`);

--
-- Indexes for table `content_versions`
--
ALTER TABLE `content_versions`
  ADD PRIMARY KEY (`id`),
  ADD KEY `FK_388833dfd194481186815177776` (`lessonId`),
  ADD KEY `FK_38e2da8c4e04ec8719bc8bf0a1f` (`createdBy`),
  ADD KEY `FK_060d136b9e7e5d7eecef1929f6c` (`updatedBy`);

--
-- Indexes for table `courses`
--
ALTER TABLE `courses`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_a3bb2d01cfa0f95bc5e034e1b7` (`slug`),
  ADD KEY `IDX_a0a31e320e1db252912597b172` (`featured`,`status`),
  ADD KEY `IDX_c267e37c1d0dc8e11915f3e83b` (`publishedAt`),
  ADD KEY `IDX_fb47045a79ec58f7146b9a07fc` (`rating`,`totalEnrollments`),
  ADD KEY `IDX_2525a67290ece28bda91a98999` (`price`,`isFree`),
  ADD KEY `IDX_ca563d43c01d1f99ac170f9e43` (`level`,`status`),
  ADD KEY `IDX_c730473dfb837b3e62057cd944` (`categoryId`),
  ADD KEY `IDX_f921bd9bb6d061b90d386fa372` (`teacherId`);

--
-- Indexes for table `course_sections`
--
ALTER TABLE `course_sections`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_ffce6827995d2db7eec7aea3b6` (`isActive`),
  ADD KEY `IDX_449b50399b0d0c3eb9747b7ac7` (`orderIndex`),
  ADD KEY `IDX_86cf0cbf22034eea0ec79ab7ab` (`courseId`);

--
-- Indexes for table `data_anonymization_logs`
--
ALTER TABLE `data_anonymization_logs`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_814b81614532e1464583c645d7` (`performedAt`),
  ADD KEY `IDX_7058d3ec79334117323086add8` (`anonymizationType`,`status`),
  ADD KEY `IDX_2fac224e7b8451847ddbae4ce8` (`entityType`,`entityId`);

--
-- Indexes for table `data_protection_requests`
--
ALTER TABLE `data_protection_requests`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_3950af35cadce6712524ce6e0f` (`priority`,`dueDate`),
  ADD KEY `IDX_5c423b0e82edc853c3ad7c29b7` (`status`,`createdAt`),
  ADD KEY `IDX_f895697cf6bbe98691d133d4c9` (`user_id`,`type`);

--
-- Indexes for table `dropout_risk_assessments`
--
ALTER TABLE `dropout_risk_assessments`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_26cab4120ea0f463925b55ce60` (`interventionRequired`),
  ADD KEY `IDX_a61b25062de8f9dc1153323c77` (`riskLevel`),
  ADD KEY `IDX_1eb69fd9cc6b7829a310160cb3` (`studentId`,`assessmentDate`),
  ADD KEY `FK_3b81d6fd7358cc300526e33a2d5` (`courseId`);

--
-- Indexes for table `email_automation_steps`
--
ALTER TABLE `email_automation_steps`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_4cb571fdde99e426e3ecc94eee` (`isActive`),
  ADD KEY `IDX_d5d5a442f33f044b036ca4c2a4` (`orderIndex`),
  ADD KEY `IDX_301b6b64d37c77a7f699350840` (`stepType`),
  ADD KEY `IDX_ade02adf7784ee416f3f115786` (`workflowId`),
  ADD KEY `FK_c1bc11c18211a2a9c73ce82833f` (`templateId`);

--
-- Indexes for table `email_automation_workflows`
--
ALTER TABLE `email_automation_workflows`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_ca8673c6697354193822afaf01` (`createdBy`),
  ADD KEY `IDX_f76c546bd7c12f640cc381b656` (`isActive`),
  ADD KEY `IDX_753a9223e22cffb74495ca2e2e` (`triggerType`),
  ADD KEY `IDX_c4e45b98e7142996935a80b83e` (`status`);

--
-- Indexes for table `email_campaigns`
--
ALTER TABLE `email_campaigns`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_26bca5d81f04065ab36e7bf4a4` (`targetAudience`(768)),
  ADD KEY `IDX_96917b4fde2f694ee635fff110` (`createdBy`),
  ADD KEY `IDX_862a5402a4d18274a07a2a7ccc` (`scheduledAt`),
  ADD KEY `IDX_0a439530ce49f6a0c340ca1aab` (`type`),
  ADD KEY `IDX_fc77d3d8f8101ab793cf17986f` (`status`);

--
-- Indexes for table `email_campaign_analytics`
--
ALTER TABLE `email_campaign_analytics`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_d17ec5fcd9078bce7ff1b8d2a3` (`ip`),
  ADD KEY `IDX_7f70805361d11cecda58fbf682` (`userAgent`),
  ADD KEY `IDX_3cfd44405166b4f11601dcb301` (`url`(768)),
  ADD KEY `IDX_00bd0f743536801d07a9d2b7dc` (`recipientEmail`),
  ADD KEY `IDX_bab576541f5b5e282a6ab0281c` (`timestamp`),
  ADD KEY `IDX_180ff08a8540e3d379f2e82b52` (`eventType`),
  ADD KEY `IDX_5d2cb9ae55c5839a19d647cbe0` (`campaignId`);

--
-- Indexes for table `email_campaign_recipients`
--
ALTER TABLE `email_campaign_recipients`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_78f458b6c952a02f01e73d639a` (`clickedAt`),
  ADD KEY `IDX_22b64f91c8b513130c80dd19e7` (`openedAt`),
  ADD KEY `IDX_53599fba0f133af7ceef37709a` (`deliveredAt`),
  ADD KEY `IDX_93357b7df16ac502deec982f12` (`sentAt`),
  ADD KEY `IDX_c11c2bc7a59703e606eee7b9f1` (`status`),
  ADD KEY `IDX_a25b377bb10c4cf73d717c61e1` (`email`),
  ADD KEY `IDX_b94c38b25d4079e71e8c8a975b` (`userId`),
  ADD KEY `IDX_7b933ee29bd060515564059972` (`campaignId`);

--
-- Indexes for table `email_suppression_list`
--
ALTER TABLE `email_suppression_list`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_8262e6c85184ccf17c3a7980e8` (`expiresAt`),
  ADD KEY `IDX_4fbcabc573503602adf6fd4c3f` (`suppressedAt`),
  ADD KEY `IDX_f96ca49453ead2e402b297c156` (`isActive`),
  ADD KEY `IDX_a4ac6176d7c2837f40fbee6bc2` (`scope`),
  ADD KEY `IDX_30a0c93b5bdb6d953c8f1a2894` (`reason`),
  ADD KEY `IDX_38f60858c2ef2733cdf470eedf` (`email`);

--
-- Indexes for table `enrollments`
--
ALTER TABLE `enrollments`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_1566a16b6323a3e3ade31a02c9` (`studentId`,`courseId`),
  ADD KEY `IDX_58e144e61b9bd3d7f097680e6e` (`paymentStatus`),
  ADD KEY `IDX_b0f106d8b244312869b65a049f` (`enrollmentDate`),
  ADD KEY `IDX_3816714ab4c719d70e6b848744` (`status`),
  ADD KEY `IDX_60dd0ae4e21002e63a5fdefeec` (`courseId`),
  ADD KEY `IDX_bf3ba3dfa95e2df7388eb4589f` (`studentId`);

--
-- Indexes for table `feedbacks`
--
ALTER TABLE `feedbacks`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_828a407f75a74ffe1c5149bd41` (`category`,`severity`),
  ADD KEY `IDX_9a2645913e0a0f95ffd4120454` (`authorId`,`createdAt`),
  ADD KEY `IDX_748b91bffc3917113ffa37cef7` (`gradeId`,`questionId`),
  ADD KEY `FK_0ea7286c6127dc39db76e81859e` (`questionId`);

--
-- Indexes for table `file_uploads`
--
ALTER TABLE `file_uploads`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_80bccaf17b37bfcbe8cd19c133` (`uploadedAt`),
  ADD KEY `IDX_dbd50ba133d360487663f063f0` (`isPublic`),
  ADD KEY `IDX_5b2796ee5da27a8acaedebdc9f` (`courseId`),
  ADD KEY `IDX_fa14e56836f8cc5b61138ef255` (`lessonId`),
  ADD KEY `IDX_8ab70e86a540c6b6c05a3a9221` (`relatedType`),
  ADD KEY `IDX_dd4e20dd3dbb97831fc144a657` (`fileType`),
  ADD KEY `IDX_f6480896a832aeb5bf2cbdcaa8` (`uploaderId`),
  ADD KEY `FK_175be1fef3fab05de57c182a1ab` (`updatedBy`),
  ADD KEY `FK_cee3f3f0691ba0412113fb40570` (`moderatedBy`);

--
-- Indexes for table `forum_categories`
--
ALTER TABLE `forum_categories`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_722082a1951f5806d0abae84aa` (`isActive`),
  ADD KEY `IDX_ff751ee5e15f3ea96b5e31c2d8` (`orderIndex`),
  ADD KEY `IDX_c4514e6744ff9e613f20eb108f` (`slug`),
  ADD KEY `IDX_78e6e8b2904192d6f4b5c06a0e` (`parentId`);

--
-- Indexes for table `forum_category_permissions`
--
ALTER TABLE `forum_category_permissions`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_cf020bd0be51b79c51de2c8507` (`categoryId`,`roleId`),
  ADD KEY `IDX_23cd59e3ed109a3d9f819888b8` (`roleId`),
  ADD KEY `IDX_3054007024d6fae20f189b0528` (`categoryId`);

--
-- Indexes for table `forum_posts`
--
ALTER TABLE `forum_posts`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_45135803e34e4ad6ac716f6cde` (`isAccepted`),
  ADD KEY `IDX_03637fe7a5afe65573c599a649` (`createdAt`),
  ADD KEY `IDX_d04fb6f55fbbf1e27dfc2de76a` (`parentId`),
  ADD KEY `IDX_5d7bcc5e3ab5c8a49fc16ba388` (`status`),
  ADD KEY `IDX_9e8fc64c333e7e0c4f7a737c01` (`type`),
  ADD KEY `IDX_151dff45f01c0c195022e7db12` (`authorId`),
  ADD KEY `IDX_3c0acde3f2dd3408bf02235e03` (`threadId`);

--
-- Indexes for table `forum_post_attachments`
--
ALTER TABLE `forum_post_attachments`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_a6e79a91e145d8a4d13556fac3` (`fileType`),
  ADD KEY `IDX_b3e42e0250e3ec60ee3edcf7df` (`postId`);

--
-- Indexes for table `forum_post_reports`
--
ALTER TABLE `forum_post_reports`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_9fa14dcf7aabaed0a76dff425d` (`reason`),
  ADD KEY `IDX_66d76da73d47ffad619d069ee2` (`status`),
  ADD KEY `IDX_2bc21f40dfeb7cfb584aa36dba` (`reporterId`),
  ADD KEY `IDX_202d41fa2e29f1057d8fb2ed43` (`postId`),
  ADD KEY `FK_1da4c47e1c6431466742cbcaa6a` (`handledBy`);

--
-- Indexes for table `forum_post_votes`
--
ALTER TABLE `forum_post_votes`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_69bdb980dcbeb7216c9b3eb2d6` (`postId`,`userId`),
  ADD KEY `IDX_7202e542c172ec1a5dd290a0fa` (`voteType`),
  ADD KEY `IDX_44f567d2de2580a833fa371bb7` (`userId`),
  ADD KEY `IDX_aa434f27dfaaa8b78a03b0b822` (`postId`);

--
-- Indexes for table `forum_reputation_history`
--
ALTER TABLE `forum_reputation_history`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_95f9ef7c8c8a07e0fe9a19686c` (`createdAt`),
  ADD KEY `IDX_930d7c619c308da50270283d12` (`relatedPostId`),
  ADD KEY `IDX_26b2a72f043eea2eddcb5bae7f` (`userId`),
  ADD KEY `FK_3435c1528f83bc9210c597cacbf` (`relatedUserId`);

--
-- Indexes for table `forum_tags`
--
ALTER TABLE `forum_tags`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_8a2bbc0ee6073da7cccb3378ba` (`name`),
  ADD KEY `IDX_bdcfecc7a15782602afc9fe226` (`isActive`),
  ADD KEY `IDX_494c9ccfb35aed982333a9e6b2` (`slug`);

--
-- Indexes for table `forum_threads`
--
ALTER TABLE `forum_threads`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_637c0939db0c7f53e3217cbadd` (`slug`),
  ADD KEY `IDX_5c74951c3a6dda99590131207e` (`lastActivityAt`),
  ADD KEY `IDX_00caf3e21ecf8508e42725f6ef` (`isLocked`),
  ADD KEY `IDX_85d7cb5bd3ed30e01b48522800` (`isFeatured`),
  ADD KEY `IDX_520fc0cc82aa4a9b1b0d082ea9` (`isPinned`),
  ADD KEY `IDX_578c436ed1962a6924127341fa` (`status`),
  ADD KEY `IDX_c55e1280c6d85f9060cbfbd638` (`authorId`),
  ADD KEY `IDX_b6400c33e14cb54bc25f739000` (`categoryId`);

--
-- Indexes for table `forum_thread_tags`
--
ALTER TABLE `forum_thread_tags`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_1d779f3e25534ed424ec6f8eb7` (`threadId`,`tagId`),
  ADD KEY `IDX_b9b965666979a70e44470dab3e` (`tagId`),
  ADD KEY `IDX_8e1b37c0bd13891ff83559457a` (`threadId`);

--
-- Indexes for table `forum_user_badges`
--
ALTER TABLE `forum_user_badges`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_d02a3c72f656a234665009df3c` (`earnedAt`),
  ADD KEY `IDX_8ed7b8b44b028abaceac0d3485` (`badgeType`),
  ADD KEY `IDX_b4baad8a0a3a3b2ac303512565` (`userId`);

--
-- Indexes for table `forum_user_reputations`
--
ALTER TABLE `forum_user_reputations`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_a5378302de6e0e3ddf1fbf3519` (`userId`),
  ADD KEY `IDX_5d2ee9c7d90a7e6d27985d1574` (`rank`),
  ADD KEY `IDX_f0f4cd939e01ee9c5393f85d46` (`score`);

--
-- Indexes for table `generated_quizzes`
--
ALTER TABLE `generated_quizzes`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_ccc2c4c46a8ad3455f2af93e34` (`status`,`quality_score`),
  ADD KEY `IDX_8995a3ee1a4da1de802ecbfde5` (`generated_by`,`createdAt`),
  ADD KEY `IDX_c928627b7ea3ba06ca5cb7d10c` (`lesson_id`,`status`),
  ADD KEY `FK_67cf27fac8fc4d4634af541465a` (`reviewed_by`);

--
-- Indexes for table `gradebooks`
--
ALTER TABLE `gradebooks`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_cbaffb57f645a6541ecef32020` (`status`,`createdAt`),
  ADD KEY `IDX_f89c3713c7e8425108734b1311` (`courseId`,`teacherId`),
  ADD KEY `FK_58da1ae48e14d146c7b37c6e1d1` (`teacherId`);

--
-- Indexes for table `grades`
--
ALTER TABLE `grades`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_8e09bacbc3dccc67506a3fb275` (`status`,`createdAt`),
  ADD KEY `IDX_7ca8c8afbb812d7a85b655d7e0` (`graderId`,`createdAt`),
  ADD KEY `IDX_5fb0d44e6dbeb891acd5388f0f` (`studentId`,`assessmentId`),
  ADD KEY `FK_f276dd2cdb1a70a8a0bce1b36a9` (`assessmentId`),
  ADD KEY `FK_6aa687bc1d0ce054ec99ac00e8e` (`attemptId`),
  ADD KEY `FK_535118e03b75e3712c3f1fbd84f` (`reviewedBy`);

--
-- Indexes for table `grading_rubrics`
--
ALTER TABLE `grading_rubrics`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_a00e802c68d39658fa8c34e5b1` (`createdBy`,`isTemplate`),
  ADD KEY `IDX_13b09f749889b95dd6fbf7b31d` (`assessmentId`);

--
-- Indexes for table `group_projects`
--
ALTER TABLE `group_projects`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_bfdf4107abed519e0032483bf1` (`createdAt`),
  ADD KEY `IDX_e92e0ff4ad1b0d4480acfa2285` (`dueDate`),
  ADD KEY `IDX_3cb1ce7cc3cdda98e8d608157f` (`courseId`),
  ADD KEY `IDX_2aa0662a3706d6e008ab3c4c46` (`studyGroupId`),
  ADD KEY `IDX_939c37a00ae47c2ae138d0d1ee` (`leaderId`),
  ADD KEY `IDX_3c3fe0e5c72eb6cb2db77eda1d` (`status`);

--
-- Indexes for table `hint_generations`
--
ALTER TABLE `hint_generations`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_077d7be907c35dbde172f7d2c0` (`hintType`,`createdAt`),
  ADD KEY `IDX_5769aa4187639a23ec46b9ed9b` (`interactionId`);

--
-- Indexes for table `intervention_recommendations`
--
ALTER TABLE `intervention_recommendations`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_4dc611f8e08f7935732b93d3ca` (`scheduledDate`),
  ADD KEY `IDX_b80781a36793a7a099ae13e026` (`priority`),
  ADD KEY `IDX_94532cf81ec8d093d111cbcb1b` (`interventionType`),
  ADD KEY `IDX_2eba3dc44f31cffc72a1a92f30` (`studentId`,`status`),
  ADD KEY `FK_be3ce4c5acbf876c1d176696535` (`courseId`),
  ADD KEY `FK_b34c819dace04995318b8f5d1ec` (`assignedToId`),
  ADD KEY `FK_42c5872606fe1be32e28265df50` (`predictionId`);

--
-- Indexes for table `learning_activities`
--
ALTER TABLE `learning_activities`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_efca9809925441fd06710af92b` (`studentId`,`courseId`,`timestamp`),
  ADD KEY `IDX_b4c2cfa6d247e8be1d89b4791d` (`timestamp`),
  ADD KEY `IDX_40e969ca8a91ec4b4f9ab3cf80` (`sessionId`),
  ADD KEY `IDX_e0bc5334d2426aa13814d279d2` (`activityType`),
  ADD KEY `IDX_793ef1c353de250fa8d4623286` (`lessonId`),
  ADD KEY `IDX_b551f361ef3672736c290492a9` (`courseId`),
  ADD KEY `IDX_cdf16a50ed3b3eb1852aa6b608` (`studentId`);

--
-- Indexes for table `learning_analytics`
--
ALTER TABLE `learning_analytics`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_c71696c635d8d2d791f510e25f` (`studentId`,`courseId`,`date`),
  ADD KEY `IDX_a1a1023665b7837f0366cc9d7a` (`performanceLevel`),
  ADD KEY `IDX_9dc7c6d3dbc6743b5ade48e2a0` (`engagementScore`),
  ADD KEY `IDX_e80339fe149480351f466b76f6` (`date`),
  ADD KEY `IDX_aba35c2a2d3fa8b0f9a2f9a890` (`courseId`),
  ADD KEY `IDX_c16ffb4d6053e97609fcc660b9` (`studentId`);

--
-- Indexes for table `learning_outcome_forecasts`
--
ALTER TABLE `learning_outcome_forecasts`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_64bccb9baf10abd034978490e0` (`forecastDate`),
  ADD KEY `IDX_67f6a4b08c47c7e8621bf00cdc` (`courseId`),
  ADD KEY `IDX_df63e7ab73d19507a73966a767` (`studentId`,`outcomeType`);

--
-- Indexes for table `learning_sessions`
--
ALTER TABLE `learning_sessions`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_b005262c0feb03eca9f14f76e9` (`sessionId`),
  ADD KEY `IDX_52c5354a47e984925ec99da49d` (`status`),
  ADD KEY `IDX_e76bbc12156ec7d5ef9ec7dc87` (`duration`),
  ADD KEY `IDX_b1334e0465a4fb9a1e01b6d835` (`endTime`),
  ADD KEY `IDX_1aa655839ac6b43ae97cbd6ffc` (`startTime`),
  ADD KEY `IDX_8146997061335a7999fc1a71f6` (`studentId`);

--
-- Indexes for table `learning_style_profiles`
--
ALTER TABLE `learning_style_profiles`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `REL_ca7fc8c5de1618a087ef7c5732` (`userId`),
  ADD KEY `IDX_ca7fc8c5de1618a087ef7c5732` (`userId`);

--
-- Indexes for table `lessons`
--
ALTER TABLE `lessons`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_ca2edfa23c965f9c435572a7de` (`slug`),
  ADD KEY `IDX_5a0336f49a77943113bf0096e8` (`isPreview`),
  ADD KEY `IDX_ad4cd8cae6b48273f05dd41032` (`lessonType`),
  ADD KEY `IDX_ba362d98935c01e0413dfffd75` (`orderIndex`),
  ADD KEY `IDX_6dc4890fa16a7a866b6144f492` (`sectionId`),
  ADD KEY `IDX_1a9ff2409a84c76560ae8a9259` (`courseId`);

--
-- Indexes for table `lesson_progress`
--
ALTER TABLE `lesson_progress`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_2786d400e741735839c156d5ae` (`studentId`,`lessonId`),
  ADD KEY `IDX_d4f9e6bd61cc95037db34f3865` (`completionDate`),
  ADD KEY `IDX_8bb01ceae2d3a8d753a22dd5d3` (`status`),
  ADD KEY `IDX_5bc4ad7572c19f8c12a67fee6b` (`enrollmentId`),
  ADD KEY `IDX_df13299d2740b302dd44a368df` (`lessonId`),
  ADD KEY `IDX_4acd3150e1ad2b6db8448a8934` (`studentId`);

--
-- Indexes for table `ml_models`
--
ALTER TABLE `ml_models`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_6fcdda89f296434f7303c0485b` (`isActive`),
  ADD KEY `IDX_e9de8e07593325e4dce1f0c73a` (`status`),
  ADD KEY `IDX_bff38b458d2e4eb2a09abbb239` (`modelType`),
  ADD KEY `IDX_e64d308e443d651aac7c3fc957` (`name`),
  ADD KEY `FK_567d1ce4aeb14718c23c5506f77` (`createdBy`);

--
-- Indexes for table `model_predictions`
--
ALTER TABLE `model_predictions`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_679651c6c2d867452099095172` (`createdAt`),
  ADD KEY `IDX_55cd0e8f69dca8c4640e8b9696` (`status`),
  ADD KEY `IDX_a8b83cd82bd2ed771e42f599d2` (`predictionType`),
  ADD KEY `IDX_3823deebf8997fd6155f150f7b` (`userId`),
  ADD KEY `IDX_c8936d764060214d517e370828` (`modelVersionId`),
  ADD KEY `FK_a2bd986cae26f08f1dc50e4dc8a` (`modelId`);

--
-- Indexes for table `model_versions`
--
ALTER TABLE `model_versions`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_9c84fc59e37f2ec7124dde0dee` (`createdAt`),
  ADD KEY `IDX_65afd6a44fe6e21925f71e9504` (`status`),
  ADD KEY `IDX_ff1f4bf8f71fefda3ffc9a3a1d` (`version`),
  ADD KEY `IDX_5442f181d41e1022590b3d32c7` (`modelId`);

--
-- Indexes for table `note_collaborators`
--
ALTER TABLE `note_collaborators`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_7e4c6c77d323ef2e1300776815` (`createdAt`),
  ADD KEY `IDX_657d3b216a652ea4735ed83954` (`permission`),
  ADD KEY `IDX_a69a1144172744afcb5579be27` (`userId`),
  ADD KEY `IDX_0f4406f6406d14543627078f82` (`noteId`);

--
-- Indexes for table `notifications`
--
ALTER TABLE `notifications`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_0af9c6e04d41a6d231c724701f` (`relatedType`),
  ADD KEY `IDX_bd7ca6e16c2f008d546d553308` (`relatedId`),
  ADD KEY `IDX_831a5a06f879fb0bebf8965871` (`createdAt`),
  ADD KEY `IDX_8ba28344602d583583b9ea1a50` (`isRead`),
  ADD KEY `IDX_7839fac2ab3deda259a96f8ada` (`category`),
  ADD KEY `IDX_1d992705797d7d2d5a3853ad9c` (`priority`),
  ADD KEY `IDX_aef1c7aef3725068e5540f8f00` (`type`),
  ADD KEY `IDX_692a909ee0fa9383e7859f9b40` (`userId`);

--
-- Indexes for table `notification_deliveries`
--
ALTER TABLE `notification_deliveries`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_9c03d9a2b402ad09d0d74a57fb` (`deliveredAt`),
  ADD KEY `IDX_0da4dcbb9c01180d67e34ea435` (`sentAt`),
  ADD KEY `IDX_e9c43497ac1f1a2eae1a22b242` (`status`),
  ADD KEY `IDX_97df328ebc040393a0fa5ff6b8` (`channel`),
  ADD KEY `IDX_480dc696b3c108f40b394d65fa` (`notificationId`);

--
-- Indexes for table `notification_preferences`
--
ALTER TABLE `notification_preferences`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_0aac65acff4b13e4496debe9c0` (`userId`,`notificationType`),
  ADD KEY `IDX_63e4f5bbbd1dad2ee466fbb210` (`pushEnabled`),
  ADD KEY `IDX_29ef6a26c9b26482eaa131dae7` (`emailEnabled`),
  ADD KEY `IDX_1a82f720b75736f6fcb1f42cce` (`notificationType`),
  ADD KEY `IDX_b70c44e8b00757584a39322559` (`userId`);

--
-- Indexes for table `notification_subscriptions`
--
ALTER TABLE `notification_subscriptions`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_82737e9aab9e7bac0f5d134eed` (`userId`,`channel`,`endpoint`) USING HASH,
  ADD KEY `IDX_bf939e911bb49de8f7e705310a` (`isActive`),
  ADD KEY `IDX_c467b7a9cd92021bc825854327` (`channel`),
  ADD KEY `IDX_10d30f9506ec1132570b928007` (`userId`);

--
-- Indexes for table `notification_templates`
--
ALTER TABLE `notification_templates`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_f6f0af5d0f1c906b214af7e690` (`isActive`),
  ADD KEY `IDX_82c14ecd8ad2345a34a94a86d9` (`templateType`),
  ADD KEY `IDX_a40683a1724487a784aae9e315` (`channel`),
  ADD KEY `IDX_39862b1a722590857df5d1b2e3` (`type`);

--
-- Indexes for table `peer_reviews`
--
ALTER TABLE `peer_reviews`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_646190fcca44c2cb465974f8a1` (`createdAt`),
  ADD KEY `IDX_aab12eaf8b1ef1c3a9dbda6362` (`dueDate`),
  ADD KEY `IDX_8de1f20c99ea4a473b4c9e77ad` (`assignmentId`),
  ADD KEY `IDX_6c051aaeed888af2b22a81ef47` (`courseId`),
  ADD KEY `IDX_4d1b3acb5aeac8051aeaa5ffa0` (`creatorId`),
  ADD KEY `IDX_80157a405155f3c43c2ad3335e` (`status`),
  ADD KEY `IDX_5b4270440da5693f6fc4ec1ae4` (`type`);

--
-- Indexes for table `peer_review_feedbacks`
--
ALTER TABLE `peer_review_feedbacks`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_2b220e2e563b6775ffc987d3e8` (`submittedAt`),
  ADD KEY `IDX_22f388c0ef012e4d9b3d9d26dd` (`status`),
  ADD KEY `IDX_aadca9279959c7a550b423d532` (`reviewerId`),
  ADD KEY `IDX_f29ea4c2bed91daabe3ee208b0` (`submissionId`);

--
-- Indexes for table `peer_review_submissions`
--
ALTER TABLE `peer_review_submissions`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_43b0932d36d65e2d3a81924f54` (`submittedAt`),
  ADD KEY `IDX_62e39a3d3ff7a581fbfd539cbf` (`status`),
  ADD KEY `IDX_836e34c64eb4b06a40d706fe67` (`submitterId`),
  ADD KEY `IDX_53d55769aa1a52713fa250e5fc` (`peerReviewId`);

--
-- Indexes for table `performance_predictions`
--
ALTER TABLE `performance_predictions`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_4d0f640b942fc4649f13514d65` (`riskLevel`),
  ADD KEY `IDX_83d3cc1e13054e9d126cc96e98` (`predictionDate`),
  ADD KEY `IDX_99e9c4b824bb511f3e35c10f4f` (`courseId`,`predictionType`),
  ADD KEY `IDX_17a5f5e1436e78e2a8c97a6dd4` (`studentId`,`predictionType`);

--
-- Indexes for table `permissions`
--
ALTER TABLE `permissions`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_7331684c0c5b063803a425001a` (`resource`,`action`),
  ADD KEY `IDX_e6a49991f10803d28b65f0323a` (`isSystemPermission`),
  ADD KEY `IDX_1c1e0637ecf1f6401beb9a68ab` (`action`),
  ADD KEY `IDX_89456a09b598ce8915c702c528` (`resource`);

--
-- Indexes for table `plagiarism_checks`
--
ALTER TABLE `plagiarism_checks`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_41ee23f95c153a2748b4998b78` (`status`,`createdAt`),
  ADD KEY `IDX_fd363f1dcff6fcdd4b9e0d9e58` (`plagiarism_level`,`scan_completed_at`),
  ADD KEY `IDX_003a703322e00b6c170cfc0f42` (`content_type`,`content_id`);

--
-- Indexes for table `privacy_settings`
--
ALTER TABLE `privacy_settings`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_626e170465665a6a6e9831bb15` (`user_id`);

--
-- Indexes for table `project_members`
--
ALTER TABLE `project_members`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_4e7e0dcba3220dc5fb87665b12` (`status`),
  ADD KEY `IDX_8c05688bf007417cfdc8943868` (`role`),
  ADD KEY `IDX_08d1346ff91abba68e5a637cfd` (`userId`),
  ADD KEY `IDX_d19892d8f03928e5bfc7313780` (`projectId`);

--
-- Indexes for table `project_tasks`
--
ALTER TABLE `project_tasks`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_5f69b4a85f69beec8f5d1dfdb9` (`createdAt`),
  ADD KEY `IDX_efc6bb95d4bb728ca597d79aab` (`dueDate`),
  ADD KEY `IDX_d93c372a53e5e0f532984ae0ea` (`priority`),
  ADD KEY `IDX_459e626462570a8cabd9b9ab93` (`status`),
  ADD KEY `IDX_93a4d0b7104d25258865d9f648` (`assigneeId`),
  ADD KEY `IDX_8691c10b6396e041f4b6d48f8a` (`projectId`),
  ADD KEY `FK_6a82614872c72621ef0b14289ba` (`creatorId`);

--
-- Indexes for table `questions`
--
ALTER TABLE `questions`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_25df0ce7f5bc86406cd3e6869e` (`tags`(768)),
  ADD KEY `IDX_a9013c5079a0d50d16d073bc8a` (`questionType`,`difficulty`),
  ADD KEY `FK_465acef6f7d1194fb40a2e786cf` (`assessmentId`);

--
-- Indexes for table `realtime_events`
--
ALTER TABLE `realtime_events`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_2bc7b8a304d2d8065bcf94beb4` (`priority`),
  ADD KEY `IDX_425b214027de1f02e939f6932a` (`isActive`),
  ADD KEY `IDX_eee56533cba7a1b0c548541cda` (`createdAt`),
  ADD KEY `IDX_348e8899c0036ba387684f3d58` (`targetId`),
  ADD KEY `IDX_1932c5ddadf576b06e5415e225` (`scope`),
  ADD KEY `IDX_12f7a19fe1891a5ba2784c0b02` (`eventType`);

--
-- Indexes for table `resource_optimizations`
--
ALTER TABLE `resource_optimizations`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_8a9d736bbbd58cf2c252dc8ac4` (`resourceType`,`optimizationDate`);

--
-- Indexes for table `roles`
--
ALTER TABLE `roles`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_648e3f5447f725579d7d4ffdfb` (`name`),
  ADD KEY `IDX_37d2c91c50b3fb3e3f08372457` (`isActive`),
  ADD KEY `IDX_8571fa4bf9cb3b7fc5171950cd` (`isSystemRole`);

--
-- Indexes for table `role_permissions`
--
ALTER TABLE `role_permissions`
  ADD PRIMARY KEY (`role_id`,`permission_id`),
  ADD KEY `IDX_178199805b901ccd220ab7740e` (`role_id`),
  ADD KEY `IDX_17022daf3f885f7d35423e9971` (`permission_id`);

--
-- Indexes for table `security_events`
--
ALTER TABLE `security_events`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_8a6aa3f4156741f2ba24561a94` (`userId`,`timestamp`),
  ADD KEY `IDX_cdd51db1a115378ff5eb38339d` (`ip`,`timestamp`),
  ADD KEY `IDX_34e070f6a9d49256c810da058d` (`severity`,`timestamp`),
  ADD KEY `IDX_8fee5d0ea2825d8bff26b6a2e2` (`type`,`timestamp`);

--
-- Indexes for table `security_policies`
--
ALTER TABLE `security_policies`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_92fe6a40bcb0f0968ffff5d411` (`name`);

--
-- Indexes for table `shared_whiteboards`
--
ALTER TABLE `shared_whiteboards`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_d983ebbdab76bc36629f185211` (`createdAt`),
  ADD KEY `IDX_912acdfb8de206be86f10f887b` (`status`),
  ADD KEY `IDX_1e26d1b7c840285f71b47b16de` (`creatorId`),
  ADD KEY `IDX_f8429431edcebf69d24d82a9a6` (`studyGroupId`);

--
-- Indexes for table `student_profiles`
--
ALTER TABLE `student_profiles`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_064d129936a1e821d637ee8c88` (`userId`),
  ADD UNIQUE KEY `IDX_4a060af86a981d4238c2c4024b` (`studentCode`),
  ADD UNIQUE KEY `REL_064d129936a1e821d637ee8c88` (`userId`),
  ADD KEY `IDX_3d101339934b3621d5c61b2bd4` (`enrollmentDate`),
  ADD KEY `IDX_417c1a5f02709a840e4f740d61` (`educationLevel`,`fieldOfStudy`);

--
-- Indexes for table `study_groups`
--
ALTER TABLE `study_groups`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_c9dbcd4a2a0e173d64a0a0feef` (`createdAt`),
  ADD KEY `IDX_b7e73d64534fb928695f64ab81` (`creatorId`),
  ADD KEY `IDX_7e8cd91b96f35b7145b940d29c` (`courseId`),
  ADD KEY `IDX_40151572fd05ce8066ea601f41` (`status`),
  ADD KEY `IDX_24df1e2ceff07e9266170d6556` (`type`);

--
-- Indexes for table `study_group_members`
--
ALTER TABLE `study_group_members`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_d21fe66e9e6ac114d65436fbc9` (`joinedAt`),
  ADD KEY `IDX_7ced179105ced8c1bd2053c22e` (`status`),
  ADD KEY `IDX_2b88d87a93ae54630325a854be` (`role`),
  ADD KEY `IDX_abc5b150ee9adff76ece1ed710` (`userId`),
  ADD KEY `IDX_227e308a0260039b7b115efb87` (`studyGroupId`);

--
-- Indexes for table `system_settings`
--
ALTER TABLE `system_settings`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_b1b5bc664526d375c94ce9ad43` (`key`),
  ADD KEY `IDX_3f6627b0cc8e7f81f34d9eabfc` (`isActive`),
  ADD KEY `IDX_b52a07a1b7e5a61598ebdfbd20` (`isPublic`),
  ADD KEY `IDX_797d199fff9037e5b231dc4ffb` (`category`);

--
-- Indexes for table `teacher_profiles`
--
ALTER TABLE `teacher_profiles`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_c30bc3401758faae4415391ea2` (`userId`),
  ADD UNIQUE KEY `IDX_2eaa4bd62500c356c70759fca4` (`teacherCode`),
  ADD UNIQUE KEY `REL_c30bc3401758faae4415391ea2` (`userId`),
  ADD KEY `IDX_1a049d3c4ef47c4eba23ea0141` (`rating`),
  ADD KEY `IDX_1fc8b83732ca457b620dd23bcd` (`specializations`(768)),
  ADD KEY `IDX_83a30dc3d5c991c549362de119` (`isApproved`,`isActive`);

--
-- Indexes for table `tutoring_interactions`
--
ALTER TABLE `tutoring_interactions`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_6d5ca131725440932896c4e5f3` (`interactionType`,`createdAt`),
  ADD KEY `IDX_abb5825c17dabb00bef16967d1` (`sessionId`,`createdAt`);

--
-- Indexes for table `tutoring_sessions`
--
ALTER TABLE `tutoring_sessions`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_99ea50977eda5749676e65175e` (`courseId`,`status`),
  ADD KEY `IDX_3c5ee90d9e968dcc4c98ea7457` (`studentId`,`startedAt`),
  ADD KEY `FK_f7c48694affee0919635cec732c` (`lessonId`);

--
-- Indexes for table `users`
--
ALTER TABLE `users`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_97672ac88f789774dd47f7c8be` (`email`),
  ADD UNIQUE KEY `IDX_fe0bb3f6520ee0469504521e71` (`username`),
  ADD KEY `IDX_c0f30dcc205fa03b0d77e95118` (`lastLoginAt`),
  ADD KEY `IDX_204e9b624861ff4a5b26819210` (`createdAt`),
  ADD KEY `IDX_d3cb9d641b7af62bbd83cf56c9` (`userType`,`status`);

--
-- Indexes for table `user_permissions`
--
ALTER TABLE `user_permissions`
  ADD PRIMARY KEY (`user_id`,`permission_id`),
  ADD KEY `IDX_3495bd31f1862d02931e8e8d2e` (`user_id`),
  ADD KEY `IDX_8145f5fadacd311693c15e41f1` (`permission_id`);

--
-- Indexes for table `user_presence`
--
ALTER TABLE `user_presence`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_b06e00b58bf86a3772b1251ac0` (`userId`),
  ADD KEY `IDX_a8f498a6b14f4ab0ed09b8b344` (`currentLessonId`),
  ADD KEY `IDX_f835351a9124c80013f0cd62a0` (`currentCourseId`),
  ADD KEY `IDX_1daf1ce7c61151e6a1e026520e` (`isOnline`),
  ADD KEY `IDX_646a26a1dac294a86495d4ada0` (`lastSeenAt`),
  ADD KEY `IDX_bd02185072398439bbb89c5d6f` (`status`);

--
-- Indexes for table `user_profiles`
--
ALTER TABLE `user_profiles`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_8481388d6325e752cd4d7e26c6` (`userId`),
  ADD UNIQUE KEY `REL_8481388d6325e752cd4d7e26c6` (`userId`),
  ADD KEY `IDX_e3e2c23be0393ea395fb507315` (`countryCode`,`cityCode`);

--
-- Indexes for table `user_roles`
--
ALTER TABLE `user_roles`
  ADD PRIMARY KEY (`user_id`,`role_id`),
  ADD KEY `IDX_87b8888186ca9769c960e92687` (`user_id`),
  ADD KEY `IDX_b23c65e50a758245a33ee35fda` (`role_id`);

--
-- Indexes for table `user_socials`
--
ALTER TABLE `user_socials`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_432d23e473d2a6f3c468633f6b` (`userId`,`platform`),
  ADD KEY `IDX_8ff76d4d899fbc1da3c0bb74c1` (`isPublic`),
  ADD KEY `IDX_040e168ffa39e04f4fbb5778a0` (`platform`);

--
-- Indexes for table `video_participants`
--
ALTER TABLE `video_participants`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `IDX_9c977075aca296c98bb372ea5a` (`sessionId`,`userId`),
  ADD KEY `IDX_a516ea95a98d288706123880cf` (`leftAt`),
  ADD KEY `IDX_7ab14e1a7368736c8cdd379adb` (`joinedAt`),
  ADD KEY `IDX_61e7aaf57250b1801cb009589c` (`connectionStatus`),
  ADD KEY `IDX_37405c94630783d1893276ef07` (`role`),
  ADD KEY `IDX_d9befcc6ddd45a1143f34f208a` (`userId`),
  ADD KEY `IDX_806ccc1f0d4d86a12eb671f6c8` (`sessionId`);

--
-- Indexes for table `video_sessions`
--
ALTER TABLE `video_sessions`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_59267021ba02fedf1ee0c05324` (`actualEnd`),
  ADD KEY `IDX_3e93d0e8d9c748622ea6660877` (`actualStart`),
  ADD KEY `IDX_167867d2e436813364128a0209` (`scheduledEnd`),
  ADD KEY `IDX_1798aa813ac78d8766c4fe807a` (`scheduledStart`),
  ADD KEY `IDX_3862008e0a712a61b4bc526193` (`status`),
  ADD KEY `IDX_f8b3afb2a5885b1cabe50367ad` (`sessionType`),
  ADD KEY `IDX_e89f3439dd2ba7f19327cfbcfd` (`lessonId`),
  ADD KEY `IDX_4ed81e2e6230c5073bedf627ba` (`courseId`),
  ADD KEY `IDX_ef9afcdd3f49d49c3226b0da8b` (`hostId`);

--
-- Indexes for table `whiteboard_elements`
--
ALTER TABLE `whiteboard_elements`
  ADD PRIMARY KEY (`id`),
  ADD KEY `IDX_ab1c71f7eb880d39cbcb46c7fb` (`createdAt`),
  ADD KEY `IDX_00d45417641d44767105b97d3a` (`type`),
  ADD KEY `IDX_22a1fb2fb7921dad80bfd97ce0` (`creatorId`),
  ADD KEY `IDX_ea797767a6adf607b3aa43dfd1` (`whiteboardId`);

--
-- Constraints for dumped tables
--

--
-- Constraints for table `ab_tests`
--
ALTER TABLE `ab_tests`
  ADD CONSTRAINT `FK_76b8fa96bba762a4b63b0e3bd06` FOREIGN KEY (`testModelId`) REFERENCES `ml_models` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_dce12ca58031537ffaa5c9ace8e` FOREIGN KEY (`controlModelId`) REFERENCES `ml_models` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `ab_test_results`
--
ALTER TABLE `ab_test_results`
  ADD CONSTRAINT `FK_78c8dffa224f024a675a0b323b4` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_80454f06144cac8e4a5c433205e` FOREIGN KEY (`testId`) REFERENCES `ab_tests` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `activity_feeds`
--
ALTER TABLE `activity_feeds`
  ADD CONSTRAINT `FK_91a203896bab1540948e25fe853` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `adaptive_content`
--
ALTER TABLE `adaptive_content`
  ADD CONSTRAINT `FK_13fb33618c7fba8088ba5304291` FOREIGN KEY (`courseId`) REFERENCES `courses` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_2304d3a511d1795ba0115318373` FOREIGN KEY (`lessonId`) REFERENCES `lessons` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `ai_recommendations`
--
ALTER TABLE `ai_recommendations`
  ADD CONSTRAINT `FK_c6da1a79c7f10bafd853276a6fc` FOREIGN KEY (`studentId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `assessments`
--
ALTER TABLE `assessments`
  ADD CONSTRAINT `FK_9c678788c729af235b440f7999b` FOREIGN KEY (`teacherId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_c0c858dfd225249fe292a2319e9` FOREIGN KEY (`lessonId`) REFERENCES `lessons` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_efabccbe7bbaebe3209fe3e5785` FOREIGN KEY (`courseId`) REFERENCES `courses` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `assessment_attempts`
--
ALTER TABLE `assessment_attempts`
  ADD CONSTRAINT `FK_72f05778ab3b0e36266a4ab55e7` FOREIGN KEY (`studentId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_e2ccc71e44abf94340bbfdc1007` FOREIGN KEY (`assessmentId`) REFERENCES `assessments` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_ffdcf76a9106cb2771767166645` FOREIGN KEY (`gradedBy`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `assessment_sessions`
--
ALTER TABLE `assessment_sessions`
  ADD CONSTRAINT `FK_362e4b954c6733e2f8364c360c4` FOREIGN KEY (`attemptId`) REFERENCES `assessment_attempts` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_7a78035a0da202178018f0cb595` FOREIGN KEY (`studentId`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_863c813fdc84a3c0face7661291` FOREIGN KEY (`assessmentId`) REFERENCES `assessments` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `assignments`
--
ALTER TABLE `assignments`
  ADD CONSTRAINT `FK_855166a85e826bc52d290aed457` FOREIGN KEY (`instructorId`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_9e5684667ea189ade0fc79fa4f1` FOREIGN KEY (`courseId`) REFERENCES `courses` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `audit_logs`
--
ALTER TABLE `audit_logs`
  ADD CONSTRAINT `FK_4423ab967bf3197ce632737302d` FOREIGN KEY (`reviewedBy`) REFERENCES `users` (`id`) ON DELETE SET NULL ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_cfa83f61e4d27a87fcae1e025ab` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE SET NULL ON UPDATE NO ACTION;

--
-- Constraints for table `categories`
--
ALTER TABLE `categories`
  ADD CONSTRAINT `FK_9a6f051e66982b5f0318981bcaa` FOREIGN KEY (`parentId`) REFERENCES `categories` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `chatbot_conversations`
--
ALTER TABLE `chatbot_conversations`
  ADD CONSTRAINT `FK_51f87316fa3406e057834982da7` FOREIGN KEY (`courseId`) REFERENCES `courses` (`id`) ON DELETE SET NULL ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_adf39cd2a4d9c3535283bcdeaaa` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `chatbot_messages`
--
ALTER TABLE `chatbot_messages`
  ADD CONSTRAINT `FK_0601c16bacb7287fa869ea4d156` FOREIGN KEY (`conversationId`) REFERENCES `chatbot_conversations` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `chat_files`
--
ALTER TABLE `chat_files`
  ADD CONSTRAINT `FK_11ad00e9530b655427076fa8f94` FOREIGN KEY (`uploadedBy`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_ea9c9ae1f173ad90c9a4d15d2a7` FOREIGN KEY (`messageId`) REFERENCES `chat_messages` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `chat_messages`
--
ALTER TABLE `chat_messages`
  ADD CONSTRAINT `FK_9fa0373c1451ad384fc6a74aa8c` FOREIGN KEY (`roomId`) REFERENCES `chat_rooms` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_c70893369be5d9fd3b99d895d14` FOREIGN KEY (`parentMessageId`) REFERENCES `chat_messages` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_fc6b58e41e9a871dacbe9077def` FOREIGN KEY (`senderId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `chat_message_reactions`
--
ALTER TABLE `chat_message_reactions`
  ADD CONSTRAINT `FK_9ed14288a4da904ad73a4ab4cd7` FOREIGN KEY (`messageId`) REFERENCES `chat_messages` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_fb41ef3d282a5ccda057f0c856f` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `chat_message_threads`
--
ALTER TABLE `chat_message_threads`
  ADD CONSTRAINT `FK_396a68712afbdf78f4188715366` FOREIGN KEY (`parentMessageId`) REFERENCES `chat_messages` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_94d3d048ba78a60bfa26622dd74` FOREIGN KEY (`createdBy`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `chat_moderation`
--
ALTER TABLE `chat_moderation`
  ADD CONSTRAINT `FK_25b57ec78e91ae748684cbd95ed` FOREIGN KEY (`moderatorId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_471159ec0d5047d8af4f1b173b2` FOREIGN KEY (`targetUserId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_b4029f667163b8788a36f5bbd49` FOREIGN KEY (`roomId`) REFERENCES `chat_rooms` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_b55e37ef88d2011d86bb685ef54` FOREIGN KEY (`messageId`) REFERENCES `chat_messages` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `chat_participants`
--
ALTER TABLE `chat_participants`
  ADD CONSTRAINT `FK_6be6922a86211449f6f74f5078e` FOREIGN KEY (`roomId`) REFERENCES `chat_rooms` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_fb6add83b1a7acc94433d385692` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `chat_rooms`
--
ALTER TABLE `chat_rooms`
  ADD CONSTRAINT `FK_287cc180e79f2532f1ca2b65dec` FOREIGN KEY (`courseId`) REFERENCES `courses` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_618bae345ad346eddc52fa8c8e9` FOREIGN KEY (`createdBy`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_c15d1caf3db4708f53083709834` FOREIGN KEY (`lessonId`) REFERENCES `lessons` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `collaborative_notes`
--
ALTER TABLE `collaborative_notes`
  ADD CONSTRAINT `FK_02ebc4fde31ff74fd12581db4dc` FOREIGN KEY (`authorId`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_19e073e93b5bed715cf84e436b9` FOREIGN KEY (`studyGroupId`) REFERENCES `study_groups` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_620fbd13ce32fb0114de43bee15` FOREIGN KEY (`lessonId`) REFERENCES `lessons` (`id`) ON DELETE SET NULL ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_d6996ca13989a5b0178d8ad24bf` FOREIGN KEY (`courseId`) REFERENCES `courses` (`id`) ON DELETE SET NULL ON UPDATE NO ACTION;

--
-- Constraints for table `consent_records`
--
ALTER TABLE `consent_records`
  ADD CONSTRAINT `FK_b823aad0deceda10806be9aa447` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `content_versions`
--
ALTER TABLE `content_versions`
  ADD CONSTRAINT `FK_060d136b9e7e5d7eecef1929f6c` FOREIGN KEY (`updatedBy`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_388833dfd194481186815177776` FOREIGN KEY (`lessonId`) REFERENCES `lessons` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_38e2da8c4e04ec8719bc8bf0a1f` FOREIGN KEY (`createdBy`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `courses`
--
ALTER TABLE `courses`
  ADD CONSTRAINT `FK_c730473dfb837b3e62057cd9447` FOREIGN KEY (`categoryId`) REFERENCES `categories` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_f921bd9bb6d061b90d386fa3721` FOREIGN KEY (`teacherId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `course_sections`
--
ALTER TABLE `course_sections`
  ADD CONSTRAINT `FK_86cf0cbf22034eea0ec79ab7ab3` FOREIGN KEY (`courseId`) REFERENCES `courses` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `data_protection_requests`
--
ALTER TABLE `data_protection_requests`
  ADD CONSTRAINT `FK_b85afdd84ecef95ebe81d5c92d0` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `dropout_risk_assessments`
--
ALTER TABLE `dropout_risk_assessments`
  ADD CONSTRAINT `FK_3b81d6fd7358cc300526e33a2d5` FOREIGN KEY (`courseId`) REFERENCES `courses` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_ab3cac44e1e178f594d507e067a` FOREIGN KEY (`studentId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `email_automation_steps`
--
ALTER TABLE `email_automation_steps`
  ADD CONSTRAINT `FK_ade02adf7784ee416f3f115786a` FOREIGN KEY (`workflowId`) REFERENCES `email_automation_workflows` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_c1bc11c18211a2a9c73ce82833f` FOREIGN KEY (`templateId`) REFERENCES `notification_templates` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `email_campaign_analytics`
--
ALTER TABLE `email_campaign_analytics`
  ADD CONSTRAINT `FK_5d2cb9ae55c5839a19d647cbe00` FOREIGN KEY (`campaignId`) REFERENCES `email_campaigns` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `email_campaign_recipients`
--
ALTER TABLE `email_campaign_recipients`
  ADD CONSTRAINT `FK_7b933ee29bd0605155640599726` FOREIGN KEY (`campaignId`) REFERENCES `email_campaigns` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_b94c38b25d4079e71e8c8a975b0` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `enrollments`
--
ALTER TABLE `enrollments`
  ADD CONSTRAINT `FK_60dd0ae4e21002e63a5fdefeec8` FOREIGN KEY (`courseId`) REFERENCES `courses` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_bf3ba3dfa95e2df7388eb4589fd` FOREIGN KEY (`studentId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `feedbacks`
--
ALTER TABLE `feedbacks`
  ADD CONSTRAINT `FK_00db4ac01d0798f75f4e112aa06` FOREIGN KEY (`gradeId`) REFERENCES `grades` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_0e41cb96ef6f2961420dc3ca6ca` FOREIGN KEY (`authorId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_0ea7286c6127dc39db76e81859e` FOREIGN KEY (`questionId`) REFERENCES `questions` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `file_uploads`
--
ALTER TABLE `file_uploads`
  ADD CONSTRAINT `FK_175be1fef3fab05de57c182a1ab` FOREIGN KEY (`updatedBy`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_5b2796ee5da27a8acaedebdc9f1` FOREIGN KEY (`courseId`) REFERENCES `courses` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_cee3f3f0691ba0412113fb40570` FOREIGN KEY (`moderatedBy`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_f6480896a832aeb5bf2cbdcaa8f` FOREIGN KEY (`uploaderId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_fa14e56836f8cc5b61138ef2551` FOREIGN KEY (`lessonId`) REFERENCES `lessons` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `forum_categories`
--
ALTER TABLE `forum_categories`
  ADD CONSTRAINT `FK_78e6e8b2904192d6f4b5c06a0ee` FOREIGN KEY (`parentId`) REFERENCES `forum_categories` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `forum_category_permissions`
--
ALTER TABLE `forum_category_permissions`
  ADD CONSTRAINT `FK_23cd59e3ed109a3d9f819888b80` FOREIGN KEY (`roleId`) REFERENCES `roles` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_3054007024d6fae20f189b0528d` FOREIGN KEY (`categoryId`) REFERENCES `forum_categories` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `forum_posts`
--
ALTER TABLE `forum_posts`
  ADD CONSTRAINT `FK_151dff45f01c0c195022e7db127` FOREIGN KEY (`authorId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_3c0acde3f2dd3408bf02235e039` FOREIGN KEY (`threadId`) REFERENCES `forum_threads` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_d04fb6f55fbbf1e27dfc2de76a8` FOREIGN KEY (`parentId`) REFERENCES `forum_posts` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `forum_post_attachments`
--
ALTER TABLE `forum_post_attachments`
  ADD CONSTRAINT `FK_b3e42e0250e3ec60ee3edcf7df6` FOREIGN KEY (`postId`) REFERENCES `forum_posts` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `forum_post_reports`
--
ALTER TABLE `forum_post_reports`
  ADD CONSTRAINT `FK_1da4c47e1c6431466742cbcaa6a` FOREIGN KEY (`handledBy`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_202d41fa2e29f1057d8fb2ed436` FOREIGN KEY (`postId`) REFERENCES `forum_posts` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_2bc21f40dfeb7cfb584aa36dbad` FOREIGN KEY (`reporterId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `forum_post_votes`
--
ALTER TABLE `forum_post_votes`
  ADD CONSTRAINT `FK_44f567d2de2580a833fa371bb72` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_aa434f27dfaaa8b78a03b0b822d` FOREIGN KEY (`postId`) REFERENCES `forum_posts` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `forum_reputation_history`
--
ALTER TABLE `forum_reputation_history`
  ADD CONSTRAINT `FK_26b2a72f043eea2eddcb5bae7f7` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_3435c1528f83bc9210c597cacbf` FOREIGN KEY (`relatedUserId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_930d7c619c308da50270283d126` FOREIGN KEY (`relatedPostId`) REFERENCES `forum_posts` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `forum_threads`
--
ALTER TABLE `forum_threads`
  ADD CONSTRAINT `FK_b6400c33e14cb54bc25f739000e` FOREIGN KEY (`categoryId`) REFERENCES `forum_categories` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_c55e1280c6d85f9060cbfbd6385` FOREIGN KEY (`authorId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `forum_thread_tags`
--
ALTER TABLE `forum_thread_tags`
  ADD CONSTRAINT `FK_8e1b37c0bd13891ff83559457a9` FOREIGN KEY (`threadId`) REFERENCES `forum_threads` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_b9b965666979a70e44470dab3eb` FOREIGN KEY (`tagId`) REFERENCES `forum_tags` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `forum_user_badges`
--
ALTER TABLE `forum_user_badges`
  ADD CONSTRAINT `FK_b4baad8a0a3a3b2ac3035125656` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `forum_user_reputations`
--
ALTER TABLE `forum_user_reputations`
  ADD CONSTRAINT `FK_a5378302de6e0e3ddf1fbf35198` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `generated_quizzes`
--
ALTER TABLE `generated_quizzes`
  ADD CONSTRAINT `FK_67cf27fac8fc4d4634af541465a` FOREIGN KEY (`reviewed_by`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_8e2b78e81c7df07e0099e5c2c6f` FOREIGN KEY (`generated_by`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_ce4258e0b17098fff7cab270680` FOREIGN KEY (`lesson_id`) REFERENCES `lessons` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `gradebooks`
--
ALTER TABLE `gradebooks`
  ADD CONSTRAINT `FK_58da1ae48e14d146c7b37c6e1d1` FOREIGN KEY (`teacherId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_968f81010b8295730f70ca466c0` FOREIGN KEY (`courseId`) REFERENCES `courses` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `grades`
--
ALTER TABLE `grades`
  ADD CONSTRAINT `FK_535118e03b75e3712c3f1fbd84f` FOREIGN KEY (`reviewedBy`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_6aa687bc1d0ce054ec99ac00e8e` FOREIGN KEY (`attemptId`) REFERENCES `assessment_attempts` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_7eab17e999c50a4ebd0bd90e46a` FOREIGN KEY (`graderId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_f276dd2cdb1a70a8a0bce1b36a9` FOREIGN KEY (`assessmentId`) REFERENCES `assessments` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_fcfc027e4e5fb37a4372e688070` FOREIGN KEY (`studentId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `grading_rubrics`
--
ALTER TABLE `grading_rubrics`
  ADD CONSTRAINT `FK_13b09f749889b95dd6fbf7b31d9` FOREIGN KEY (`assessmentId`) REFERENCES `assessments` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_f98c23ad4dbfb941cd4350fb2da` FOREIGN KEY (`createdBy`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `group_projects`
--
ALTER TABLE `group_projects`
  ADD CONSTRAINT `FK_2aa0662a3706d6e008ab3c4c46c` FOREIGN KEY (`studyGroupId`) REFERENCES `study_groups` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_3cb1ce7cc3cdda98e8d608157ff` FOREIGN KEY (`courseId`) REFERENCES `courses` (`id`) ON DELETE SET NULL ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_939c37a00ae47c2ae138d0d1eed` FOREIGN KEY (`leaderId`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `hint_generations`
--
ALTER TABLE `hint_generations`
  ADD CONSTRAINT `FK_5769aa4187639a23ec46b9ed9b3` FOREIGN KEY (`interactionId`) REFERENCES `tutoring_interactions` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `intervention_recommendations`
--
ALTER TABLE `intervention_recommendations`
  ADD CONSTRAINT `FK_42c5872606fe1be32e28265df50` FOREIGN KEY (`predictionId`) REFERENCES `performance_predictions` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_b34c819dace04995318b8f5d1ec` FOREIGN KEY (`assignedToId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_be3ce4c5acbf876c1d176696535` FOREIGN KEY (`courseId`) REFERENCES `courses` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_fc1090fd406e9b2c71b75a6f3b9` FOREIGN KEY (`studentId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `learning_outcome_forecasts`
--
ALTER TABLE `learning_outcome_forecasts`
  ADD CONSTRAINT `FK_67f6a4b08c47c7e8621bf00cdcf` FOREIGN KEY (`courseId`) REFERENCES `courses` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_e61c50903cec2d10b757316152b` FOREIGN KEY (`studentId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `learning_style_profiles`
--
ALTER TABLE `learning_style_profiles`
  ADD CONSTRAINT `FK_ca7fc8c5de1618a087ef7c57321` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `lessons`
--
ALTER TABLE `lessons`
  ADD CONSTRAINT `FK_1a9ff2409a84c76560ae8a92590` FOREIGN KEY (`courseId`) REFERENCES `courses` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_6dc4890fa16a7a866b6144f4929` FOREIGN KEY (`sectionId`) REFERENCES `course_sections` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `lesson_progress`
--
ALTER TABLE `lesson_progress`
  ADD CONSTRAINT `FK_4acd3150e1ad2b6db8448a89348` FOREIGN KEY (`studentId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_5bc4ad7572c19f8c12a67fee6b1` FOREIGN KEY (`enrollmentId`) REFERENCES `enrollments` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_df13299d2740b302dd44a368df9` FOREIGN KEY (`lessonId`) REFERENCES `lessons` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `ml_models`
--
ALTER TABLE `ml_models`
  ADD CONSTRAINT `FK_567d1ce4aeb14718c23c5506f77` FOREIGN KEY (`createdBy`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `model_predictions`
--
ALTER TABLE `model_predictions`
  ADD CONSTRAINT `FK_3823deebf8997fd6155f150f7b2` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_a2bd986cae26f08f1dc50e4dc8a` FOREIGN KEY (`modelId`) REFERENCES `model_versions` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_c8936d764060214d517e3708287` FOREIGN KEY (`modelVersionId`) REFERENCES `model_versions` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `model_versions`
--
ALTER TABLE `model_versions`
  ADD CONSTRAINT `FK_5442f181d41e1022590b3d32c7e` FOREIGN KEY (`modelId`) REFERENCES `ml_models` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `note_collaborators`
--
ALTER TABLE `note_collaborators`
  ADD CONSTRAINT `FK_0f4406f6406d14543627078f828` FOREIGN KEY (`noteId`) REFERENCES `collaborative_notes` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_a69a1144172744afcb5579be276` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `notifications`
--
ALTER TABLE `notifications`
  ADD CONSTRAINT `FK_692a909ee0fa9383e7859f9b406` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `notification_deliveries`
--
ALTER TABLE `notification_deliveries`
  ADD CONSTRAINT `FK_480dc696b3c108f40b394d65faf` FOREIGN KEY (`notificationId`) REFERENCES `notifications` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `notification_preferences`
--
ALTER TABLE `notification_preferences`
  ADD CONSTRAINT `FK_b70c44e8b00757584a393225593` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `notification_subscriptions`
--
ALTER TABLE `notification_subscriptions`
  ADD CONSTRAINT `FK_10d30f9506ec1132570b9280079` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `peer_reviews`
--
ALTER TABLE `peer_reviews`
  ADD CONSTRAINT `FK_4d1b3acb5aeac8051aeaa5ffa03` FOREIGN KEY (`creatorId`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_6c051aaeed888af2b22a81ef474` FOREIGN KEY (`courseId`) REFERENCES `courses` (`id`) ON DELETE SET NULL ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_8de1f20c99ea4a473b4c9e77ad5` FOREIGN KEY (`assignmentId`) REFERENCES `assignments` (`id`) ON DELETE SET NULL ON UPDATE NO ACTION;

--
-- Constraints for table `peer_review_feedbacks`
--
ALTER TABLE `peer_review_feedbacks`
  ADD CONSTRAINT `FK_aadca9279959c7a550b423d5324` FOREIGN KEY (`reviewerId`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_f29ea4c2bed91daabe3ee208b0d` FOREIGN KEY (`submissionId`) REFERENCES `peer_review_submissions` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `peer_review_submissions`
--
ALTER TABLE `peer_review_submissions`
  ADD CONSTRAINT `FK_53d55769aa1a52713fa250e5fc1` FOREIGN KEY (`peerReviewId`) REFERENCES `peer_reviews` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_836e34c64eb4b06a40d706fe678` FOREIGN KEY (`submitterId`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `performance_predictions`
--
ALTER TABLE `performance_predictions`
  ADD CONSTRAINT `FK_485a2e8ca106a829c4a3f4e5023` FOREIGN KEY (`courseId`) REFERENCES `courses` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_f54b58d400703eab1b029d26b5d` FOREIGN KEY (`studentId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `privacy_settings`
--
ALTER TABLE `privacy_settings`
  ADD CONSTRAINT `FK_626e170465665a6a6e9831bb153` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `project_members`
--
ALTER TABLE `project_members`
  ADD CONSTRAINT `FK_08d1346ff91abba68e5a637cfdb` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_d19892d8f03928e5bfc7313780c` FOREIGN KEY (`projectId`) REFERENCES `group_projects` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `project_tasks`
--
ALTER TABLE `project_tasks`
  ADD CONSTRAINT `FK_6a82614872c72621ef0b14289ba` FOREIGN KEY (`creatorId`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_8691c10b6396e041f4b6d48f8a0` FOREIGN KEY (`projectId`) REFERENCES `group_projects` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_93a4d0b7104d25258865d9f6485` FOREIGN KEY (`assigneeId`) REFERENCES `users` (`id`) ON DELETE SET NULL ON UPDATE NO ACTION;

--
-- Constraints for table `questions`
--
ALTER TABLE `questions`
  ADD CONSTRAINT `FK_465acef6f7d1194fb40a2e786cf` FOREIGN KEY (`assessmentId`) REFERENCES `assessments` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `role_permissions`
--
ALTER TABLE `role_permissions`
  ADD CONSTRAINT `FK_17022daf3f885f7d35423e9971e` FOREIGN KEY (`permission_id`) REFERENCES `permissions` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_178199805b901ccd220ab7740ec` FOREIGN KEY (`role_id`) REFERENCES `roles` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `shared_whiteboards`
--
ALTER TABLE `shared_whiteboards`
  ADD CONSTRAINT `FK_1e26d1b7c840285f71b47b16dee` FOREIGN KEY (`creatorId`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_f8429431edcebf69d24d82a9a66` FOREIGN KEY (`studyGroupId`) REFERENCES `study_groups` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `student_profiles`
--
ALTER TABLE `student_profiles`
  ADD CONSTRAINT `FK_064d129936a1e821d637ee8c88e` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `study_groups`
--
ALTER TABLE `study_groups`
  ADD CONSTRAINT `FK_7e8cd91b96f35b7145b940d29c9` FOREIGN KEY (`courseId`) REFERENCES `courses` (`id`) ON DELETE SET NULL ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_b7e73d64534fb928695f64ab816` FOREIGN KEY (`creatorId`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `study_group_members`
--
ALTER TABLE `study_group_members`
  ADD CONSTRAINT `FK_227e308a0260039b7b115efb87d` FOREIGN KEY (`studyGroupId`) REFERENCES `study_groups` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_abc5b150ee9adff76ece1ed7109` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `teacher_profiles`
--
ALTER TABLE `teacher_profiles`
  ADD CONSTRAINT `FK_c30bc3401758faae4415391ea23` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `tutoring_interactions`
--
ALTER TABLE `tutoring_interactions`
  ADD CONSTRAINT `FK_3804289b03bd13f2a4a762d19e8` FOREIGN KEY (`sessionId`) REFERENCES `tutoring_sessions` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `tutoring_sessions`
--
ALTER TABLE `tutoring_sessions`
  ADD CONSTRAINT `FK_3ec2093aa4ec063f6115a86ca88` FOREIGN KEY (`studentId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_ea8d13351ddc0161b1c92dcf35b` FOREIGN KEY (`courseId`) REFERENCES `courses` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_f7c48694affee0919635cec732c` FOREIGN KEY (`lessonId`) REFERENCES `lessons` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `user_permissions`
--
ALTER TABLE `user_permissions`
  ADD CONSTRAINT `FK_3495bd31f1862d02931e8e8d2e8` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  ADD CONSTRAINT `FK_8145f5fadacd311693c15e41f10` FOREIGN KEY (`permission_id`) REFERENCES `permissions` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `user_presence`
--
ALTER TABLE `user_presence`
  ADD CONSTRAINT `FK_b06e00b58bf86a3772b1251ac02` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `user_profiles`
--
ALTER TABLE `user_profiles`
  ADD CONSTRAINT `FK_8481388d6325e752cd4d7e26c6d` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `user_roles`
--
ALTER TABLE `user_roles`
  ADD CONSTRAINT `FK_87b8888186ca9769c960e926870` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  ADD CONSTRAINT `FK_b23c65e50a758245a33ee35fda1` FOREIGN KEY (`role_id`) REFERENCES `roles` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `user_socials`
--
ALTER TABLE `user_socials`
  ADD CONSTRAINT `FK_96bb948a91b6c8d4a8963743c1e` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `video_participants`
--
ALTER TABLE `video_participants`
  ADD CONSTRAINT `FK_806ccc1f0d4d86a12eb671f6c8f` FOREIGN KEY (`sessionId`) REFERENCES `video_sessions` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_d9befcc6ddd45a1143f34f208a2` FOREIGN KEY (`userId`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;

--
-- Constraints for table `video_sessions`
--
ALTER TABLE `video_sessions`
  ADD CONSTRAINT `FK_4ed81e2e6230c5073bedf627ba8` FOREIGN KEY (`courseId`) REFERENCES `courses` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_e89f3439dd2ba7f19327cfbcfd0` FOREIGN KEY (`lessonId`) REFERENCES `lessons` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_ef9afcdd3f49d49c3226b0da8b5` FOREIGN KEY (`hostId`) REFERENCES `users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION;

--
-- Constraints for table `whiteboard_elements`
--
ALTER TABLE `whiteboard_elements`
  ADD CONSTRAINT `FK_22a1fb2fb7921dad80bfd97ce07` FOREIGN KEY (`creatorId`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION,
  ADD CONSTRAINT `FK_ea797767a6adf607b3aa43dfd1d` FOREIGN KEY (`whiteboardId`) REFERENCES `shared_whiteboards` (`id`) ON DELETE CASCADE ON UPDATE NO ACTION;
COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
